<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"/>

<link rel="stylesheet" href="/css/main.css?v=7.0.1"/>


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Edit&amp;#x5B66;&amp;#x4E60;&amp;#x7B14;&amp;#x8BB0; Programming TDD Test-Driven DevelopmentChapter 25. Test-Driven Development PatternsIsolated TestTest ListTest FirstChapter 26. Red Bar PatternsOne Step TestStarter">
<meta name="keywords" content="读书笔记,unittest,Programming,TDD">
<meta property="og:type" content="article">
<meta property="og:title" content="Test-Driven Development">
<meta property="og:url" content="http://zhougy0717.github.io/2016/02/16/Test-Driven_Development/index.html">
<meta property="og:site_name" content="Big Ben">
<meta property="og:description" content="Edit&amp;#x5B66;&amp;#x4E60;&amp;#x7B14;&amp;#x8BB0; Programming TDD Test-Driven DevelopmentChapter 25. Test-Driven Development PatternsIsolated TestTest ListTest FirstChapter 26. Red Bar PatternsOne Step TestStarter">
<meta property="og:image" content="http://zhougy0717.github.io/images/Test-Driven%20Development/1455616022147.png">
<meta property="og:image" content="http://zhougy0717.github.io/images/Test-Driven%20Development/SVGc430acae44d6c4874bd268c48184baa7">
<meta property="og:image" content="http://zhougy0717.github.io/images/Test-Driven%20Development/SVGc430acae44d6c4874bd268c48184baa7">
<meta property="og:image" content="http://zhougy0717.github.io/images/Test-Driven%20Development/SVGc430acae44d6c4874bd268c48184baa7">
<meta property="og:image" content="http://zhougy0717.github.io/images/Test-Driven%20Development/SVGc430acae44d6c4874bd268c48184baa7">
<meta property="og:image" content="http://zhougy0717.github.io/images/Test-Driven%20Development/1456036251528.png">
<meta property="og:updated_time" content="2016-02-28T13:30:33.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Test-Driven Development">
<meta name="twitter:description" content="Edit&amp;#x5B66;&amp;#x4E60;&amp;#x7B14;&amp;#x8BB0; Programming TDD Test-Driven DevelopmentChapter 25. Test-Driven Development PatternsIsolated TestTest ListTest FirstChapter 26. Red Bar PatternsOne Step TestStarter">
<meta name="twitter:image" content="http://zhougy0717.github.io/images/Test-Driven%20Development/1455616022147.png">





  
  
  <link rel="canonical" href="http://zhougy0717.github.io/2016/02/16/Test-Driven_Development/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Test-Driven Development | Big Ben</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Big Ben</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">一个半吊子的编码爱好者</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br/>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br/>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://zhougy0717.github.io/2016/02/16/Test-Driven_Development/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ben Zhou"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Big Ben"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Test-Driven Development

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2016-02-16 16:37:39" itemprop="dateCreated datePublished" datetime="2016-02-16T16:37:39+08:00">2016-02-16</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2016-02-28 21:30:33" itemprop="dateModified" datetime="2016-02-28T21:30:33+08:00">2016-02-28</time>
              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2016/02/16/Test-Driven_Development/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/02/16/Test-Driven_Development/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon"
            >
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <!DOCTYPE en-note SYSTEM 'http://xml.evernote.com/pub/enml2.dtd'><div class="enNote" style="color: #2c3f51; font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; line-height: 1.6;" title="" lang="v2" xml:lang="" dir=""><del style="position:relative;display:block;z-index:10;"><a style="position: absolute;color: #FFF;text-decoration: none;font-size: 12px;height: 25px;border-radius: 0;margin-top: -20px;right: 15px;background: rgba(0, 0, 0, 0);border-left: 10px solid #BB3A34;border-right: 10px solid #BB3A34;border-bottom: 5px solid rgba(0, 0, 0, 0);width: 0;text-indent:-100000px;" href="http://maxiang.io/#/?provider=evernote_int&amp;guid=209575d9-d1bc-4aa6-8a79-3d50bfe3d377&amp;notebook=%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0" target="_blank" rel="external">Edit</a></del><div style="color: #2c3f51; font-family: &apos;Helvetica Neue&apos;, Arial, &apos;Hiragino Sans GB&apos;, STHeiti, &apos;Microsoft YaHei&apos;, &apos;WenQuanYi Micro Hei&apos;, SimSun, Song, sans-serif; line-height: 1.6;"><div style="line-height: 1.6;"><div style="line-height: 1.6;"></div><div style="line-height: 1.6;"><p style="margin: 0 0 1.1em; line-height: 1.6;"></p><p style="margin: 0 0 1.1em; color: rgba(44,63,81,0.3); line-height: 1.6;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; background-color: #f9f2f4; white-space: normal; padding: 2px 5px; border-radius: 0; color: #fff; background: rgba(44,63,81,0.3); margin-right: 6px;">&#x5B66;&#x4E60;&#x7B14;&#x8BB0;</code> <code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; background-color: #f9f2f4; white-space: normal; padding: 2px 5px; color: rgba(44,63,81,0.5); border-radius: 0; background: rgba(102,128,153,0.075);">Programming</code> <code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; background-color: #f9f2f4; white-space: normal; padding: 2px 5px; color: rgba(44,63,81,0.5); border-radius: 0; background: rgba(102,128,153,0.075);">TDD</code> </p><p style="margin: 0 0 1.1em; line-height: 1.6;"><div style="line-height: 1.6;"><div style="line-height: 1.6;"><div style="line-height: 1.6;"><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#test-driven-development" style="background: transparent; color: #1980e6; text-decoration: none;">Test-Driven Development</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#chapter-25-test-driven-development-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 25. Test-Driven Development Patterns</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#isolated-test" style="background: transparent; color: #1980e6; text-decoration: none;">Isolated Test</a></li><li style="line-height: 1.6;"><a href="#test-list" style="background: transparent; color: #1980e6; text-decoration: none;">Test List</a></li><li style="line-height: 1.6;"><a href="#test-first" style="background: transparent; color: #1980e6; text-decoration: none;">Test First</a></li></ul></li><li style="line-height: 1.6;"><a href="#chapter-26-red-bar-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 26. Red Bar Patterns</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#one-step-test" style="background: transparent; color: #1980e6; text-decoration: none;">One Step Test</a></li><li style="line-height: 1.6;"><a href="#starter-test" style="background: transparent; color: #1980e6; text-decoration: none;">Starter Test</a></li><li style="line-height: 1.6;"><a href="#explanation-test" style="background: transparent; color: #1980e6; text-decoration: none;">Explanation Test</a></li><li style="line-height: 1.6;"><a href="#learning-test" style="background: transparent; color: #1980e6; text-decoration: none;">Learning Test</a></li><li style="line-height: 1.6;"><a href="#regression-test" style="background: transparent; color: #1980e6; text-decoration: none;">Regression Test</a></li><li style="line-height: 1.6;"><a href="#break" style="background: transparent; color: #1980e6; text-decoration: none;">Break</a></li><li style="line-height: 1.6;"><a href="#do-over" style="background: transparent; color: #1980e6; text-decoration: none;">Do Over</a></li></ul></li><li style="line-height: 1.6;"><a href="#chapter-27-testing-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 27. Testing Patterns</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#child-test" style="background: transparent; color: #1980e6; text-decoration: none;">Child Test</a></li><li style="line-height: 1.6;"><a href="#mock-object" style="background: transparent; color: #1980e6; text-decoration: none;">Mock Object</a></li><li style="line-height: 1.6;"><a href="#self-shunt" style="background: transparent; color: #1980e6; text-decoration: none;">Self Shunt</a></li><li style="line-height: 1.6;"><a href="#log-string" style="background: transparent; color: #1980e6; text-decoration: none;">Log String</a></li><li style="line-height: 1.6;"><a href="#crash-test-dummy" style="background: transparent; color: #1980e6; text-decoration: none;">Crash Test Dummy</a></li><li style="line-height: 1.6;"><a href="#broken-test" style="background: transparent; color: #1980e6; text-decoration: none;">Broken Test</a></li><li style="line-height: 1.6;"><a href="#clean-check-in" style="background: transparent; color: #1980e6; text-decoration: none;">Clean Check-in</a></li></ul></li><li style="line-height: 1.6;"><a href="#chapter-28-green-bar-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 28. Green Bar Patterns</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#fake-it-til-you-make-it" style="background: transparent; color: #1980e6; text-decoration: none;">Fake It (&#x2018;Til You Make It)</a></li><li style="line-height: 1.6;"><a href="#triangulate" style="background: transparent; color: #1980e6; text-decoration: none;">Triangulate</a></li><li style="line-height: 1.6;"><a href="#one-to-many" style="background: transparent; color: #1980e6; text-decoration: none;">One to Many</a></li></ul></li><li style="line-height: 1.6;"><a href="#chapter-29-xunit-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 29. xUnit Patterns</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#assertion" style="background: transparent; color: #1980e6; text-decoration: none;">Assertion</a></li><li style="line-height: 1.6;"><a href="#fixture" style="background: transparent; color: #1980e6; text-decoration: none;">Fixture</a></li><li style="line-height: 1.6;"><a href="#external-fixture" style="background: transparent; color: #1980e6; text-decoration: none;">External Fixture</a></li><li style="line-height: 1.6;"><a href="#test-method" style="background: transparent; color: #1980e6; text-decoration: none;">Test Method</a></li><li style="line-height: 1.6;"><a href="#exception-test" style="background: transparent; color: #1980e6; text-decoration: none;">Exception Test</a></li><li style="line-height: 1.6;"><a href="#all-tests" style="background: transparent; color: #1980e6; text-decoration: none;">All Tests</a></li></ul></li><li style="line-height: 1.6;"><a href="#chapter-30-design-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 30. Design Patterns</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#command" style="background: transparent; color: #1980e6; text-decoration: none;">Command</a></li><li style="line-height: 1.6;"><a href="#value-object" style="background: transparent; color: #1980e6; text-decoration: none;">Value Object</a></li><li style="line-height: 1.6;"><a href="#null-object" style="background: transparent; color: #1980e6; text-decoration: none;">Null Object</a></li><li style="line-height: 1.6;"><a href="#template-method" style="background: transparent; color: #1980e6; text-decoration: none;">Template Method</a></li><li style="line-height: 1.6;"><a href="#pluggable-object" style="background: transparent; color: #1980e6; text-decoration: none;">Pluggable Object</a></li><li style="line-height: 1.6;"><a href="#pluggable-selector" style="background: transparent; color: #1980e6; text-decoration: none;">Pluggable Selector</a></li><li style="line-height: 1.6;"><a href="#factory-method" style="background: transparent; color: #1980e6; text-decoration: none;">Factory Method</a></li><li style="line-height: 1.6;"><a href="#imposter" style="background: transparent; color: #1980e6; text-decoration: none;">Imposter</a></li><li style="line-height: 1.6;"><a href="#composite" style="background: transparent; color: #1980e6; text-decoration: none;">Composite</a></li><li style="line-height: 1.6;"><a href="#collecting-parameter" style="background: transparent; color: #1980e6; text-decoration: none;">Collecting Parameter</a></li><li style="line-height: 1.6;"><a href="#singleton" style="background: transparent; color: #1980e6; text-decoration: none;">Singleton</a></li></ul></li><li style="line-height: 1.6;"><a href="#chapter-31-refactoring" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 31. Refactoring</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#reconcile-differences" style="background: transparent; color: #1980e6; text-decoration: none;">Reconcile Differences</a></li><li style="line-height: 1.6;"><a href="#isolate-change" style="background: transparent; color: #1980e6; text-decoration: none;">Isolate Change</a></li><li style="line-height: 1.6;"><a href="#migrate-data" style="background: transparent; color: #1980e6; text-decoration: none;">Migrate Data</a></li><li style="line-height: 1.6;"><a href="#extract-method" style="background: transparent; color: #1980e6; text-decoration: none;">Extract Method</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#how" style="background: transparent; color: #1980e6; text-decoration: none;">How</a></li><li style="line-height: 1.6;"><a href="#why" style="background: transparent; color: #1980e6; text-decoration: none;">Why</a></li></ul></li><li style="line-height: 1.6;"><a href="#inline-method" style="background: transparent; color: #1980e6; text-decoration: none;">Inline Method</a></li><li style="line-height: 1.6;"><a href="#extract-interface" style="background: transparent; color: #1980e6; text-decoration: none;">Extract Interface</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#how-1" style="background: transparent; color: #1980e6; text-decoration: none;">How</a></li><li style="line-height: 1.6;"><a href="#why-1" style="background: transparent; color: #1980e6; text-decoration: none;">Why</a></li></ul></li><li style="line-height: 1.6;"><a href="#move-method" style="background: transparent; color: #1980e6; text-decoration: none;">Move Method</a></li><li style="line-height: 1.6;"><a href="#method-object" style="background: transparent; color: #1980e6; text-decoration: none;">Method Object</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#how-2" style="background: transparent; color: #1980e6; text-decoration: none;">How</a></li><li style="line-height: 1.6;"><a href="#why-2" style="background: transparent; color: #1980e6; text-decoration: none;">Why</a></li></ul></li><li style="line-height: 1.6;"><a href="#add-parameter" style="background: transparent; color: #1980e6; text-decoration: none;">Add Parameter</a></li><li style="line-height: 1.6;"><a href="#method-parameter-to-constructor-parameter" style="background: transparent; color: #1980e6; text-decoration: none;">Method Parameter to Constructor Parameter</a></li></ul></li><li style="line-height: 1.6;"><a href="#chapter-32-mastering-tdd" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 32. Mastering TDD</a><ul style="margin-top: 0; margin-bottom: 15px; list-style-type: none; line-height: 1.6;"><li style="line-height: 1.6;"><a href="#what-dont-you-have-to-test" style="background: transparent; color: #1980e6; text-decoration: none;">What don&#x2019;t you have to test?</a></li><li style="line-height: 1.6;"><a href="#how-do-you-know-if-you-have-good-tests" style="background: transparent; color: #1980e6; text-decoration: none;">How do you know if you have good tests?</a></li><li style="line-height: 1.6;"><a href="#how-does-tdd-lead-to-frameworks" style="background: transparent; color: #1980e6; text-decoration: none;">How does TDD lead to frameworks?</a></li><li style="line-height: 1.6;"><a href="#how-much-feedback-do-you-need" style="background: transparent; color: #1980e6; text-decoration: none;">How much feedback do you need?</a></li><li style="line-height: 1.6;"><a href="#when-should-you-delete-tests" style="background: transparent; color: #1980e6; text-decoration: none;">When should you delete tests?</a></li><li style="line-height: 1.6;"><a href="#can-you-drive-development-with-application-level-tests" style="background: transparent; color: #1980e6; text-decoration: none;">Can you drive development with application-level tests?</a></li><li style="line-height: 1.6;"><a href="#how-do-you-switch-to-tdd-midstream" style="background: transparent; color: #1980e6; text-decoration: none;">How do you switch to TDD midstream?</a></li><li style="line-height: 1.6;"><a href="#how-does-tdd-relate-to-the-practices-of-extreme-programming" style="background: transparent; color: #1980e6; text-decoration: none;">How does TDD relate to the practices of Extreme Programming?</a></li></ul></li></ul></li></ul></div></div></div></p><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x6700;&#x8FD1;&#x5728;&#x8BFB;Kent Beck&#x7684;&#x300A;Test-Driven Development By Example&#x300B;&#xFF0C;&#x8BA9;&#x6211;&#x5BF9;&#x8F6F;&#x4EF6;&#x5F00;&#x53D1;&#x6709;&#x4E86;&#x65B0;&#x7684;&#x8BA4;&#x8BC6;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">&#x5199;test&#x5E76;&#x4E0D;&#x4E3A;&#x4E86;&#x6D4B;&#x8BD5;&#x800C;&#x6D4B;&#x8BD5;&#xFF0C;&#x662F;&#x4E3A;&#x4E86;&#x589E;&#x5F3A;&#x5BF9;&#x7A0B;&#x5E8F;&#x7684;&#x4FE1;&#x5FC3;&#xFF0C;&#x51CF;&#x5C11;&#x7126;&#x8651;&#x3002;&#x90A3;&#x4E48;&#x5982;&#x4F55;&#x51CF;&#x5C11;&#x7126;&#x8651;&#x5462;&#xFF0C;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x6B21;&#x53EA;&#x5173;&#x5FC3;&#x4E00;&#x4EF6;&#x4E8B;&#x60C5;&#x3002;&#x5982;&#x4F55;&#x4E00;&#x6B21;&#x53EA;&#x5173;&#x5FC3;&#x4E00;&#x4EF6;&#x4E8B;&#x60C5;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;TDD&#x3002;</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x672C;&#x4E66;&#x5206;&#x4E09;&#x4E2A;&#x90E8;&#x5206;</p><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">The Money Example</li><li style="line-height: 1.6;">The xUnit Example</li><li style="line-height: 1.6;">Patterns for Test-Driven Development <br>&#x524D;&#x4E24;&#x4E2A;&#x90E8;&#x5206;&#x8BB2;&#x4E86;&#x4E24;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x6765;&#x9610;&#x8FF0;&#x5982;&#x4F55;&#x8FDB;&#x884C;TDD&#x5F00;&#x53D1;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x90E8;&#x5206;&#x7B97;&#x662F;&#x603B;&#x7ED3;&#xFF0C;&#x5168;&#x4E66;&#x7684;&#x7CBE;&#x534E;&#x6240;&#x5728;&#x3002;&#x672C;&#x6587;&#x4E0D;&#x6253;&#x7B97;&#x8BB2;&#x8FD9;&#x4E24;&#x4E2A;&#x4F8B;&#x5B50;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x4F8B;&#x5B50;&#x6700;&#x597D;&#x81EA;&#x5DF1;&#x624B;&#x5199;&#x4E00;&#x904D;&#xFF0C;&#x624D;&#x53EF;&#x4EE5;&#x52A0;&#x6DF1;&#x4E86;&#x89E3;&#x3002;&#x672C;&#x6587;&#x4E3B;&#x8981;&#x6458;&#x5F55;&#x4E00;&#x4E9B;TDD&#x7684;&#x6A21;&#x5F0F;&#x65B9;&#x6CD5;(pattern)&#x3002;</li></ol><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x8BDD;&#x6765;&#x81EA;&#x7B2C;&#x4E00;&#x7AE0;&#xFF0C;&#x63D0;&#x7EB2;&#x6308;&#x9886;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 1.1em; line-height: 1.6;">My goal is for you to see the rhythm of Test-Driven Development (TDD), which can be summed up as follows.</p><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">Quickly add a test.</li><li style="line-height: 1.6;">Run all tests and see the new one fail.</li><li style="line-height: 1.6;">Make a little change.</li><li style="line-height: 1.6;">Run all tests and see them all succeed.</li><li style="line-height: 1.6;">Refactor to remove duplication.</li></ol><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 1.1em; line-height: 1.6;">The surprises are likely to include.</p><ul style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">How each test can cover a <strong style="font-weight: bold; line-height: 1.6;">small increment</strong> of functionality.</li><li style="line-height: 1.6;">How <strong style="font-weight: bold; line-height: 1.6;">small and ugly the changes</strong> can be to make the new tests run.</li><li style="line-height: 1.6;">How often the tests are run.</li><li style="line-height: 1.6;">How many teensy-weensy steps make up the refactorings.</li></ul></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x5C31;&#x662F;TDD&#x7684;&#x7CBE;&#x9AD3;&#x3002;&#x6309;&#x4F5C;&#x8005;&#x7684;&#x8BF4;&#x6CD5;&#x5C31;&#x662F;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">Green/Red/Green/Refactor</code>&#x8282;&#x594F;&#x3002; <br>&#x8FD9;&#x4E5F;&#x56DE;&#x7B54;&#x4E86;&#x6211;&#x4E00;&#x76F4;&#x4EE5;&#x6765;&#x7684;&#x56F0;&#x6270;&#xFF0C;&#x5230;&#x5E95;&#x5E94;&#x8BE5;&#x5982;&#x4F55;&#x8BBE;&#x8BA1;&#x4E00;&#x6BB5;&#x7A0B;&#x5E8F;&#xFF0C;&#x5230;&#x5E95;&#x8981;&#x8003;&#x8651;&#x591A;&#x5C11;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#x6309;&#x7167;TDD&#x7684;&#x5EFA;&#x8BAE;&#x5C31;&#x662F;&#xFF0C;&#x9996;&#x5148;&#x5199;&#x6D4B;&#x8BD5;&#xFF0C;&#x7136;&#x540E;&#x4EE3;&#x7801;&#x600E;&#x4E48;&#x5FEB;&#x600E;&#x4E48;&#x6765;&#xFF0C;&#x4E0D;&#x7BA1;&#x6709;&#x591A;ugly&#xFF0C;&#x7136;&#x540E;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x91CD;&#x590D;&#xFF0C;&#x53CA;&#x65F6;&#x505A;&#x91CD;&#x6784;&#x3002;&#x4E0D;&#x8981;&#x8003;&#x8651;&#x4EC0;&#x4E48;&#x6269;&#x5C55;&#x6027;&#x4E4B;&#x7C7B;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x8BBE;&#x8BA1;&#x65B9;&#x5F0F;&#x672C;&#x8EAB;&#x5C31;&#x80FD;&#x63D0;&#x4F9B;&#x3002;&#x56E0;&#x4E3A;&#x5B83;&#x63D0;&#x9AD8;&#x4E86;&#x8FD0;&#x884C;&#x6D4B;&#x8BD5;&#x548C;&#x91CD;&#x6784;&#x7684;&#x9891;&#x7387;&#xFF0C;&#x65E2;&#x63D0;&#x5347;&#x4E86;&#x7F16;&#x7801;&#x8005;&#x5BF9;&#x7A0B;&#x5E8F;&#x7684;&#x4FE1;&#x5FC3;&#xFF0C;&#x4E5F;&#x964D;&#x4F4E;&#x4E86;&#x4E0D;&#x5408;&#x7406;&#x8BBE;&#x8BA1;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x3002;</p></div><div style="line-height: 1.6;"><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 2.15em; margin: 1.2em 0 .6em 0; text-align: start;" id="chapter-25-test-driven-development-patterns"><a name="chapter-25-test-driven-development-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 25. Test-Driven Development Patterns</a></h2><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E66;&#x4E2D;&#x5F15;&#x5165;&#x4E86;&#x5F88;&#x591A;&#x5F71;&#x50CF;&#x56FE;(Influence Diagram)&#xFF0C;&#x5F88;&#x5F62;&#x8C61;&#x7684;&#x8BF4;&#x660E;&#x4E86;&#xFF0C;&#x5F15;&#x5165;TDD&#x80FD;&#x7ED9;&#x6211;&#x4EEC;&#x65E5;&#x5E38;&#x7684;&#x5F00;&#x53D1;&#x5DE5;&#x4F5C;&#x5F15;&#x5165;&#x4EC0;&#x4E48;&#x597D;&#x5904;&#x3002; <br><img class="enMedia" src="/images/Test-Driven Development/1455616022147.png" hash="ee396bc2e1f7e786de1ec9ab19d445e4" align="" alt="" longdesc="" width="" height="" border="" hspace="" vspace="" usemap="" style="border: 0; vertical-align: middle; max-width: 100%;" title="" lang="" xml:lang="" dir=""></p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 1.1em; line-height: 1.6;">This is a positive feedback loop. </p><ul style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">The more stress you feel, the less testing you will do. </li><li style="line-height: 1.6;">The less testing you do, the more errors you will make. </li><li style="line-height: 1.6;">The more errors you make, the more stress you feel. </li><li style="line-height: 1.6;">Rinse and repeat.</li></ul></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="isolated-test"><a name="isolated-test" style="background: transparent; color: #1980e6; text-decoration: none;">Isolated Test</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x80FD;&#x5C06;&#x5927;&#x5757;&#x7684;&#x6D4B;&#x8BD5;&#x5206;&#x5272;&#x6210;&#x677E;&#x8026;&#x5408;&#x7684;&#x5C0F;&#x6D4B;&#x8BD5;&#x4E0D;&#x5BB9;&#x6613;&#xFF0C;&#x4F46;&#x662F;&#x597D;&#x5904;&#x5927;&#x5927;&#x7684;&#x3002;&#x4F5C;&#x8005;&#x8BF4;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">I never knew exactly how to achieve high cohesion and loose coupling regularly until I started writing isolated tests.</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="test-list"><a name="test-list" style="background: transparent; color: #1980e6; text-decoration: none;">Test List</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x6211;&#x4EEC;&#x8981;&#x600E;&#x4E48;&#x5F00;&#x59CB;TDD&#x5462;&#xFF1F;&#x4F5C;&#x8005;&#x7ED9;&#x51FA;&#x4E86;&#x5F88;&#x5177;&#x64CD;&#x4F5C;&#x6027;&#x7684;&#x5EFA;&#x8BAE;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 1.1em; line-height: 1.6;">Before you begin, write a list of all the tests you know you will have to write. <br>&#x8FD9;&#x4E2A;list&#x4E0A;&#x5199;&#x70B9;&#x4EC0;&#x4E48;&#x5462;&#xFF1F;</p><ol style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">Put on the list examples of every operation that you know you need to implement. &#x8981;&#x54EA;&#x4E9B;&#x64CD;&#x4F5C;&#x3002;</li><li style="line-height: 1.6;">for those operations that don&#x2019;t already exist, put the null version of that operation on the list.&#x54EA;&#x4E9B;&#x64CD;&#x4F5C;&#x6CA1;&#x5B9E;&#x73B0;&#xFF0C;&#x5199;&#x4E0A;&#x5B58;&#x6839;&#x3002;</li><li style="line-height: 1.6;">List all of the refactorings that you think you will have to do in order to have clean code at the end of this session. &#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x5217;&#x51FA;&#x9700;&#x8981;&#x91CD;&#x6784;&#x7684;&#x5730;&#x65B9;&#x3002;&#x800C;&#x5982;&#x679C;&#x6709;&#x5927;&#x7684;&#x91CD;&#x6784;&#x7684;&#x9700;&#x8981;&#x65F6;&#xFF0C;&#x653E;&#x5230;later list&#x91CC;&#x9762;&#xFF0C;&#x628A;&#x624B;&#x91CC;&#x7684;&#x4E8B;&#x60C5;&#x5904;&#x7406;&#x5B8C;&#xFF0C;&#x518D;&#x53BB;&#x5904;&#x7406;&#x5927;&#x7684;&#x91CD;&#x6784;&#x3002;</li></ol></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x770B;&#x4F5C;&#x8005;&#x65F6;&#x523B;&#x5728;&#x5F3A;&#x8C03;TDD&#x5C31;&#x662F;tiny steps&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">The pure form of TDD, wherein you are never more than one change away from a green bar, is like that three-out-of-four rule.</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="test-first"><a name="test-first" style="background: transparent; color: #1980e6; text-decoration: none;">Test First</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x5199;&#x6D4B;&#x8BD5;&#xFF1F; <br>&#x7B54;&#xFF1A;&#x5728;&#x5199;code&#x4E4B;&#x524D;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x65E6;&#x4F60;&#x5F00;&#x59CB;&#x5199;code&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x5C31;&#x8EAB;&#x9677;&#x6CE5;&#x6F6D;&#xFF0C;&#x65E0;&#x6687;&#x987E;&#x53CA;test case&#x4E86;&#x3002;</p></div><div style="line-height: 1.6;"><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 2.15em; margin: 1.2em 0 .6em 0; text-align: start;" id="chapter-26-red-bar-patterns"><a name="chapter-26-red-bar-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 26. Red Bar Patterns</a></h2></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="one-step-test"><a name="one-step-test" style="background: transparent; color: #1980e6; text-decoration: none;">One Step Test</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">Each test should represent one step toward your overall goal.</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="starter-test"><a name="starter-test" style="background: transparent; color: #1980e6; text-decoration: none;">Starter Test</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5982;&#x4F55;&#x5F00;&#x59CB;&#x5199;&#x6D4B;&#x8BD5;&#xFF1F;&#x4E0D;&#x8981;&#x4E00;&#x5F00;&#x59CB;&#x5C31;&#x60F3;&#x5199;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x4F1A;&#x4E00;&#x6B21;&#x9762;&#x5BF9;&#x592A;&#x591A;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4F5C;&#x8005;&#x5EFA;&#x8BAE;&#x5C1D;&#x8BD5;&#x4ECE;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6D4B;&#x8BD5;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x5F00;&#x59CB;&#x3002;&#x8FD9;&#x6837;&#x4EE5;&#x4FBF;&#x4E8E;&#x4F60;&#x4ECE;Greenxun&#x8FC5;&#x901F;&#x5F00;&#x59CB;&#x4F60;&#x7684;Green/Red/Green/Refactor&#x8282;&#x594F;&#x3002;&#x4F5C;&#x8005;&#x4E3E;&#x4E86;&#x4E00;&#x4E2A;&#x4EA7;&#x751F;&#x591A;&#x8FB9;&#x5F62;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span>Reducer r= <span style="line-height: 1.6; color: #a71d5d;">new</span> Reducer(<span style="line-height: 1.6; color: #a71d5d;">new</span> Polygon()); <br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>assertEquals(<span style="line-height: 1.6; color: #ae81ff;">0</span>, reducer.result().npoints);<br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E0D;&#x592A;&#x61C2;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4E0D;&#x8FC7;&#x53EF;&#x4EE5;&#x4ECE;&#x4E2D;&#x770B;&#x51FA;&#x4F5C;&#x8005;&#x5BF9;TDD&#x7684;&#x89E3;&#x91CA;&#x3002;&#x95EE;&#x9898;&#x672C;&#x8EAB;&#x662F;&#x8981;&#x89E3;&#x4E00;&#x4E2A;&#x964D;&#x4F4E;&#x591A;&#x8FB9;&#x5F62;&#x8FB9;&#x6570;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4F5C;&#x8005;&#x7684;&#x542F;&#x52A8;&#x6D4B;&#x8BD5;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x201C;0&#x201D;&#x8FB9;&#x591A;&#x8FB9;&#x5F62;&#xFF0C;&#x90A3;&#x7ED3;&#x679C;&#x4E00;&#x5B9A;&#x662F;&#x201D;0&#x201D;&#x8FB9;&#x591A;&#x8FB9;&#x5F62;&#x3002;&#x5BF9;&#x5B9E;&#x9645;&#x610F;&#x4E49;&#x5F88;&#x8352;&#x8BDE;&#xFF0C;&#x4F46;&#x5BF9;&#x6D4B;&#x8BD5;&#x6765;&#x8BF4;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x9519;&#x7684;&#x5F00;&#x59CB;&#x3002;&#x7B26;&#x5408;&#x6211;&#x4EEC;&#x7684;&#x9884;&#x671F;&#xFF0C;&#x7B80;&#x5355;&#x800C;&#x4E14;&#x53C8;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">represent one step toward your overall goal</code>&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="explanation-test"><a name="explanation-test" style="background: transparent; color: #1980e6; text-decoration: none;">Explanation Test</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E00;&#x7AE0;&#x662F;&#x5728;&#x8BF4;&#x5982;&#x4F55;&#x4E0D;&#x7528;&#x5F3A;&#x8FEB;&#x7684;&#x624B;&#x6BB5;&#x8BA9;&#x975E;TDD&#x7684;&#x56E2;&#x961F;&#x6210;&#x5458;&#x80FD;&#x8F6C;&#x5411;TDD&#x3002;&#x5F53;&#x5F00;&#x53D1;&#x8005;&#x5411;&#x4F60;&#x89E3;&#x91CA;&#x4ED6;&#x7684;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x4F60;&#x90FD;&#x53EF;&#x4EE5;&#x5C06;&#x4E4B;&#x8F6C;&#x5316;&#x4E3A;test case&#x3002; <br>&#x672C;&#x4E66;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x5F88;&#x6709;&#x7279;&#x8272;&#x7684;&#x5730;&#x65B9;&#x662F;&#xFF0C;&#x8D2F;&#x7A7F;&#x5168;&#x6587;&#xFF0C;&#x4F5C;&#x8005;&#x603B;&#x662F;&#x5728;&#x7ECF;&#x610F;&#x4E0D;&#x7ECF;&#x610F;&#x95F4;&#x6D41;&#x9732;&#x7740;&#x5404;&#x79CD;&#x5B9D;&#x8D35;&#x7684;&#x5DE5;&#x4F5C;&#x7ECF;&#x9A8C;&#xFF1A;&#x5982;&#x4F55;&#x957F;&#x671F;&#x4FDD;&#x6301;&#x66F4;&#x9AD8;&#x6548;&#x7684;&#x7F16;&#x7A0B;&#xFF1F;&#x5982;&#x679C;&#x4F60;&#x662F;&#x7ECF;&#x7406;&#xFF0C;&#x4F60;&#x5982;&#x4F55;&#x4E0E;&#x4F60;&#x7684;&#x56E2;&#x961F;&#x6210;&#x5458;&#x4E00;&#x8D77;&#x5DE5;&#x4F5C;&#xFF1F;&#x7B49;&#x7B49;&#x3002;&#x8FD9;&#x4E00;&#x7AE0;&#x5C31;&#x6709;&#x8FD9;&#x6837;&#x4E00;&#x53E5;&#x8BDD;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">If you&#x2019;re a manager or a leader, you can&#x2019;t force anyone to change the way they work. <br>What can you do? A simple start is to start asking for explanations in terms of test cases: &#x201C;Let me see if I understand what you&#x2019;re saying.</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="learning-test"><a name="learning-test" style="background: transparent; color: #1980e6; text-decoration: none;">Learning Test</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E00;&#x7AE0;&#x8BB2;&#x4E86;&#x6D4B;&#x8BD5;&#x9A71;&#x52A8;&#x5F00;&#x53D1;&#x9488;&#x5BF9;&#x96C6;&#x6210;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x7684;&#x4F18;&#x52BF;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="regression-test"><a name="regression-test" style="background: transparent; color: #1980e6; text-decoration: none;">Regression Test</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;</strong>&#x662F;&#x6307;&#x4FEE;&#x6539;&#x4E86;&#x65E7;&#x4EE3;&#x7801;&#x540E;&#xFF0C;&#x91CD;&#x65B0;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#x4EE5;&#x786E;&#x8BA4;&#x4FEE;&#x6539;&#x6CA1;&#x6709;&#x5F15;&#x5165;&#x65B0;&#x7684;&#x9519;&#x8BEF;&#x6216;&#x5BFC;&#x81F4;&#x5176;&#x4ED6;&#x4EE3;&#x7801;&#x4EA7;&#x751F;&#x9519;&#x8BEF;&#x3002; <br>&#x81EA;&#x52A8;&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;&#x5C06;&#x5927;&#x5E45;&#x964D;&#x4F4E;&#x7CFB;&#x7EDF;&#x6D4B;&#x8BD5;&#x3001;&#x7EF4;&#x62A4;&#x5347;&#x7EA7;&#x7B49;&#x9636;&#x6BB5;&#x7684;&#x6210;&#x672C;&#x3002;&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;&#x4F5C;&#x4E3A;&#x8F6F;&#x4EF6;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x4E00;&#x4E2A;&#x7EC4;&#x6210;&#x90E8;&#x5206;&#xFF0C;&#x5728;&#x6574;&#x4E2A;&#x8F6F;&#x4EF6;&#x6D4B;&#x8BD5;&#x8FC7;&#x7A0B;&#x4E2D;&#x5360;&#x6709;&#x5F88;&#x5927;&#x7684;&#x5DE5;&#x4F5C;&#x91CF;&#x6BD4;&#x91CD;&#xFF0C;&#x8F6F;&#x4EF6;&#x5F00;&#x53D1;&#x7684;&#x5404;&#x4E2A;&#x9636;&#x6BB5;&#x90FD;&#x4F1A;&#x8FDB;&#x884C;&#x591A;&#x6B21;&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;&#x3002;&#x5728;&#x6E10;&#x8FDB;&#x548C;&#x5FEB;&#x901F;&#x8FED;&#x4EE3;&#x5F00;&#x53D1;&#x4E2D;&#xFF0C;&#x65B0;&#x7248;&#x672C;&#x7684;&#x8FDE;&#x7EED;&#x53D1;&#x5E03;&#x4F7F;&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;&#x8FDB;&#x884C;&#x7684;&#x66F4;&#x52A0;&#x9891;&#x7E41;&#xFF0C;&#x800C;&#x5728;&#x6781;&#x7AEF;&#x7F16;&#x7A0B;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x66F4;&#x662F;&#x8981;&#x6C42;&#x6BCF;&#x5929;&#x90FD;&#x8FDB;&#x884C;&#x82E5;&#x5E72;&#x6B21;&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x901A;&#x8FC7;&#x9009;&#x62E9;&#x6B63;&#x786E;&#x7684;&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;&#x7B56;&#x7565;&#x6765;&#x6539;&#x8FDB;&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;&#x7684;&#x6548;&#x7387;&#x548C;&#x6709;&#x6548;&#x6027;&#x662F;&#x975E;&#x5E38;&#x6709;&#x610F;&#x4E49;&#x7684;&#x3002; <br>&#x2014;&#x2014; <strong style="font-weight: bold; line-height: 1.6;">&#x767E;&#x5EA6;&#x767E;&#x79D1;</strong></p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x672C;&#x4E66;&#x8BB2;&#x7684;&#x56DE;&#x5F52;&#x6D4B;&#x8BD5;&#x6982;&#x5FF5;&#x53EF;&#x80FD;&#x7565;&#x6709;&#x4E0D;&#x540C;&#x3002;&#x6309;&#x7167;&#x6211;&#x7684;&#x7406;&#x89E3;&#xFF0C;&#x4F5C;&#x8005;&#x662F;&#x60F3;&#x8BF4;&#xFF0C;&#x5728;&#x8FDB;&#x884C;&#x5B8C;&#x6240;&#x6709;&#x7684;&#x7F16;&#x7801;&#x4EE5;&#x540E;&#xFF0C;&#x4F60;&#x5DF2;&#x7ECF;&#x5BF9;&#x4F60;&#x7684;&#x8981;&#x5B9E;&#x73B0;&#x7684;&#x6240;&#x6709;&#x4E1C;&#x897F;&#x5B8C;&#x6210;&#x4E86;unknown<span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6; display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="line-height: 1.6; display: inline-block; position: relative; width: 2.169ex; height: 0.964ex; vertical-align: 0.12ex;"><span style="line-height: 1.6;"><img class="enMedia" src="/images/Test-Driven Development/SVGc430acae44d6c4874bd268c48184baa7" hash="f4a4c9b133ba2d97b64f72acf87add23" align="" alt="" longdesc="" width="15.75" height="8.75" border="" hspace="" vspace="" usemap="" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" title="" lang="" xml:lang="" dir=""></span></span></span></span></span>known&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x90A3;&#x4E48;&#x73B0;&#x5728;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x56DE;&#x8FC7;&#x5934;&#x770B;&#x770B;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x65F6;&#x5019;&#x91CD;&#x65B0;&#x5199;&#x4E00;&#x4EFD;&#x6D4B;&#x8BD5;&#x4F60;&#x5E94;&#x8BE5;&#x5199;&#x4EC0;&#x4E48;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">&#x56DE;&#x5230;&#x4F60;&#x9488;&#x5BF9;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x7684;&#x6700;&#x521D;&#x7684;&#x60F3;&#x6CD5;&#x6765;&#x5BF9;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x505A;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x3002;&#x4EE5;&#x671F;&#x5BF9;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x6709;&#x4E2A;&#x6574;&#x4F53;&#x7684;&#x8BC4;&#x4EF7;&#x3002;</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="break"><a name="break" style="background: transparent; color: #1980e6; text-decoration: none;">Break</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x52B3;&#x9038;&#x7ED3;&#x5408;&#x5BF9;&#x7A0B;&#x5E8F;&#x5458;&#x662F;&#x975E;&#x5E38;&#x975E;&#x5E38;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#xFF01;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">Shower Methodology</strong>:If you know what to type, then type. If you don&#x2019;t know what to type, then take a shower, and stay in the shower until you know what to type. <br><strong style="font-weight: bold; line-height: 1.6;">TDD Rule</strong>: If you don&#x2019;t know what to type, then Fake It. If the <br>right design still isn&#x2019;t clear, then Triangulate. </p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x770B;&#x770B;&#x4F5C;&#x8005;&#x63D0;&#x5021;&#x7684;&#x65F6;&#x95F4;&#x7BA1;&#x7406;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><ul style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">At the scale of hours, keep a water bottle by your keyboard so that biology provides the motivation for regular breaks.</li><li style="line-height: 1.6;">At the scale of a day, commitments after regular work hours can help you to stop when you need sleep before progress.</li><li style="line-height: 1.6;">At the scale of a week, weekend commitments help get your conscious, energysucking thoughts off work. (My wife swears I get my best ideas on Friday evening.)</li><li style="line-height: 1.6;">At the scale of a year, mandatory vacation policies help you refresh yourself completely. The French do this right&#x2014;two contiguous weeks of vacation aren&#x2019;t enough. You spend the first week decompressing, and the second week getting ready to go back to work. Therefore, three weeks, or better four, are necessary for you to be your most effective the rest of the year.</li></ul></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="do-over"><a name="do-over" style="background: transparent; color: #1980e6; text-decoration: none;">Do Over</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">What do you do when you are feeling lost? Throw away the code and start over. <br>&#x4F5C;&#x8005;&#x5728;&#x8FD9;&#x4E00;&#x7AE0;&#x544A;&#x8BC9;&#x4F60;&#xFF0C;&#x4E0D;&#x8981;&#x5728;&#x6CE5;&#x6F6D;&#x8D8A;&#x9677;&#x8D8A;&#x6DF1;&#xFF0C;&#x4E0D;&#x8981;&#x5BB3;&#x6015;&#x91CD;&#x65B0;&#x5F00;&#x59CB;&#x3002;&#x6362;&#x4E2A;&#x4F19;&#x4F34;&#xFF0C;&#x6362;&#x4E2A;&#x601D;&#x8DEF;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x6709;&#x66F4;&#x597D;&#x7684;&#x53D1;&#x73B0;&#x3002;</p></blockquote></div><div style="line-height: 1.6;"><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 2.15em; margin: 1.2em 0 .6em 0; text-align: start;" id="chapter-27-testing-patterns"><a name="chapter-27-testing-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 27. Testing Patterns</a></h2></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="child-test"><a name="child-test" style="background: transparent; color: #1980e6; text-decoration: none;">Child Test</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x91CC;&#x8BF4;&#x7684;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x89C9;&#x5F97;&#x8FD9;&#x4E2A;&#x6D4B;&#x8BD5;&#x592A;&#x5927;&#xFF0C;&#x90A3;&#x5C31;&#x8981;&#x628A;&#x8FD9;&#x4E2A;&#x5927;&#x7684;&#x6D4B;&#x8BD5;&#x7834;&#x6210;&#x82E5;&#x5E72;&#x4E2A;&#x5C0F;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;&#x7136;&#x540E;&#x770B;&#x770B;&#x6709;&#x6CA1;&#x6709;&#x8FDB;&#x5C55;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="mock-object"><a name="mock-object" style="background: transparent; color: #1980e6; text-decoration: none;">Mock Object</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you test an object that relies on an expensive or complicated resource? Create a fake version of the resource that answers constants. <br>If you want to use Mock Objects, you can&#x2019;t easily store expensive resources in global variables.&#x8981;&#x8BB0;&#x5F97;&#x6E05;&#x7406;&#x73B0;&#x573A;&#xFF0C;&#x5426;&#x5219;&#x4E07;&#x4E00;&#x5176;&#x4ED6;&#x7684;&#x4EE3;&#x7801;&#x628A;&#x4ED6;&#x5F53;&#x4F5C;&#x771F;&#x7684;object&#x5728;&#x4F7F;&#x7528;&#xFF0C;&#x5C31;&#x4F1A;&#x51FA;&#x5927;&#x95EE;&#x9898;&#x3002;&#x6240;&#x4EE5;&#x7F16;&#x7801;&#x6700;&#x57FA;&#x672C;&#x7684;&#x51C6;&#x5219;&#x662F;&#x5C11;&#x7528;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3002; <br>Mock Objects encourage you down the path of carefully considering the visibility of every object, reducing the coupling in your designs. &#x8FD9;&#x91CC;&#x8BF4;&#x7684;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x7528;Mock Object&#xFF0C;&#x4F60;&#x5C31;&#x8981;&#x601D;&#x8003;&#x6211;&#x5230;&#x5E95;&#x8BE5;&#x4E0D;&#x8BE5;&#x628A;&#x8FD9;&#x4E2A;&#x5E9E;&#x7136;&#x5927;&#x7269;&#x66B4;&#x9732;&#x7ED9;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x3002;&#x8FD9;&#x79CD;&#x601D;&#x8003;&#x6709;&#x52A9;&#x4E8E;&#x51CF;&#x5C0F;&#x8026;&#x5408;&#x6027;&#x3002;</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="self-shunt"><a name="self-shunt" style="background: transparent; color: #1980e6; text-decoration: none;">Self Shunt</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you test that one object communicates correctly with another? Have the object under test communicate with the test case instead of with the object it expects.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">Without Self Shunt</strong></p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #969896;"># ResultListenerTest</span><br><span style="line-height: 1.6; display: none; color: #969896;">2.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">def</span> <span style="line-height: 1.6; color: #795da3;">testNotification</span><span style="line-height: 1.6; color: #f8f8f2;">(self)</span>:</span> <br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    result= TestResult() <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>    listener= ResultListener() <br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>    result.addListener(listener) <br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    WasRun(<span style="line-height: 1.6; color: #df5000;">&quot;testMethod&quot;</span>).run(result)<br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>    <span style="line-height: 1.6; color: #a71d5d;">assert</span> <span style="line-height: 1.6; color: #ae81ff;">1</span> == listener.count <br><span style="line-height: 1.6; display: none; color: #969896;">8.</span><br><span style="line-height: 1.6; display: none; color: #969896;">9.</span><span style="line-height: 1.6; color: #969896;"># ResultListener</span><br><span style="line-height: 1.6; display: none; color: #969896;">10.</span><span style="line-height: 1.6;"><span style="line-height: 1.6; color: #66d9ef;">class</span> <span style="line-height: 1.6; color: #a6e22e; font-style: italic;">ResultListener</span>:</span><br><span style="line-height: 1.6; display: none; color: #969896;">11.</span>    <span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">def</span> <span style="line-height: 1.6; color: #795da3;">__init__</span><span style="line-height: 1.6; color: #f8f8f2;">(self)</span>:</span> <br><span style="line-height: 1.6; display: none; color: #969896;">12.</span>        self.count= <span style="line-height: 1.6; color: #ae81ff;">0</span> <br><span style="line-height: 1.6; display: none; color: #969896;">13.</span>    <span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">def</span> <span style="line-height: 1.6; color: #795da3;">startTest</span><span style="line-height: 1.6; color: #f8f8f2;">(self)</span>:</span> <br><span style="line-height: 1.6; display: none; color: #969896;">14.</span>        self.count= self.count + <span style="line-height: 1.6; color: #ae81ff;">1</span> <br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">With Self Shunt</strong></p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #969896;"># ResultListenerTest</span><br><span style="line-height: 1.6; display: none; color: #969896;">2.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">def</span> <span style="line-height: 1.6; color: #795da3;">testNotification</span><span style="line-height: 1.6; color: #f8f8f2;">(self)</span>:</span> <br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    self.count= <span style="line-height: 1.6; color: #ae81ff;">0</span> <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>    result= TestResult()<br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>    result.addListener(self)<br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    WasRun(<span style="line-height: 1.6; color: #df5000;">&quot;testMethod&quot;</span>).run(result) <br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>    <span style="line-height: 1.6; color: #a71d5d;">assert</span> <span style="line-height: 1.6; color: #ae81ff;">1</span> == self.count<br><span style="line-height: 1.6; display: none; color: #969896;">8.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">def</span> <span style="line-height: 1.6; color: #795da3;">startTest</span><span style="line-height: 1.6; color: #f8f8f2;">(self)</span>:</span><br><span style="line-height: 1.6; display: none; color: #969896;">9.</span>    self.count= self.count + <span style="line-height: 1.6; color: #ae81ff;">1</span><br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x91CC;&#x4E3E;&#x5F97;&#x4F8B;&#x5B50;&#x4E0D;&#x662F;&#x5F88;&#x660E;&#x767D;&#x3002;&#x4E2D;&#x6587;&#x8BD1;&#x672C;&#x91CC;&#xFF0C;&#x5C06;self shunt&#x7FFB;&#x8BD1;&#x6210;&#x81EA;&#x5206;&#x6D41;&#xFF0C;&#x611F;&#x89C9;&#x4E5F;&#x662F;&#x5B57;&#x9762;&#x7FFB;&#x8BD1;&#x3002;&#x6211;&#x7406;&#x89E3;&#x8FD9;&#x91CC;&#x60F3;&#x8BF4;&#x7684;&#x662F;&#xFF0C;&#x4E0D;&#x4E00;&#x5B9A;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7C7B;&#x6765;&#x505A;&#x5F53;&#x524D;&#x88AB;&#x6D4B;&#x8BD5;&#x7C7B;&#x6765;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;test case&#x91CC;&#x9762;&#x7528;&#x8BE5;&#x7C7B;&#x66B4;&#x9732;&#x7684;&#x63A5;&#x53E3;&#x6765;&#x505A;&#x4E8B;&#x60C5;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">Self Shunt may require that you use <strong style="font-weight: bold; line-height: 1.6;">Extract Interface</strong> to get an interface to implement. You will have to decide whether extracting the interface is easier, or if testing the existing class as a <strong style="font-weight: bold; line-height: 1.6;">black box</strong> is easier.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x91CC;&#x53C8;&#x770B;&#x6655;&#x4E86;&#xFF0C;self shunt&#x8DDF;extract interface&#x6709;&#x5565;&#x5173;&#x7CFB;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">&#x5F53;&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;&#x5728;&#x6211;&#x4EEC;&#x4EE3;&#x7801;&#x7ED3;&#x6784;&#x4E2D;&#x8D85;&#x8FC7;&#x4E00;&#x4E2A;&#x7C7B;&#x4F7F;&#x7528;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7C7B;&#x4E2D;&#x7684;&#x540C;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x6B64;&#x65F6;&#x5E94;&#x8BE5;&#x5C06;&#x8BE5;&#x7C7B;&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x63D0;&#x53D6;&#x51FA;&#x6765;&#x653E;&#x5230;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF08;interface&#xFF09;&#x4E2D;&#xFF0C;&#x5E76;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#x4EE5;&#x4FBF;&#x88AB;&#x7528;&#x6237;&#x7C7B;&#x8BBF;&#x95EE;&#x3001;&#x4F7F;&#x7528;&#xFF0C;&#x8FD9;&#x6837;&#x6709;&#x5229;&#x4E8E;&#x6253;&#x7834;&#x539F;&#x6765;&#x591A;&#x4E2A;&#x7C7B;&#x4E0E;&#x8FD9;&#x4E2A;&#x7279;&#x6B8A;&#x7C7B;&#x7684;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x3002;&#x8FD9;&#x4E2A;&#x91CD;&#x6784;&#x624B;&#x6CD5;&#x5F88;&#x5BB9;&#x6613;&#x5B9E;&#x73B0;&#xFF0C;&#x66F4;&#x91CD;&#x8981;&#x7684;&#x662F;&#x8FD9;&#x6837;&#x505A;&#x6709;&#x5229;&#x4E8E;&#x677E;&#x8026;&#x5408;&#x3002; &#x2014;&#x2014;&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x89E3;&#x91CA;</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x6211;&#x89C9;&#x5F97;&#x8FD9;&#x91CC;&#x4F5C;&#x8005;&#x63D0;&#x5230;&#x7684;extract interface&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x8BF4;&#x7684;&#x91CD;&#x6784;&#x91CC;&#x7684;extract interface&#x3002;&#x8FD9;&#x91CC;&#x8BF4;&#x8981;&#x6D4B;&#x8BD5;A&#x7C7B;&#x548C;B&#x7C7B;&#x901A;&#x4FE1;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x76F4;&#x63A5;&#x7528;B&#x7C7B;&#xFF0C;&#x800C;&#x7528;test case&#x4E0E;A&#x7C7B;&#x901A;&#x4FE1;&#xFF0C;&#x4EE5;&#x6D4B;&#x8BD5;&#x901A;&#x4FE1;&#x7684;A&#x7C7B;&#x7AEF;&#x63A5;&#x53E3;&#x662F;&#x5426;&#x6B63;&#x786E;&#x3002;extract interface&#x8BF4;&#x7684;&#x662F;&#x4ECE;B&#x7C7B;&#x4E2D;extract&#x63A5;&#x53E3;&#x51FA;&#x6765;&#x5230;test case&#x4E2D;&#x53BB;implement&#x3002;&#x6216;&#x8005;&#x628A;B&#x7C7B;&#x76F4;&#x63A5;&#x5F53;&#x9ED1;&#x76D2;&#x5B50;&#x5728;test case&#x4E2D;&#x4F7F;&#x7528;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="log-string"><a name="log-string" style="background: transparent; color: #1980e6; text-decoration: none;">Log String</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E2A;&#x5F88;&#x6709;&#x7528;&#x3002;&#x6709;&#x4E9B;&#x51FD;&#x6570;&#x6216;&#x8005;&#x8FC7;&#x7A0B;&#x662F;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x7528;Log String&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x67E5;&#x770B;&#x8BE5;&#x8FC7;&#x7A0B;&#x6216;&#x51FD;&#x6570;&#x6709;&#x6CA1;&#x6709;&#x88AB;&#x8C03;&#x7528;&#x3002;&#x7C7B;&#x4F3C;&#x6211;&#x4EEC;&#x770B;trace log&#x4E00;&#x6837;&#xFF0C;&#x901A;&#x8FC7;&#x770B;trace log&#x80FD;&#x77E5;&#x9053;&#x673A;&#x5668;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x5426;&#x6B63;&#x786E;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="crash-test-dummy"><a name="crash-test-dummy" style="background: transparent; color: #1980e6; text-decoration: none;">Crash Test Dummy</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you test error code that is unlikely to be invoked? Invoke it anyway with a special object that throws an exception instead of doing real work.</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="broken-test"><a name="broken-test" style="background: transparent; color: #1980e6; text-decoration: none;">Broken Test</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F5C;&#x8005;&#x7ECF;&#x5E38;&#x80FD;&#x7ED9;&#x51FA;&#x4E00;&#x4E9B;&#x5F88;&#x5B9E;&#x7528;&#x7684;&#x5C0F;&#x7ECF;&#x9A8C;&#xFF0C;&#x8FD9;&#x91CC;&#x53C8;&#x6765;&#x4E86;&#xFF0C;&#x770B;&#x4E0B;&#x9762;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you leave a programming session when you&#x2019;re programming alone? Leave the last test broken.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5F53;&#x4F60;&#x8981;&#x8F6C;&#x53BB;&#x505A;&#x53E6;&#x5916;&#x4E00;&#x4EF6;&#x4E8B;&#x60C5;&#xFF0C;&#x800C;&#x624B;&#x5934;&#x4E0A;&#x7684;&#x4E8B;&#x60C5;&#x53C8;&#x6CA1;&#x7ED3;&#x675F;&#x65F6;&#x600E;&#x4E48;&#x529E;&#xFF1F;&#x8BA9;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x6545;&#x610F;&#x7684;&#x4E0D;&#x901A;&#x8FC7;&#x3002;&#x8FD9;&#x6837;&#x4E0B;&#x6B21;&#x5C31;&#x77E5;&#x9053;&#x4ECE;&#x54EA;&#x513F;&#x5F00;&#x59CB;&#xFF0C;&#x7136;&#x540E;&#x80FD;&#x8FC5;&#x901F;&#x4E0A;&#x624B;&#x3002;&#x918D;&#x9190;&#x704C;&#x9876;&#x554A;&#xFF01;&#x4EE5;&#x524D;&#x90FD;&#x662F;&#x8BA4;&#x4E3A;&#x505A;&#x53E6;&#x5916;&#x4E00;&#x4EF6;&#x4E8B;&#x60C5;&#x4E4B;&#x524D;&#x8981;&#x628A;&#x624B;&#x5934;&#x4E0A;&#x7684;&#x4E8B;&#x60C5;&#x5F04;&#x7684;&#x5C3D;&#x5584;&#x5C3D;&#x7F8E;&#xFF0C;&#x5176;&#x5B9E;&#x4E0D;&#x7136;&#x3002;&#x600E;&#x4E48;&#x505A;&#x5229;&#x4E8E;&#x540E;&#x671F;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#xFF0C;&#x90A3;&#x5C31;&#x5E94;&#x8BE5;&#x600E;&#x4E48;&#x505A;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="clean-check-in"><a name="clean-check-in" style="background: transparent; color: #1980e6; text-decoration: none;">Clean Check-in</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">You will occasionally find a test broken in the integration suite when you try to check in. What to do? <br><strong style="font-weight: bold; line-height: 1.6;">The simplest rule</strong> is to just throw away your work and start over. The broken test is pretty strong evidence that you didn&#x2019;t know enough to program what you just programmed. <br>&#x4EC0;&#x4E48;&#x4EC0;&#x4E48;&#xFF1F;&#x7ADF;&#x7136;&#x8981;&#x6211;&#x4EEC;&#x6254;&#x6389;&#x6211;&#x4EEC;&#x505A;&#x7684;&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x65B0;&#x5F00;&#x59CB;&#x3002;&#x5C31;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x6D4B;&#x8BD5;&#x548C;integration&#x6D4B;&#x8BD5;&#x7ED3;&#x679C;&#x4E0D;&#x4E00;&#x81F4;&#x3002; <br>&#x5927;&#x5E08;&#x7684;&#x8BDD;&#x603B;&#x662F;&#x6709;&#x9053;&#x7406;&#x7684;&#xFF0C;&#x4EE5;&#x540E;&#x8981;&#x597D;&#x597D;&#x8003;&#x8651;&#x8FD9;&#x4E00;&#x70B9;&#x3002;</p></blockquote></div><div style="line-height: 1.6;"><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 2.15em; margin: 1.2em 0 .6em 0; text-align: start;" id="chapter-28-green-bar-patterns"><a name="chapter-28-green-bar-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 28. Green Bar Patterns</a></h2></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="fake-it-x2018til-you-make-it"><a name="fake-it-til-you-make-it" style="background: transparent; color: #1980e6; text-decoration: none;">Fake It (&#x2018;Til You Make It)</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x505A;&#x5047;&#x4EE3;&#x7801;&#x8BA9;&#x6D4B;&#x8BD5;&#x901A;&#x8FC7;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x4E00;&#x9879;&#x4E00;&#x9879;&#x5730;&#x5B8C;&#x6210;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="triangulate"><a name="triangulate" style="background: transparent; color: #1980e6; text-decoration: none;">Triangulate</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F5C;&#x8005;&#x63D0;&#x5230;&#x7684;&#x6240;&#x8C13;&#x4E09;&#x89D2;&#x6CD5;&#x3002;&#x901A;&#x4FD7;&#x7684;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x53EA;&#x5728;&#x5FC5;&#x8981;&#x7684;&#x65F6;&#x5019;&#x505A;&#x62BD;&#x8C61;&#x6216;&#x901A;&#x7528;&#x5316;&#x5904;&#x7406;&#x3002;&#x901A;&#x5E38;&#x662F;&#x5728;TDD&#x7684;&#x91CD;&#x6784;&#x8FD9;&#x4E00;&#x6B65;&#x5B8C;&#x6210;&#x8FD9;&#x4E2A;&#x62BD;&#x8C61;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x518D;&#x901A;&#x4FD7;&#x70B9;&#x8BF4;&#xFF0C;&#x5C31;&#x662F;&#x591A;&#x5F04;&#x51E0;&#x4E2A;case&#xFF0C;&#x518D;&#x603B;&#x7ED3;&#x5171;&#x540C;&#x70B9;&#xFF0C;&#x4E4B;&#x540E;&#x505A;&#x62BD;&#x8C61; <br>&#x4ECE;&#x53E6;&#x4E00;&#x4E2A;&#x89D2;&#x5EA6;&#xFF0C;&#x4F5C;&#x8005;&#x53C8;&#x8BF4;&#x4E86;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">I only use Triangulation when I&#x2019;m really, really unsure about the correct abstraction for the calculation. Otherwise I rely on either Obvious Implementation or Fake It.</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="one-to-many"><a name="one-to-many" style="background: transparent; color: #1980e6; text-decoration: none;">One to Many</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you implement an operation that works with collections of objects? Implement it without the collections first, then make it work with collections.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E2D;&#x5FC3;&#x601D;&#x60F3;&#x8FD8;&#x662F;&#x4E00;&#x4E2A;&#xFF0C;&#x4ECE;&#x663E;&#x800C;&#x6613;&#x89C1;&#x7684;&#x5730;&#x65B9;&#x5F00;&#x59CB;&#xFF0C;&#x6BCF;&#x6B21;&#x53EA;&#x505A;&#x4E00;&#x5C0F;&#x6B65;&#xFF0C;&#x7136;&#x540E;&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x5230;&#x8FBE;&#x6700;&#x7EC8;&#x7684;&#x76EE;&#x7684;&#x5730;&#x3002;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #969896;">// 1. fake code</span><br><span style="line-height: 1.6; display: none; color: #969896;">2.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">testSum</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    assertEquals(<span style="line-height: 1.6; color: #ae81ff;">5</span>, sum(<span style="line-height: 1.6; color: #ae81ff;">5</span>)); <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>} <br><span style="line-height: 1.6; display: none; color: #969896;">5.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">private</span> <span style="line-height: 1.6; color: #66d9ef;">int</span> <span style="line-height: 1.6; color: #795da3;">sum</span><span style="line-height: 1.6; color: #f8f8f2;">(<span style="line-height: 1.6; color: #66d9ef;">int</span> value)</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    <span style="line-height: 1.6; color: #a71d5d;">return</span> value;<br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">8.</span><br><span style="line-height: 1.6; display: none; color: #969896;">9.</span><span style="line-height: 1.6; color: #969896;">// 2. add arrays</span><br><span style="line-height: 1.6; display: none; color: #969896;">10.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">testSum</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">11.</span>    assertEquals(<span style="line-height: 1.6; color: #ae81ff;">5</span>, sum(<span style="line-height: 1.6; color: #ae81ff;">5</span>, <span style="line-height: 1.6; color: #a71d5d;">new</span> <span style="line-height: 1.6; color: #a71d5d;">int</span>[] {<span style="line-height: 1.6; color: #ae81ff;">5</span>}));<br><span style="line-height: 1.6; display: none; color: #969896;">12.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">13.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">private</span> <span style="line-height: 1.6; color: #66d9ef;">int</span> <span style="line-height: 1.6; color: #795da3;">sum</span><span style="line-height: 1.6; color: #f8f8f2;">(<span style="line-height: 1.6; color: #66d9ef;">int</span> value, <span style="line-height: 1.6; color: #66d9ef;">int</span>[] values)</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">14.</span>    <span style="line-height: 1.6; color: #a71d5d;">return</span> value;<br><span style="line-height: 1.6; display: none; color: #969896;">15.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">16.</span><br><span style="line-height: 1.6; display: none; color: #969896;">17.</span><span style="line-height: 1.6; color: #969896;">// 3. add real sum functionality</span><br><span style="line-height: 1.6; display: none; color: #969896;">18.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">testSum</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">19.</span>    assertEquals(<span style="line-height: 1.6; color: #ae81ff;">5</span>, sum(<span style="line-height: 1.6; color: #ae81ff;">5</span>, <span style="line-height: 1.6; color: #a71d5d;">new</span> <span style="line-height: 1.6; color: #a71d5d;">int</span>[] {<span style="line-height: 1.6; color: #ae81ff;">5</span>}));<br><span style="line-height: 1.6; display: none; color: #969896;">20.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">21.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">private</span> <span style="line-height: 1.6; color: #66d9ef;">int</span> <span style="line-height: 1.6; color: #795da3;">sum</span><span style="line-height: 1.6; color: #f8f8f2;">(<span style="line-height: 1.6; color: #66d9ef;">int</span> value, <span style="line-height: 1.6; color: #66d9ef;">int</span>[] values)</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">22.</span>    <span style="line-height: 1.6; color: #a71d5d;">int</span> sum= <span style="line-height: 1.6; color: #ae81ff;">0</span>; <br><span style="line-height: 1.6; display: none; color: #969896;">23.</span>    <span style="line-height: 1.6; color: #a71d5d;">for</span> ( <span style="line-height: 1.6; color: #a71d5d;">int</span> i= <span style="line-height: 1.6; color: #ae81ff;">0</span>; i&lt;values.length; i++)<br><span style="line-height: 1.6; display: none; color: #969896;">24.</span>        sum += values[i];<br><span style="line-height: 1.6; display: none; color: #969896;">25.</span>    <span style="line-height: 1.6; color: #a71d5d;">return</span> sum;<br><span style="line-height: 1.6; display: none; color: #969896;">26.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">27.</span><br><span style="line-height: 1.6; display: none; color: #969896;">28.</span><span style="line-height: 1.6; color: #969896;">// 4. delete unnecessary code</span><br><span style="line-height: 1.6; display: none; color: #969896;">29.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">testSum</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">30.</span>    assertEquals(<span style="line-height: 1.6; color: #ae81ff;">5</span>, sum(<span style="line-height: 1.6; color: #a71d5d;">new</span> <span style="line-height: 1.6; color: #a71d5d;">int</span>[] {<span style="line-height: 1.6; color: #ae81ff;">5</span>}));<br><span style="line-height: 1.6; display: none; color: #969896;">31.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">32.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">private</span> <span style="line-height: 1.6; color: #66d9ef;">int</span> <span style="line-height: 1.6; color: #795da3;">sum</span><span style="line-height: 1.6; color: #f8f8f2;">( <span style="line-height: 1.6; color: #66d9ef;">int</span>[] values)</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">33.</span>    <span style="line-height: 1.6; color: #a71d5d;">int</span> sum= <span style="line-height: 1.6; color: #ae81ff;">0</span>; <br><span style="line-height: 1.6; display: none; color: #969896;">34.</span>    <span style="line-height: 1.6; color: #a71d5d;">for</span> (<span style="line-height: 1.6; color: #a71d5d;">int</span> i= <span style="line-height: 1.6; color: #ae81ff;">0</span>; i&lt;values.length; i++)<br><span style="line-height: 1.6; display: none; color: #969896;">35.</span>        sum += values[i];<br><span style="line-height: 1.6; display: none; color: #969896;">36.</span>    <span style="line-height: 1.6; color: #a71d5d;">return</span> sum; sum;<br><span style="line-height: 1.6; display: none; color: #969896;">37.</span>}<br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x7EC6;&#x7EC6;&#x4F53;&#x4F1A;&#x5176;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x5427;&#x3002;</p></div><div style="line-height: 1.6;"><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 2.15em; margin: 1.2em 0 .6em 0; text-align: start;" id="chapter-29-xunit-patterns"><a name="chapter-29-xunit-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 29. xUnit Patterns</a></h2></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="assertion"><a name="assertion" style="background: transparent; color: #1980e6; text-decoration: none;">Assertion</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you check that tests worked correctly?  <br>Write boolean expressions that automate your judgment about whether the code worked.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F5C;&#x8005;&#x5728;&#x8FD9;&#x4E00;&#x7AE0;&#x53C8;&#x7ED9;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x6709;&#x6307;&#x5BFC;&#x610F;&#x4E49;&#x7684;&#x89C2;&#x70B9;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">&#x5C3D;&#x91CF;&#x4E0D;&#x8981;&#x505A;&#x767D;&#x76D2;&#x6D4B;&#x8BD5;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x505A;&#xFF0C;&#x8BF4;&#x660E;&#x4F60;&#x7684;&#x8BBE;&#x8BA1;&#x6709;&#x95EE;&#x9898;</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="fixture"><a name="fixture" style="background: transparent; color: #1980e6; text-decoration: none;">Fixture</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x91CC;&#x4F5C;&#x8005;&#x629B;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x6D4B;&#x8BD5;&#x6709;&#x7C7B;&#x4F3C;&#x7684;&#x4EE3;&#x7801;&#x600E;&#x4E48;&#x529E;&#xFF1F;&#x4E24;&#x4E2A;&#x9009;&#x62E9;&#xFF1A;</p><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">test case&#x7C7B;&#x5B9A;&#x4E49;&#x4E2D;&#x62BD;&#x8C61;&#x51FA;&#x7C7B;&#x4F3C;setUp&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x6765;&#x505A;&#x91CD;&#x590D;&#x7684;&#x5DE5;&#x4F5C;</li><li style="line-height: 1.6;">&#x6216;&#x8005;&#x7528;&#x7C7B;&#x4F3C;&#x4EE3;&#x7801;&#x751F;&#x6210;&#x5668;&#x7684;&#x4E1C;&#x897F;&#x6765;&#x4E3A;&#x6240;&#x6709;&#x9700;&#x8981;&#x7684;&#x6D4B;&#x8BD5;&#x751F;&#x6210;fixture</li></ol><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x65B9;&#x6CD5;1&#x6709;&#x65F6;&#x5019;&#x66F4;&#x7B26;&#x5408;DRY&#x539F;&#x5219;&#xFF0C;&#x4F46;&#x5B83;&#x7684;&#x7F3A;&#x70B9;&#x662F;&#xFF0C;&#x4F60;&#x8981;&#x8BB0;&#x4F4F;setUp&#x91CC;&#x9762;&#x5230;&#x5E95;&#x505A;&#x4E86;&#x4EC0;&#x4E48;&#x3002;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x53EF;&#x4EE5;&#xFF0C;&#x9009;&#x62E9;&#x66F4;&#x5408;&#x9002;&#x7684;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="external-fixture"><a name="external-fixture" style="background: transparent; color: #1980e6; text-decoration: none;">External Fixture</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x6240;&#x8C13;&#x7684;&#x5916;&#x90E8;fixture&#xFF0C;&#x5C31;&#x662F;&#x8981;&#x4FDD;&#x8BC1;&#x6D4B;&#x8BD5;&#x80FD;&#x6062;&#x590D;&#x73AF;&#x5883;&#x914D;&#x7F6E;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">&#x5728;&#x6240;&#x6709;&#x6D4B;&#x8BD5;&#x5F00;&#x59CB;&#x524D;&#x8C03;setUp&#xFF0C;&#x6240;&#x6709;&#x6D4B;&#x8BD5;&#x7ED3;&#x675F;&#x540E;&#x8C03;tearDown&#x3002;&#x8FD9;&#x5C31;&#x662F;External Fixture</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="test-method"><a name="test-method" style="background: transparent; color: #1980e6; text-decoration: none;">Test Method</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E00;&#x8282;&#x9488;&#x5BF9;&#x5982;&#x4F55;&#x5199;&#x6D4B;&#x8BD5;&#x65B9;&#x6CD5;&#x7ED9;&#x51FA;&#x4E86;&#x4E00;&#x4E9B;&#x5EFA;&#x8BAE;&#x3002;</p><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">hierarchy <br><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">Module <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6; display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="line-height: 1.6; display: inline-block; position: relative; width: 2.169ex; height: 0.964ex; vertical-align: 0.12ex;"><span style="line-height: 1.6;"><img class="enMedia" src="/images/Test-Driven Development/SVGc430acae44d6c4874bd268c48184baa7" hash="f4a4c9b133ba2d97b64f72acf87add23" align="" alt="" longdesc="" width="15.75" height="8.75" border="" hspace="" vspace="" usemap="" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" title="" lang="" xml:lang="" dir=""></span></span></span></span></span> Framework</li><li style="line-height: 1.6;">Class <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6; display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="line-height: 1.6; display: inline-block; position: relative; width: 2.169ex; height: 0.964ex; vertical-align: 0.12ex;"><span style="line-height: 1.6;"><img class="enMedia" src="/images/Test-Driven Development/SVGc430acae44d6c4874bd268c48184baa7" hash="f4a4c9b133ba2d97b64f72acf87add23" align="" alt="" longdesc="" width="15.75" height="8.75" border="" hspace="" vspace="" usemap="" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" title="" lang="" xml:lang="" dir=""></span></span></span></span></span> internal fixture</li><li style="line-height: 1.6;">Method <span style="line-height: 1.6;"><span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; margin: 0; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; padding: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; line-height: 1.6; display: inline-block; font-size: 100%;"><span style="line-height: 1.6; display: inline-block; white-space: nowrap; padding: 1px 0px;"><span style="line-height: 1.6; display: inline-block; position: relative; width: 2.169ex; height: 0.964ex; vertical-align: 0.12ex;"><span style="line-height: 1.6;"><img class="enMedia" src="/images/Test-Driven Development/SVGc430acae44d6c4874bd268c48184baa7" hash="f4a4c9b133ba2d97b64f72acf87add23" align="" alt="" longdesc="" width="15.75" height="8.75" border="" hspace="" vspace="" usemap="" style="border: 0; vertical-align: middle; max-width: 100%; margin-top: 0; margin-bottom: 0;" title="" lang="" xml:lang="" dir=""></span></span></span></span></span> test case</li></ul></li><li style="line-height: 1.6;">&#x540D;&#x5B57;&#x957F;&#x6CA1;&#x5173;&#x7CFB;&#xFF0C;&#x8981;&#x8BA9;&#x4EE5;&#x540E;&#x7684;&#x8BFB;&#x8005;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x7EBF;&#x7D22;&#x77E5;&#x9053;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x5199;&#x8FD9;&#x4E2A;test</li><li style="line-height: 1.6;">&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x8981;&#x591F;&#x76F4;&#x89C9;&#xFF0C;&#x8981;&#x591F;&#x7B80;&#x6D01;&#xFF08;&#x6700;&#x77ED;3&#x884C;&#xFF09; </li><li style="line-height: 1.6;">&#x6CE8;&#x91CA;&#x91CC;&#x5199;outline&#xFF0C;&#x4E00;&#x9897;&#x661F;&#x8868;&#x793A;&#x4E00;&#x7EA7;&#xFF0C;&#x4F5C;&#x8005;&#x8BF4;&#x4ED6;&#x4E00;&#x822C;&#x5199;2-3&#x7EA7;outline</li></ol></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #969896;">/* Adding to tuple spaces. */</span> <br><span style="line-height: 1.6; display: none; color: #969896;">2.</span><span style="line-height: 1.6; color: #969896;">/* Taking from tuple spaces. */</span><br><span style="line-height: 1.6; display: none; color: #969896;">3.</span><span style="line-height: 1.6; color: #969896;">/** Taking a non-existent tuple. **/</span> <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span><span style="line-height: 1.6; color: #969896;">/** Taking an existing tuple. **/</span> <br><span style="line-height: 1.6; display: none; color: #969896;">5.</span><span style="line-height: 1.6; color: #969896;">/** Taking multiple tuples. **/</span> <br><span style="line-height: 1.6; display: none; color: #969896;">6.</span><span style="line-height: 1.6; color: #969896;">/* Reading from tuple space. */</span><br></code></pre></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="exception-test"><a name="exception-test" style="background: transparent; color: #1980e6; text-decoration: none;">Exception Test</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E00;&#x8282;&#x8BF4;&#x7684;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x5F85;&#x6D4B;&#x7684;&#x51FD;&#x6570;&#x9700;&#x8981;&#x629B;&#x51FA;&#x5F02;&#x5E38;&#xFF0C;&#x7528;&#x5982;&#x4E0B;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">testMissingRate</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>    <span style="line-height: 1.6; color: #a71d5d;">try</span> {<br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>        exchange.findRate(<span style="line-height: 1.6; color: #df5000;">&quot;USD&quot;</span>, <span style="line-height: 1.6; color: #df5000;">&quot;GBP&quot;</span>); <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>        fail(); <span style="line-height: 1.6; color: #969896;">// &#x5982;&#x679C;&#x6CA1;&#x629B;&#x5F02;&#x5E38;&#x5C31;fail</span><br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>    } <span style="line-height: 1.6; color: #a71d5d;">catch</span> (IllegalArgumentException expected) { <br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    }<br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>}<br></code></pre></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="all-tests"><a name="all-tests" style="background: transparent; color: #1980e6; text-decoration: none;">All Tests</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you run all tests together? Make a suite of all the suites&#x2014;one for each package, and one aggregating the package tests for the whole application.</p></blockquote></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #a71d5d;">public</span> <span style="line-height: 1.6;"><span style="line-height: 1.6; color: #66d9ef;">class</span> <span style="line-height: 1.6; color: #a6e22e; font-style: italic;">AllTests</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>    <span style="line-height: 1.6; color: #969896;">// &#x8FD9;&#x91CC;&#x6709;&#x4E2A;main&#xFF0C;&#x65B9;&#x4FBF;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x5F00;&#x59CB;&#x6D4B;&#x8BD5;</span><br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    <span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">static</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">main</span><span style="line-height: 1.6; color: #f8f8f2;">(String[] args)</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>        junit.swingui.TestRunner.run(AllTests.class); <br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>    }<br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    <span style="line-height: 1.6; color: #969896;">// &#x8FD9;&#x91CC;&#x6709;&#x4E2A;suite&#x5305;&#x542B;&#x4E86;&#x6240;&#x6709;test case</span><br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>    <span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">static</span> Test <span style="line-height: 1.6; color: #795da3;">suite</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">8.</span>        TestSuite result= <span style="line-height: 1.6; color: #a71d5d;">new</span> TestSuite(<span style="line-height: 1.6; color: #df5000;">&quot;TFD tests&quot;</span>); <br><span style="line-height: 1.6; display: none; color: #969896;">9.</span>        result.addTestSuite(MoneyTest.class); <br><span style="line-height: 1.6; display: none; color: #969896;">10.</span>        result.addTestSuite(ExchangeTest.class); <br><span style="line-height: 1.6; display: none; color: #969896;">11.</span>        result.addTestSuite(IdentityRateTest.class); <br><span style="line-height: 1.6; display: none; color: #969896;">12.</span>        <span style="line-height: 1.6; color: #a71d5d;">return</span> result;<br><span style="line-height: 1.6; display: none; color: #969896;">13.</span>    }<br><span style="line-height: 1.6; display: none; color: #969896;">14.</span>}<br></code></pre></div><div style="line-height: 1.6;"><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 2.15em; margin: 1.2em 0 .6em 0; text-align: start;" id="chapter-30-design-patterns"><a name="chapter-30-design-patterns" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 30. Design Patterns</a></h2><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F5C;&#x8005;&#x5728;&#x8FD9;&#x4E00;&#x7AE0;&#x5F15;&#x5165;&#x4E86;&#x4E00;&#x4E9B;TDD&#x4E2D;&#x4F1A;&#x7528;&#x5230;&#x7684;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x3002;&#x6709;&#x4E9B;&#x662F;&#x5199;&#x6D4B;&#x8BD5;&#x65F6;&#x7528;&#x7684;&#xFF0C;&#x6709;&#x7684;&#x662F;&#x91CD;&#x6784;&#x65F6;&#x7528;&#x7684;&#xFF0C;&#x6709;&#x7684;&#x4E24;&#x8005;&#x7686;&#x53EF;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x672C;&#x7AE0;&#x6240;&#x6709;&#x6A21;&#x5F0F;&#x7684;&#x603B;&#x7EB2;&#x3002; <br><img class="enMedia" src="/images/Test-Driven Development/1456036251528.png" hash="402527467e6ed105cea7216a79760204" align="" alt="" longdesc="" width="" height="" border="" hspace="" vspace="" usemap="" style="border: 0; vertical-align: middle; max-width: 100%;" title="" lang="" xml:lang="" dir=""></p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="command"><a name="command" style="background: transparent; color: #1980e6; text-decoration: none;">Command</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">What do you do when you need the invocation of a computation to be more complicated than a simple method call? <br>Make an object for the computation and invoke it.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x91CC;&#x6240;&#x8BF4;&#x7684;&#x547D;&#x4EE4;&#x662F;&#x8BF4;&#xFF0C;&#x628A;&#x8981;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x5C01;&#x88C5;&#x6210;&#x4E00;&#x4E2A;object&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x90A3;&#x4E2A;object</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="value-object"><a name="value-object" style="background: transparent; color: #1980e6; text-decoration: none;">Value Object</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x628A;&#x4E00;&#x4E9B;&#x5E38;&#x91CF;&#x53C2;&#x6570;&#x505A;&#x6210;object&#x6765;&#x4F20;&#x9012;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">When implementing a Value Object, every operation has to return a fresh object,  <br>All Value Objects have to implement equality </p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="null-object"><a name="null-object" style="background: transparent; color: #1980e6; text-decoration: none;">Null Object</a></h3></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">boolean</span> <span style="line-height: 1.6; color: #795da3;">setReadOnly</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>    SecurityManager guard = System.getSecurityManager(); <br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    <span style="line-height: 1.6; color: #a71d5d;">if</span> (guard != <span style="line-height: 1.6; color: #a71d5d;">null</span>) { ) {<br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>        guard.canWrite(path);<br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>    } <br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    <span style="line-height: 1.6; color: #a71d5d;">return</span> fileSystem.setReadOnly(<span style="line-height: 1.6; color: #a71d5d;">this</span>);<br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>}<br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E0A;&#x9762;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;getSecurityManager&#x5728;&#x4E0D;&#x6210;&#x529F;&#x65F6;&#x8FD4;&#x56DE;Null&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x8005;&#x518D;&#x5224;&#x65AD;&#x8FD4;&#x56DE;&#x503C;&#x4EE5;&#x51B3;&#x5B9A;&#x4F1A;&#x4E0D;&#x4F1A;&#x7528;&#x7A7A;&#x6307;&#x9488;&#x6765;&#x8C03;&#x7528;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x3002; <br>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x5E38;&#x89C1;&#x7684;&#x505A;&#x6CD5;&#xFF0C;&#x8FD9;&#x6837;&#x505A;&#x4E0D;&#x597D;&#x7684;&#x662F;&#xFF0C;&#x901A;&#x5E38;&#x8FD9;&#x79CD;&#x5224;&#x65AD;&#x4F1A;&#x975E;&#x5E38;&#x975E;&#x5E38;&#x591A;&#xFF0C;&#x800C;&#x4E14;&#x7ED9;&#x4EBA;&#x4E00;&#x79CD;&#x201C;&#x4F1A;&#x4E0D;&#x4F1A;&#x6709;&#x54EA;&#x91CC;&#x6CA1;&#x5224;&#x65AD;&#xFF0C;&#x4EE5;&#x540E;&#x4F1A;&#x5BFC;&#x81F4;crash&#xFF1F;&#x201D;&#x7684;&#x62C5;&#x5FE7;&#x3002; <br>Null Object&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5C31;&#x662F;&#x8BA9;getSecurityManager&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;object&#x6765;&#x53D6;&#x4EE3;Null&#xFF0C;&#x8FD9;&#x6837;&#x8BA9;&#x6240;&#x6709;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x7EDF;&#x4E00;&#xFF0C;&#x4EE5;&#x51CF;&#x5C11;&#x91CD;&#x590D;&#x4EE3;&#x7801;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="template-method"><a name="template-method" style="background: transparent; color: #1980e6; text-decoration: none;">Template Method</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">When you find two variants of a sequence in two subclasses, you need to gradually move them closer together. Once you&#x2019;ve extracted the parts that are different from other methods, what you are left with is the Template Method. </p></blockquote></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #969896;">// TestCase</span><br><span style="line-height: 1.6; display: none; color: #969896;">2.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">runBare</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> <span style="line-height: 1.6; color: #66d9ef;">throws</span> Throwable </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    setUp(); <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>    <span style="line-height: 1.6; color: #a71d5d;">try</span> { <br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>        runTest();<br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    }<br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>    <span style="line-height: 1.6; color: #a71d5d;">finally</span> {<br><span style="line-height: 1.6; display: none; color: #969896;">8.</span>        tearDown();<br><span style="line-height: 1.6; display: none; color: #969896;">9.</span>    }<br><span style="line-height: 1.6; display: none; color: #969896;">10.</span>}<br></code></pre></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="pluggable-object"><a name="pluggable-object" style="background: transparent; color: #1980e6; text-decoration: none;">Pluggable Object</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E2D;&#x6587;&#x8BD1;&#x540D;&#x4E3A;&#x63D2;&#x5165;&#x5F0F;&#x5BF9;&#x8C61;&#x3002;&#x5F88;&#x96BE;&#x7406;&#x89E3;&#x54EA;&#x91CC;&#x6709;&#x8FD9;&#x4E2A;&#x6240;&#x8C13;&#x7684;&#x201C;&#x63D2;&#x5165;&#x201D;&#x3002;&#x8FD9;&#x4E2A;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x6838;&#x5FC3;&#x7684;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x6D88;&#x9664;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">if...else...</code>&#x7684;&#x60C5;&#x51B5;&#x3002; <br>&#x770B;&#x4F5C;&#x8005;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x89E3;&#x91CA;&#x7684;&#x5F88;&#x6E05;&#x695A;&#xFF1A;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #969896;">// Without Pluggable Object</span><br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>Figure selected; <br><span style="line-height: 1.6; display: none; color: #969896;">3.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">mouseDown</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>    selected= findFigure();<br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>    <span style="line-height: 1.6; color: #a71d5d;">if</span> (selected != <span style="line-height: 1.6; color: #a71d5d;">null</span>) <span style="line-height: 1.6; color: #969896;">// &#x5230;&#x5904;&#x662F;null&#x5224;&#x65AD;</span><br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>        select(selected); <br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">8.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">mouseMove</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">9.</span>    <span style="line-height: 1.6; color: #a71d5d;">if</span> (selected != <span style="line-height: 1.6; color: #a71d5d;">null</span>)<br><span style="line-height: 1.6; display: none; color: #969896;">10.</span>        move(selected); <br><span style="line-height: 1.6; display: none; color: #969896;">11.</span>    <span style="line-height: 1.6; color: #a71d5d;">else</span><br><span style="line-height: 1.6; display: none; color: #969896;">12.</span>        moveSelectionRectangle(); <br><span style="line-height: 1.6; display: none; color: #969896;">13.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">14.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">mouseUp</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">15.</span>    <span style="line-height: 1.6; color: #a71d5d;">if</span> (selected == <span style="line-height: 1.6; color: #a71d5d;">null</span>)<br><span style="line-height: 1.6; display: none; color: #969896;">16.</span>        selectAll();<br><span style="line-height: 1.6; display: none; color: #969896;">17.</span>} <br><span style="line-height: 1.6; display: none; color: #969896;">18.</span><br><span style="line-height: 1.6; display: none; color: #969896;">19.</span><span style="line-height: 1.6; color: #969896;">// With Pluggable Object</span><br><span style="line-height: 1.6; display: none; color: #969896;">20.</span>SelectionMode mode;<br><span style="line-height: 1.6; display: none; color: #969896;">21.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">mouseDown</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">22.</span>    selected= findFigure();<br><span style="line-height: 1.6; display: none; color: #969896;">23.</span>    <span style="line-height: 1.6; color: #969896;">// &#x5168;&#x90E8;&#x5F52;&#x7ED3;&#x5230;mode&#x5B50;&#x7C7B;&#x91CC;&#x9762;&#x53BB;&#x5904;&#x7406;</span><br><span style="line-height: 1.6; display: none; color: #969896;">24.</span>    <span style="line-height: 1.6; color: #a71d5d;">if</span> (selected != <span style="line-height: 1.6; color: #a71d5d;">null</span>)<br><span style="line-height: 1.6; display: none; color: #969896;">25.</span>        mode= SingleSelection(selected);<br><span style="line-height: 1.6; display: none; color: #969896;">26.</span>    <span style="line-height: 1.6; color: #a71d5d;">else</span><br><span style="line-height: 1.6; display: none; color: #969896;">27.</span>        mode= MultipleSelection();<br><span style="line-height: 1.6; display: none; color: #969896;">28.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">29.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">mouseMove</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">30.</span>    mode.mouseMove();<br><span style="line-height: 1.6; display: none; color: #969896;">31.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">32.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">mouseUp</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">33.</span>    mode.mouseUp();<br><span style="line-height: 1.6; display: none; color: #969896;">34.</span>}<br></code></pre></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="pluggable-selector"><a name="pluggable-selector" style="background: transparent; color: #1980e6; text-decoration: none;">Pluggable Selector</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E00;&#x8282;&#x7684;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x548C;&#x4E0A;&#x4E00;&#x8282;&#x7684;&#x6781;&#x4E3A;&#x7C7B;&#x4F3C;&#x3002;&#x8FD9;&#x6B21;&#x8981;&#x5904;&#x7406;&#x6389;&#x7684;&#x662F;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">switch...case...</code>&#x800C;&#x53C8;&#x4E0D;&#x7528;&#x5B50;&#x7C7B;&#x7EE7;&#x627F;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x52A8;&#x6001;&#x8C03;&#x7528;&#x3002;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x53EB;&#x53CD;&#x5C04;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">&#x53CD;&#x5C04;&#xFF1A;&#x901A;&#x8FC7;&#x81EA;&#x8EAB;&#x7684;&#x5C5E;&#x6027;&#xFF08;&#x5982;&#x7C7B;&#x540D;&#xFF0C;&#x65B9;&#x6CD5;&#x540D;&#xFF09;&#x6765;&#x505A;&#x76F8;&#x5173;&#x903B;&#x8F91;</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x540C;&#x6837;&#x770B;&#x4F5C;&#x8005;&#x7684;&#x4F8B;&#x5B50;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">print</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>    Method runMethod= getClass().getMethod(printMessage, <span style="line-height: 1.6; color: #a71d5d;">null</span>);<br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    runMethod.invoke(<span style="line-height: 1.6; color: #a71d5d;">this</span>, <span style="line-height: 1.6; color: #a71d5d;">new</span> Class[<span style="line-height: 1.6; color: #ae81ff;">0</span>]);<br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>}<br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x770B;&#x5230;&#x4E86;&#x6CA1;getClass&#xFF0C;getMethod&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x53CD;&#x5C04;&#x3002;&#x6709;&#x4E86;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x65E2;&#x4E0D;&#x9700;&#x8981;switch&#x6765;&#x8C03;&#x7528;&#x4E0D;&#x540C;&#x7684;printxxx&#x51FD;&#x6570;(printHtml, printXml&#x2026;)&#xFF0C;&#x4E5F;&#x4E0D;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x5B50;&#x7C7B;&#x6765;&#x8C03;&#x7528;&#x4E0D;&#x540C;&#x7684;print&#x51FD;&#x6570;&#x3002; <br>&#x4F5C;&#x8005;&#x5728;&#x672C;&#x8282;&#x6700;&#x540E;&#x7ED9;&#x51FA;&#x4E86;&#x4E00;&#x6BB5;&#x5FE0;&#x544A;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">Pluggable Selector can definitely be overused. The biggest problem with it is tracing code to see whether a method is invoked. Use Pluggable Selector only when you are cleaning up a fairly straightforward situation in which each of a bunch of <strong style="font-weight: bold; line-height: 1.6;">subclasses has only one method.</strong></p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="factory-method"><a name="factory-method" style="background: transparent; color: #1980e6; text-decoration: none;">Factory Method</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F5C;&#x8005;&#x8BF4;&#x5DE5;&#x5382;&#x65B9;&#x6CD5;&#x63D0;&#x4F9B;&#x4E86;&#x7075;&#x6D3B;&#x6027;&#x3002;&#x6211;&#x662F;&#x6CA1;&#x770B;&#x51FA;&#x6765;&#x3002;&#x5BF9;&#x6BD4;&#x4E0B;&#x9762;&#x4E24;&#x6BB5;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x91CC;&#x589E;&#x52A0;&#x4E86;&#x7075;&#x6D3B;&#x6027;&#xFF1F;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">testMultiplication</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>    Dollar five= Dollar five= <span style="line-height: 1.6; color: #a71d5d;">new</span> Dollar(<span style="line-height: 1.6; color: #ae81ff;">5</span>);<br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    assertEquals(<span style="line-height: 1.6; color: #a71d5d;">new</span> Dollar(<span style="line-height: 1.6; color: #ae81ff;">10</span>), five.times(<span style="line-height: 1.6; color: #ae81ff;">2</span>)); <br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>    assertEquals(<span style="line-height: 1.6; color: #a71d5d;">new</span> Dollar(<span style="line-height: 1.6; color: #ae81ff;">15</span>), five.times(<span style="line-height: 1.6; color: #ae81ff;">3</span>));<br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">6.</span><br><span style="line-height: 1.6; display: none; color: #969896;">7.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">public</span> <span style="line-height: 1.6; color: #66d9ef;">void</span> <span style="line-height: 1.6; color: #795da3;">testMultiplication</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">8.</span>    Dollar five = Money.dollar(<span style="line-height: 1.6; color: #ae81ff;">5</span>); <span style="line-height: 1.6; color: #969896;">// &#x5DE5;&#x5382;&#x65B9;&#x6CD5;</span><br><span style="line-height: 1.6; display: none; color: #969896;">9.</span>    assertEquals(<span style="line-height: 1.6; color: #a71d5d;">new</span> Dollar(<span style="line-height: 1.6; color: #ae81ff;">10</span>), five.times(<span style="line-height: 1.6; color: #ae81ff;">2</span>)); <br><span style="line-height: 1.6; display: none; color: #969896;">10.</span>    assertEquals(<span style="line-height: 1.6; color: #a71d5d;">new</span> Dollar(<span style="line-height: 1.6; color: #ae81ff;">15</span>), five.times(<span style="line-height: 1.6; color: #ae81ff;">3</span>)); <br><span style="line-height: 1.6; display: none; color: #969896;">11.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">12.</span><span style="line-height: 1.6; color: #969896;">// Money</span><br><span style="line-height: 1.6; display: none; color: #969896;">13.</span><span style="line-height: 1.6; color: #f92672;"><span style="line-height: 1.6; color: #66d9ef;">static</span> Dollar <span style="line-height: 1.6; color: #795da3;">dollar</span><span style="line-height: 1.6; color: #f8f8f2;">( Dollar dollar(<span style="line-height: 1.6; color: #66d9ef;">int</span> amount)</span> </span>{ <br><span style="line-height: 1.6; display: none; color: #969896;">14.</span>    <span style="line-height: 1.6; color: #a71d5d;">return</span> <span style="line-height: 1.6; color: #a71d5d;">new</span> Dollar(amount);<br><span style="line-height: 1.6; display: none; color: #969896;">15.</span>}<br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F5C;&#x8005;&#x6700;&#x540E;&#x7ED9;&#x51FA;&#x4E86;&#x4E00;&#x70B9;&#x5FE0;&#x544A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">You have to remember that the method is really creating an object, even though it doesn&#x2019;t look like a constructor. Use Factory Method only when you need the flexibility it creates. </p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="imposter"><a name="imposter" style="background: transparent; color: #1980e6; text-decoration: none;">Imposter</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E2D;&#x6587;&#x8BD1;&#x540D;&#x4E3A;&#x5192;&#x540D;&#x9876;&#x66FF;&#x3002;&#x6839;&#x636E;&#x6587;&#x4E2D;&#x7684;&#x9610;&#x8FF0;&#xFF0C;&#x6211;&#x7406;&#x89E3;&#x8FD9;&#x91CC;&#x8BB2;&#x7684;&#x4E0D;&#x662F;&#x4E00;&#x79CD;<strong style="font-weight: bold; line-height: 1.6;">&#x8BBE;&#x8BA1;</strong>&#x6A21;&#x5F0F;&#xFF0C;&#x800C;&#x53EA;&#x662F;&#x4E00;&#x79CD;&#x6A21;&#x5F0F;&#xFF0C;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#x3002;&#x6307;&#x7684;&#x662F;&#x5982;&#x679C;&#x67D0;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;&#xFF0C;&#x53EA;&#x5C06;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#xFF08;&#x7C7B;&#x3001;&#x65B9;&#x6CD5;&#x6216;&#x8005;&#x53D8;&#x91CF;&#x7B49;&#x7B49;&#xFF09;&#x66FF;&#x6362;&#x6210;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#xFF0C;&#x5C31;&#x80FD;&#x5F97;&#x5230;&#x4E00;&#x6BB5;&#x65B0;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x79F0;&#x4E3A;&#x5192;&#x540D;&#x9876;&#x66FF;&#x3002;&#x53D1;&#x73B0;&#x53EF;&#x4EE5;Imposter&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x53D1;&#x73B0;&#x91CD;&#x590D;&#x3002;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #969896;">// &#x4E0B;&#x9762;&#x8FD9;&#x4E24;&#x6BB5;&#x4EE3;&#x7801;&#x5C31;&#x53EA;&#x662F;&#x5C06;RectangleFigure&#x6362;&#x6210;OvalFigure&#xFF0C;&#x6B64;&#x662F;&#x4E3A;Imposter&#x5192;&#x540D;&#x9876;&#x66FF;&#x3002;</span><br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>testRectangle() {<br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    Drawing d= <span style="line-height: 1.6; color: #a71d5d;">new</span> Drawing();<br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>    d.addFigure(<span style="line-height: 1.6; color: #a71d5d;">new</span> RectangleFigure(<span style="line-height: 1.6; color: #ae81ff;">0</span>, <span style="line-height: 1.6; color: #ae81ff;">10</span>, <span style="line-height: 1.6; color: #ae81ff;">50</span>, <span style="line-height: 1.6; color: #ae81ff;">100</span>)); RectangleFigure(<span style="line-height: 1.6; color: #ae81ff;">0</span>, <span style="line-height: 1.6; color: #ae81ff;">10</span>, <span style="line-height: 1.6; color: #ae81ff;">50</span>, <span style="line-height: 1.6; color: #ae81ff;">100</span>));<br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>    RecordingMedium brush= <span style="line-height: 1.6; color: #a71d5d;">new</span> RecordingMedium(); <br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    d.display(brush); <br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>    assertEquals(<span style="line-height: 1.6; color: #df5000;">&quot;rectangle 0 10 50 100\n&quot;</span>, brush.log());<br><span style="line-height: 1.6; display: none; color: #969896;">8.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">9.</span><br><span style="line-height: 1.6; display: none; color: #969896;">10.</span>testOval() {<br><span style="line-height: 1.6; display: none; color: #969896;">11.</span>    Drawing d= <span style="line-height: 1.6; color: #a71d5d;">new</span> Drawing();<br><span style="line-height: 1.6; display: none; color: #969896;">12.</span>    d.addFigure(<span style="line-height: 1.6; color: #a71d5d;">new</span> OvalFigure(<span style="line-height: 1.6; color: #ae81ff;">0</span>, <span style="line-height: 1.6; color: #ae81ff;">10</span>, <span style="line-height: 1.6; color: #ae81ff;">50</span>, <span style="line-height: 1.6; color: #ae81ff;">100</span>)); <br><span style="line-height: 1.6; display: none; color: #969896;">13.</span>    RecordingMedium brush= <span style="line-height: 1.6; color: #a71d5d;">new</span> RecordingMedium(); <br><span style="line-height: 1.6; display: none; color: #969896;">14.</span>    d.display(brush);<br><span style="line-height: 1.6; display: none; color: #969896;">15.</span>    assertEquals(<span style="line-height: 1.6; color: #df5000;">&quot;oval 0 10 50 100\n&quot;</span>, brush.log()); <br><span style="line-height: 1.6; display: none; color: #969896;">16.</span>}<br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F5C;&#x8005;&#x8FD8;&#x63D0;&#x5230;&#x53E6;&#x5916;&#x4E24;&#x4E2A;&#x5728;&#x91CD;&#x6784;&#x4E2D;&#x7ECF;&#x5E38;&#x7528;&#x5230;&#x7684;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#xFF0C;&#x672C;&#x8D28;&#x5176;&#x5B9E;&#x5C31;&#x662F;Imposter &#x2014;&#x2014; Null Object &amp; Composite&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="composite"><a name="composite" style="background: transparent; color: #1980e6; text-decoration: none;">Composite</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x6839;&#x636E;&#x4E0A;&#x4E00;&#x7AE0;&#x4F5C;&#x8005;&#x7684;&#x89C2;&#x70B9;&#xFF0C;&#x7EC4;&#x5408;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x4E00;&#x79CD;&#x5192;&#x540D;&#x9876;&#x66FF;&#x3002;&#x4F5C;&#x8005;&#x5728;&#x672C;&#x8282;&#x5F00;&#x5934;&#x8BF4;&#x4E86;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you implement <strong style="font-weight: bold; line-height: 1.6;">an object</strong> whose behavior is the composition of the behavior of a list of other objects? Make it an <strong style="font-weight: bold; line-height: 1.6;">Imposter</strong> for <strong style="font-weight: bold; line-height: 1.6;">the component objects</strong>.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8BA9;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x79F0;&#x4E3A;&#x7EC4;&#x6210;&#x4ED6;&#x7684;&#x5BF9;&#x8C61;&#x7684;&#x5192;&#x540D;&#x9876;&#x66FF;&#x8005;&#x3002;&#x8BF4;&#x8D77;&#x6765;&#x5F88;&#x62D7;&#x53E3;&#x3002;&#x770B;&#x4F8B;&#x5B50;&#xFF1A;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span><span style="line-height: 1.6; color: #969896;">// Transaction</span><br><span style="line-height: 1.6; display: none; color: #969896;">2.</span>Transaction(Money value) {<br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    <span style="line-height: 1.6; color: #a71d5d;">this</span>.value= value;<br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>}<br><span style="line-height: 1.6; display: none; color: #969896;">5.</span><span style="line-height: 1.6; color: #969896;">// Account</span><br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>Transaction transactions[];<br><span style="line-height: 1.6; display: none; color: #969896;">7.</span><span style="line-height: 1.6; color: #f92672;">Money <span style="line-height: 1.6; color: #795da3;">balance</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">8.</span>    Money sum= Money.zero();<br><span style="line-height: 1.6; display: none; color: #969896;">9.</span>    <span style="line-height: 1.6; color: #a71d5d;">for</span> (<span style="line-height: 1.6; color: #a71d5d;">int</span> i= <span style="line-height: 1.6; color: #ae81ff;">0</span>; i &lt; transactions.length; i++) <br><span style="line-height: 1.6; display: none; color: #969896;">10.</span>        sum= sum.plus(transactions[i].value);<br><span style="line-height: 1.6; display: none; color: #969896;">11.</span>    <span style="line-height: 1.6; color: #a71d5d;">return</span> sum;<br><span style="line-height: 1.6; display: none; color: #969896;">12.</span>}<br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E2A;&#x5199;&#x6CD5;&#x7684;&#x7F3A;&#x70B9;&#x662F;&#xFF0C;&#x5F53;&#x8981;&#x7B97;OverallAccount&#x65F6;&#xFF0C;&#x6CA1;&#x8F99;&#x4E86;&#xFF0C;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x65B0;&#x7C7B;&#x6765;&#x5904;&#x7406;&#x3002;&#x4E00;&#x4E2A;OverallAccount&#x662F;&#x4E00;&#x7EC4;Account&#x3002;&#x4F46;OverallAccount&#x5176;&#x5B9E;&#x8981;&#x505A;&#x7684;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x7D2F;&#x52A0;&#xFF0C;&#x548C;Account&#x505A;&#x7684;&#x5E76;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#x3002;&#x8FD9;&#x5C31;&#x662F;&#x91CD;&#x590D;&#x3002; <br>&#x89E3;&#x51B3;&#x7684;&#x529E;&#x6CD5;&#x5C31;&#x662F;&#x6240;&#x8C13;&#x7684;Composite&#x3002;&#x628A;&#x8981;&#x7D2F;&#x52A0;&#x7684;&#x4E1C;&#x897F;&#x62BD;&#x8C61;&#x51FA;&#x6765;&#x79F0;&#x4E3A;Holdings&#xFF0C;Account&#x7D2F;&#x52A0;&#x7684;&#x662F;Holdings&#xFF0C;OverallAccount&#x7D2F;&#x52A0;&#x7684;&#x4E5F;&#x662F;Holdings&#x3002;</p></div><div style="line-height: 1.6;"><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #333333; display: block; background: white; overflow-x: auto; padding: 1.3em 2em;"><span style="line-height: 1.6; display: none; color: #969896;">1.</span>Holding holdings[];<br><span style="line-height: 1.6; display: none; color: #969896;">2.</span><span style="line-height: 1.6; color: #f92672;">Money <span style="line-height: 1.6; color: #795da3;">balance</span><span style="line-height: 1.6; color: #f8f8f2;">()</span> </span>{<br><span style="line-height: 1.6; display: none; color: #969896;">3.</span>    Money sum= Money.zero();<br><span style="line-height: 1.6; display: none; color: #969896;">4.</span>    <span style="line-height: 1.6; color: #a71d5d;">for</span> ( (<span style="line-height: 1.6; color: #a71d5d;">int</span> i= <span style="line-height: 1.6; color: #ae81ff;">0</span>; i &lt; holdings.length; i++)<br><span style="line-height: 1.6; display: none; color: #969896;">5.</span>    sum= sum.plus(holdings[i].balance());<br><span style="line-height: 1.6; display: none; color: #969896;">6.</span>    <span style="line-height: 1.6; color: #a71d5d;">return</span> sum;<br><span style="line-height: 1.6; display: none; color: #969896;">7.</span>}<br></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5199;&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4ECD;&#x7136;&#x4E0D;&#x662F;&#x7279;&#x522B;&#x660E;&#x767D;&#x4F55;&#x4E3A;Composite&#xFF08;&#x62FC;&#x5408;&#xFF0C;&#x590D;&#x5408;&#x7684;&#x610F;&#x601D;&#xFF09;&#x3002;&#x4F46;&#x6211;&#x4EEC;&#x662F;&#x7AD9;&#x5728;&#x5DE8;&#x4EBA;&#x7684;&#x80A9;&#x8180;&#x4E0A;&#xFF0C;&#x5BF9;&#x6BD4;&#x9605;&#x8BFB;&#x4E86;&#x4E2D;&#x6587;&#x8BD1;&#x672C;&#x540E;&#x6709;&#x4E86;&#x4E00;&#x70B9;&#x70B9;&#x611F;&#x89C9;&#x3002;&#x8FD9;&#x4E2A;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x7684;&#x4E2D;&#x6587;&#x8BD1;&#x540D;&#x4E3A;-<strong style="font-weight: bold; line-height: 1.6;">&#x9012;&#x5F52;&#x7EC4;&#x5408;</strong>&#x3002;&#x6240;&#x8C13;&#x9012;&#x5F52;&#xFF0C;&#x5E94;&#x5F53;&#x6307;&#x7684;&#x662F;&#xFF0C;&#x901A;&#x8FC7;&#x6982;&#x5FF5;&#x4E0A;&#x7684;&#x62BD;&#x8C61;&#xFF0C;&#x5C06;&#x4E00;&#x4E2A;&#x5927;&#x7684;&#x6DF7;&#x5408;&#x7C7B;&#x5199;&#x6210;&#x4E00;&#x4E9B;&#x66F4;&#x62BD;&#x8C61;&#x7684;&#x6982;&#x5FF5;&#x7684;&#x7EC4;&#x5408;&#x3002;&#x4F8B;&#x5982;: </p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">OvreallAccount &lt;- Account &lt;- Transactions <br>OverallAccount &lt;- Holding &amp; Account &lt;-Holding</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x901A;&#x8FC7;&#x9012;&#x5F52;&#x5730;&#x5C06;OverallAccount&#x5192;&#x540D;&#x9876;&#x66FF;&#x6210;Holding&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;OverallAccount&#x6210;&#x4E3A;&#x4E00;&#x4E2A;Account&#x6765;&#x8FBE;&#x5230;&#x6D88;&#x9664;&#x91CD;&#x590D;&#x3002; <br>&#x4F5C;&#x8005;&#x5728;&#x672C;&#x8282;&#x6700;&#x540E;&#x7ED9;&#x51FA;&#x4E86;&#x4F55;&#x65F6;&#x4F7F;&#x7528;Composite&#x7684;&#x5EFA;&#x8BAE;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">As is obvious from this discussion, I&#x2019;m still not able to articulate how to guess when a collection of objects is just a collection of objects and when you really have a Composite. The good news is, since you&#x2019;re getting good at refactoring, <b style="font-weight: bold;"><font color="IndianRed" style="line-height: 1.6;">the moment the duplication appears</font></b>, you can introduce Composite and watch program complexity disappear.</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="collecting-parameter"><a name="collecting-parameter" style="background: transparent; color: #1980e6; text-decoration: none;">Collecting Parameter</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x770B;&#x4E0D;&#x61C2;&#xFF0C;&#x4E0D;&#x77E5;&#x6240;&#x4E91;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="singleton"><a name="singleton" style="background: transparent; color: #1980e6; text-decoration: none;">Singleton</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x5F88;&#x8457;&#x540D;&#x7684;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#xFF0C;&#x7ECF;&#x5E38;&#x4F1A;&#x7528;&#x5230;&#x3002;&#x4F5C;&#x8005;&#x6CA1;&#x6709;&#x8BE6;&#x52A0;&#x9610;&#x91CA;&#xFF0C;&#x53EA;&#x662F;&#x544A;&#x8BEB;&#x8BFB;&#x8005;&#x4E0D;&#x8981;&#x7528;&#x5168;&#x5C40;&#x53D8;&#x91CF;(global variable)&#x3002;&#x6211;&#x731C;&#x4F5C;&#x8005;&#x7684;&#x610F;&#x601D;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x7528;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x5C31;&#x7528;&#x5355;&#x4F8B;&#x6A21;&#x5F0F;&#x7684;&#x7C7B;&#x5BF9;&#x8C61;&#x5427;&#x3002;</p></div><div style="line-height: 1.6;"><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 2.15em; margin: 1.2em 0 .6em 0; text-align: start;" id="chapter-31-refactoring"><a name="chapter-31-refactoring" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 31. Refactoring</a></h2><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5728;TDD&#x4E2D;&#xFF0C;&#x91CD;&#x6784;&#x8981;&#x505A;&#x7684;&#x5C31;&#x662F;&#xFF0C;&#x4FDD;&#x8BC1;&#x6240;&#x6709;&#x6D4B;&#x8BD5;&#x901A;&#x8FC7;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x964D;&#x4F4E;&#x91CD;&#x590D;&#xFF08;code&#x4E4B;&#x95F4;&#xFF0C;code&#x4E0E;test&#x4E4B;&#x95F4;&#xFF09;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="reconcile-differences"><a name="reconcile-differences" style="background: transparent; color: #1980e6; text-decoration: none;">Reconcile Differences</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><ul style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">How do you unify two similar looking pieces of code? Gradually bring them closer. Unify them only when they are absolutely identical. &#x4E0D;&#x8981;&#x5F3A;&#x5236;&#x6574;&#x5408;&#xFF0C;&#x7B49;&#x4ED6;&#x4EEC;&#x5B8C;&#x5168;&#x76F8;&#x7B49;&#x4E86;&#x518D;&#x8BF4;</li><li style="line-height: 1.6;">Such a leap-of-faith refactoring is exactly what we&#x2019;re trying to avoid with our strategy of small steps and concrete feedback. Although you can&#x2019;t always avoid leapy refactorings, you can reduce their incidence. &#x4E0D;&#x8981;&#x505A;&#x8DE8;&#x8D8A;&#x5F0F;&#x7684;&#x91CD;&#x6784;&#x3002;</li><li style="line-height: 1.6;">Sometimes you need to approach reconciling differences backward&#x2014;that is, think about how the last step of the change could be trivial, then work backward. &#x53CD;&#x5411;&#x601D;&#x8003;&#xFF0C;&#x5C3D;&#x91CF;&#x8BA9;&#x6BCF;&#x4E00;&#x6B65;&#x90FD;&#x975E;&#x5E38;&#x5C0F;(trivial)&#xFF0C;&#x8FD9;&#x6837;&#x65B9;&#x4FBF;&#x56DE;&#x9000;&#x3002;</li></ul></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="isolate-change"><a name="isolate-change" style="background: transparent; color: #1980e6; text-decoration: none;">Isolate Change</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x9694;&#x79BB;&#x6539;&#x52A8;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x505A;&#x7684;&#x4E00;&#x4E9B;&#x62BD;&#x8C61;&#x5C01;&#x88C5;&#x3002;&#x628A;&#x53D8;&#x5316;&#x7684;&#x90E8;&#x5206;&#x7528;&#x63A5;&#x53E3;&#x5305;&#x88C5;&#x8D77;&#x6765;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x8FBE;&#x5230;&#x4E86;&#x9694;&#x79BB;&#x7684;&#x6548;&#x679C;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">Some possible ways to isolate change are Extract Method (the most common), Extract Object, and Method Object.</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="migrate-data"><a name="migrate-data" style="background: transparent; color: #1980e6; text-decoration: none;">Migrate Data</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E0D;&#x77E5;&#x6240;&#x4E91;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="extract-method"><a name="extract-method" style="background: transparent; color: #1980e6; text-decoration: none;">Extract Method</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">How do you make a long, complicated method easier to read? Turn a small part of it into a separate method and call the new method. &#x5C06;&#x4E00;&#x4E2A;&#x5927;&#x51FD;&#x6570;&#x6253;&#x788E;&#xFF0C;&#x4ECE;&#x4E2D;&#x63D0;&#x53D6;&#x4E00;&#x4E9B;&#x65B9;&#x6CD5;&#x51FA;&#x6765;&#x3002;</p></blockquote></div><div style="line-height: 1.6;"><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 1.25em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="how"><a name="how" style="background: transparent; color: #1980e6; text-decoration: none;">How</a></h4><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><ol style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">Find a region of the method that would make sense as its own method. Bodies of <br>loop, whole loops, and branches of conditionals are common candidates for extraction.</li><li style="line-height: 1.6;">Make sure that there are no assignments to temporary variables declared outside the <br>scope of the region to be extracted.</li><li style="line-height: 1.6;">Copy the code from the old method to the new method. Compile it.</li><li style="line-height: 1.6;">For each temporary variable or parameter of the original method used in the new <br>method, add a parameter to the new method.</li><li style="line-height: 1.6;">Call the new method from the original method.</li></ol></blockquote></div><div style="line-height: 1.6;"><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 1.25em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="why"><a name="why" style="background: transparent; color: #1980e6; text-decoration: none;">Why</a></h4><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">&#x589E;&#x5F3A;&#x53EF;&#x8BFB;&#x6027;</li><li style="line-height: 1.6;">&#x6D88;&#x9664;&#x91CD;&#x590D;&#xFF0C;&#x5F53;&#x4F60;&#x53D1;&#x73B0;&#x6709;&#x4E24;&#x4E2A;&#x5927;&#x51FD;&#x6570;&#xFF0C;&#x6709;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x76F8;&#x540C;&#x7684;&#xFF0C;&#x90A3;&#x5C31;&#x53EF;&#x4EE5;&#x63D0;&#x53D6;&#x51FA;&#x6765;&#x79F0;&#x4E3A;&#x65B0;&#x7684;&#x65B9;&#x6CD5;&#x3002;</li><li style="line-height: 1.6;">&#x901A;&#x8FC7;inline&#x628A;&#x4E00;&#x5806;&#x51FD;&#x6570;&#x653E;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x7136;&#x540E;&#x770B;&#x770B;&#x54EA;&#x91CC;&#x53EF;&#x4EE5;extract &#xFF08;&#x8FD9;&#x4E00;&#x70B9;&#x6211;&#x611F;&#x89C9;&#x5E94;&#x8BE5;&#x653E;&#x5728;How&#x91CC;&#x9762;&#xFF0C;&#x4F5C;&#x8005;&#x662F;&#x60F3;&#x627F;&#x4E0A;&#x542F;&#x4E0B;&#xFF0C;&#x5C06;inline&#x5427;&#xFF09;</li></ol></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="inline-method"><a name="inline-method" style="background: transparent; color: #1980e6; text-decoration: none;">Inline Method</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">inline&#x5F88;&#x7384;&#x4E4E;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x628A;&#x51FD;&#x6570;&#x7684;&#x4EE3;&#x7801;&#x590D;&#x5236;&#x5230;&#x8C03;&#x7528;&#x7684;&#x5730;&#x65B9;&#x3002;&#x597D;&#x5904;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x4F5C;&#x8005;&#x6709;&#x8BDD;&#x8BF4;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">You might like the second version better, or you might not. The point to note here is that you can use Inline Method to play around with the <strong style="font-weight: bold; line-height: 1.6;">flow of control</strong>.  <br>&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x8BA9;&#x4F60;&#x628A;&#x62BD;&#x8C61;&#x51FA;&#x6765;&#x7684;&#x4E1C;&#x897F;&#x653E;&#x5230;&#x4E00;&#x8D77;&#x91CD;&#x65B0;&#x62BD;&#x8C61;&#xFF0C;&#x770B;&#x770B;&#x4F1A;&#x4E0D;&#x4F1A;&#x6709;&#x66F4;&#x597D;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x8FD9;&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x91CD;&#x6784;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="extract-interface"><a name="extract-interface" style="background: transparent; color: #1980e6; text-decoration: none;">Extract Interface</a></h3></div><div style="line-height: 1.6;"><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 1.25em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="how"><a name="how-1" style="background: transparent; color: #1980e6; text-decoration: none;">How</a></h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5982;&#x4F55;&#x5C06;&#x4E00;&#x4E2A;&#x7C7B;&#x62BD;&#x8C61;&#x6210;&#x4E00;&#x4E2A;interface&#x3002;&#x6240;&#x8C13;&#x7684;interface&#x5C31;&#x662F;&#x53EA;&#x6709;&#x7EAF;&#x865A;&#x51FD;&#x6570;&#x7684;&#x7C7B;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><ol style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">Declare an interface. Sometimes the name of the existing class should be the name of the interface, in which case you should first rename the class.</li><li style="line-height: 1.6;">Have the existing class implement the interface.</li><li style="line-height: 1.6;">Add the necessary methods to the interface, expanding the visibility of the methods in the class if necessary.</li><li style="line-height: 1.6;">Change type declarations from the class to the interface where possible.</li></ol></blockquote></div><div style="line-height: 1.6;"><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 1.25em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="why"><a name="why-1" style="background: transparent; color: #1980e6; text-decoration: none;">Why</a></h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x91CC;&#x63D0;&#x5230;&#x4E86;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF1A;</p><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">&#x5F53;&#x4F60;&#x9700;&#x8981;&#x62BD;&#x8C61;&#x51FA;&#x7236;&#x7C7B;&#x65F6;</li><li style="line-height: 1.6;">&#x5F53;&#x4F60;&#x7528;&#x4E86;Mock Object&#xFF0C;&#x73B0;&#x5728;&#x8981;&#x4E3A;&#x8FD9;&#x4E2A;mock object&#x62BD;&#x8C61;&#x51FA;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684;&#x63A5;&#x53E3;&#x65F6;&#x3002;&#x4F5C;&#x8005;&#x8FD9;&#x91CC;&#x63D0;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x5C0F;&#x6280;&#x5DE7;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x547D;&#x540D;&#x662F;&#x4E00;&#x4E2A;&#x5934;&#x75BC;&#x7684;&#x95EE;&#x9898;&#x3002;&#x4E0D;&#x59A8;&#x5C31;&#x628A;&#x65B0;&#x7684;interface&#x79F0;&#x4E3A;IXXX&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x539F;&#x6765;&#x7684;&#x53EB;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">File</code>&#xFF0C;&#x65B0;&#x7684;&#x63A5;&#x53E3;&#x5C31;&#x79F0;&#x4E3A;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">IFile</code></li></ol></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="move-method"><a name="move-method" style="background: transparent; color: #1980e6; text-decoration: none;">Move Method</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x628A;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x79FB;&#x5230;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x7C7B;&#x91CC;&#x9762;&#x3002;&#x4F46;&#x4F5C;&#x8005;&#x63D0;&#x5230;&#x4E86;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E0D;&#x9002;&#x7528;&#x3002;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4FEE;&#x6539;&#x4E86;&#x539F;&#x5148;&#x90A3;&#x4E2A;&#x7C7B;&#x7684;&#x6570;&#x636E;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="method-object"><a name="method-object" style="background: transparent; color: #1980e6; text-decoration: none;">Method Object</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E2A;&#x8BDD;&#x9898;&#x597D;&#x50CF;&#x5F88;&#x65B0;&#x9C9C;&#xFF0C;&#x4E4B;&#x524D;&#x770B;&#x5230;&#x8FC7;&#x5F88;&#x591A;&#x6B21;&#xFF0C;&#x4F46;&#x5E76;&#x6CA1;&#x6709;&#x6DF1;&#x7A76;&#x3002;&#x5148;&#x770B;&#x770B;How&#xFF1A;</p></div><div style="line-height: 1.6;"><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 1.25em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="how"><a name="how-2" style="background: transparent; color: #1980e6; text-decoration: none;">How</a></h4><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><ol style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">Create an object with the same parameters as the method.</li><li style="line-height: 1.6;">Make the local variables also instance variables of the object.</li><li style="line-height: 1.6;">Create one method called run(), whose body is the same as the body of the original method.</li><li style="line-height: 1.6;">In the original method, create a new object and invoke run().</li></ol></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x6709;&#x4EC0;&#x4E48;&#x597D;&#x5904;&#xFF1F;</p></div><div style="line-height: 1.6;"><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 1.25em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="why"><a name="why-2" style="background: transparent; color: #1980e6; text-decoration: none;">Why</a></h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E24;&#x4E2A;&#x597D;&#x5904;</p><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">&#x5728;&#x6DFB;&#x52A0;&#x590D;&#x6742;&#x903B;&#x8F91;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5BF9;&#x4E00;&#x4E2A;&#x8FC7;&#x7A0B;&#x6709;&#x591A;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x90A3;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#x5BF9;&#x8C61;&#xFF0C;&#x518D;&#x6269;&#x5C55;&#x8D77;&#x6765;&#x5C31;&#x5F88;&#x7B80;&#x5355;</li><li style="line-height: 1.6;">&#x5728;&#x4E00;&#x4E2A;&#x590D;&#x6742;&#x51FD;&#x6570;&#x91CC;extract interface&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x901A;&#x5E38;&#x4E00;&#x6BB5;code&#x9700;&#x8981;5&#xFF0C;6&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x8BDD;&#xFF0C;&#x867D;&#x7136;&#x51FD;&#x6570;&#x62BD;&#x53D6;&#x51FA;&#x6765;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5199;&#x6CD5;&#x5E76;&#x6CA1;&#x6709;&#x7B80;&#x5316;&#x591A;&#x5C11;&#x3002;&#x8FD9;&#x65F6;&#x5019;&#x5982;&#x679C;&#x6709;&#x65B9;&#x6CD5;&#x5BF9;&#x8C61;&#xFF0C;&#x5219;&#x5728;&#x7C7B;&#x91CC;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x540D;&#x5B57;&#x7A7A;&#x95F4;&#xFF0C;&#x4F1A;&#x63D0;&#x4F9B;&#x989D;&#x5916;&#x7684;&#x4FBF;&#x5229;&#x3002;</li></ol></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="add-parameter"><a name="add-parameter" style="background: transparent; color: #1980e6; text-decoration: none;">Add Parameter</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5C31;&#x662F;&#x52A0;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x6CA1;&#x4EC0;&#x4E48;&#x7279;&#x522B;&#x7684;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="method-parameter-to-constructor-parameter"><a name="method-parameter-to-constructor-parameter" style="background: transparent; color: #1980e6; text-decoration: none;">Method Parameter to Constructor Parameter</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5C31;&#x662F;&#x628A;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x53D8;&#x6210;&#x7C7B;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x8FD9;&#x4E48;&#x505A;&#xFF1F;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">If you pass the same parameter to several different methods in the same object, then you can simplify the API by passing the parameter once (eliminating duplication). You can run this refactoring in reverse if you find that an instance variable is used in only one method.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7B80;&#x5355;&#x5B9E;&#x7528;&#x3002;</p></div><div style="line-height: 1.6;"><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 2.15em; margin: 1.2em 0 .6em 0; text-align: start;" id="chapter-32-mastering-tdd"><a name="chapter-32-mastering-tdd" style="background: transparent; color: #1980e6; text-decoration: none;">Chapter 32. Mastering TDD</a></h2><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x7ECF;&#x8FC7;31&#x7AE0;&#x7684;&#x5B66;&#x4E60;&#xFF0C;&#x4F5C;&#x8005;&#x8BA4;&#x4E3A;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5B8C;&#x5B8C;&#x5168;&#x5168;&#x6709;&#x80FD;&#x529B;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x5408;&#x683C;&#x7684;TDD&#x7A0B;&#x5E8F;&#x5458;&#x4E86;&#x3002;&#x5728;&#x8FD9;&#x4E00;&#x7AE0;&#x91CC;&#xFF0C;&#x4F5C;&#x8005;&#x53C8;&#x603B;&#x7ED3;&#x51FA;&#x5F88;&#x591A;TDD&#x521D;&#x5B66;&#x8005;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x7ED9;&#x4E88;&#x56DE;&#x7B54;&#x3002;&#x7B54;&#x6848;&#x90FD;&#x662F;&#x4E00;&#x4E9B;&#x5F88;&#x5B9E;&#x7528;&#x7684;&#x5FE0;&#x544A;&#xFF0C;&#x7279;&#x6458;&#x53D6;&#x5982;&#x4E0B;&#x3002;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="what-donx2019t-you-have-to-test"><a name="what-dont-you-have-to-test" style="background: transparent; color: #1980e6; text-decoration: none;">What don&#x2019;t you have to test?</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F5C;&#x8005;&#x5E76;&#x6CA1;&#x6709;&#x76F2;&#x76EE;&#x5F3A;&#x8C03;&#x6D4B;&#x8BD5;&#x91CD;&#x8981;&#xFF0C;&#x4E5F;&#x6CA1;&#x6709;&#x8BF4;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x90FD;&#x8981;&#x5199;&#x6D4B;&#x8BD5;&#x3002;&#x4F5C;&#x8005;&#x8BF4;&#xFF1A;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">Unless you have reason to distrust it, don&#x2019;t test code from others.  <br>&#x201C;Write tests until fear is transformed into boredom.&#x201D;</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x53EA;&#x5728;&#x4F60;&#x4E0D;&#x76F8;&#x4FE1;&#x4F60;&#x7684;code&#x65F6;&#xFF0C;&#x5BF9;&#x4ED6;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#x3002;&#x6D4B;&#x8BD5;&#x4E5F;&#x4E0D;&#x662F;&#x4E3A;&#x4E86;&#x6D4B;&#x8BD5;&#x800C;&#x6D4B;&#x8BD5;&#xFF0C;&#x6216;&#x8005;&#x4E3A;&#x4E86;&#x4EE3;&#x7801;&#x7684;&#x5065;&#x58EE;&#xFF0C;&#x6D4B;&#x8BD5;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x51CF;&#x5C11;&#x4F60;&#x7684;&#x7126;&#x8651;&#x3002;&#x8BA9;&#x4F60;&#x4E0D;&#x8981;&#x4ECE;&#x62C5;&#x5FC3;&#x53D8;&#x6210;&#x70E6;&#x8E81;&#xFF0C;&#x4EC5;&#x6B64;&#x800C;&#x5DF2;&#x3002; <br>&#x54CE;&#xFF01;&#x771F;&#x662F;&#x918D;&#x9190;&#x704C;&#x9876;&#xFF01;&#x76F8;&#x89C1;&#x6068;&#x665A;&#xFF01;</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="how-do-you-know-if-you-have-good-tests"><a name="how-do-you-know-if-you-have-good-tests" style="background: transparent; color: #1980e6; text-decoration: none;">How do you know if you have good tests?</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4EC0;&#x4E48;&#x6837;&#x7684;&#x6D4B;&#x8BD5;&#x4E0D;&#x597D;&#xFF1F;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><ol style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">Long setup code. &#x5982;&#x679C;&#x4E3A;&#x4E86;&#x505A;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6D4B;&#x8BD5;&#xFF0C;&#x53EF;&#x80FD;&#x53EA;&#x6709;&#x51E0;&#x884C;&#x65AD;&#x8A00;&#xFF0C;&#x800C;&#x4E3A;&#x6B64;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5DE8;&#x5927;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x90A3;&#x8BF4;&#x660E;&#x54EA;&#x91CC;&#x80AF;&#x5B9A;&#x51FA;&#x95EE;&#x9898;&#x4E86;&#x3002;</li><li style="line-height: 1.6;">Setup duplication. &#x5982;&#x679C;&#x4F60;&#x53D1;&#x73B0;&#x6709;&#x51E0;&#x4E2A;&#x6D4B;&#x8BD5;&#x62E5;&#x6709;&#x76F8;&#x540C;&#x6216;&#x76F8;&#x4F3C;&#x7684;setup&#x4EE3;&#x7801;&#xFF0C;&#x90A3;&#x8BF4;&#x660E;&#x4F60;&#x7684;&#x6D4B;&#x8BD5;&#x4E2D;&#x6709;&#x91CD;&#x590D;&#x7684;&#x5730;&#x65B9;&#x3002;</li><li style="line-height: 1.6;">Long running tests. TDD tests that run a long time won&#x2019;t be run often. Suites that take longer than ten minutes <br>inevitably get trimmed. &#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x5957;&#x4EF6;&#x4E0D;&#x8981;&#x8D85;&#x8FC7;&#x5341;&#x5206;&#x949F;&#x3002;&#x5426;&#x5219;&#xFF0C;&#x53CD;&#x590D;&#x8FD0;&#x884C;&#x7684;&#x673A;&#x4F1A;&#x5C31;&#x4F1A;&#x6025;&#x5267;&#x964D;&#x4F4E;&#x3002;</li><li style="line-height: 1.6;">Fragile tests. Tests that break unexpectedly suggest that one part of the application is surprisingly affecting another part. &#x5982;&#x679C;&#x6D4B;&#x8BD5;&#x88AB;&#x65E0;&#x60C5;&#x6253;&#x65AD;&#xFF0C;&#x8BF4;&#x660E;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x91CC;&#x6709;&#x8026;&#x5408;&#x3002;</li></ol></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="how-does-tdd-lead-to-frameworks"><a name="how-does-tdd-lead-to-frameworks" style="background: transparent; color: #1980e6; text-decoration: none;">How does TDD lead to frameworks?</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x53C8;&#x88AB;&#x918D;&#x9190;&#x704C;&#x9876;&#x4E86;&#xFF01;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">TDD appears to stand this advice on its head: <b style="font-weight: bold;"><font color="IndianRed" style="line-height: 1.6;">&#x201C;Code for tomorrow, design for today.&#x201D; </font></b>Here&#x2019;s what happens in practice. &#x4E0D;&#x8981;&#x4E3A;&#x672A;&#x6765;&#x8003;&#x8651;&#x90A3;&#x4E48;&#x591A;&#xFF0C;&#x7B80;&#x5355;&#x7684;&#x8BA9;&#x6D4B;&#x8BD5;&#x901A;&#x8FC7;&#xFF0C;&#x7136;&#x540E;&#x53CA;&#x65F6;&#x7684;&#x505A;&#x91CD;&#x6784;&#x6D88;&#x9664;&#x91CD;&#x590D;&#xFF0C;&#x53CD;&#x800C;&#x80FD;&#x8FBE;&#x5230;&#x66F4;&#x597D;&#x7684;&#x8BBE;&#x8BA1;&#x6846;&#x67B6;&#xFF08;frameworks&#xFF09;&#x3002;</p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="how-much-feedback-do-you-need"><a name="how-much-feedback-do-you-need" style="background: transparent; color: #1980e6; text-decoration: none;">How much feedback do you need?</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x91CC;&#x8BF4;&#x7684;&#x548C;&#x4E4B;&#x524D;&#x4E00;&#x76F4;&#x5F3A;&#x8C03;&#x7684;&#x601D;&#x60F3;&#x5F88;&#x4E00;&#x81F4;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">If our knowledge of the implementation gives us confidence even without a test, then we will not write that test. </p></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="when-should-you-delete-tests"><a name="when-should-you-delete-tests" style="background: transparent; color: #1980e6; text-decoration: none;">When should you delete tests?</a></h3><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><ol style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">The first criterion for your tests is <strong style="font-weight: bold; line-height: 1.6;">confidence</strong>. Never delete a test if it reduces your confidence in the behavior of the system.</li><li style="line-height: 1.6;">The second criterion is <strong style="font-weight: bold; line-height: 1.6;">communication</strong>. If you have two tests that exercise the same path through the code, but they speak to different scenarios for a reader, leave them alone.</li></ol></blockquote></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="can-you-drive-development-with-application-level-tests"><a name="can-you-drive-development-with-application-level-tests" style="background: transparent; color: #1980e6; text-decoration: none;">Can you drive development with application-level tests?</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E0D;&#x8981;&#x5C1D;&#x8BD5;&#x505A;&#x5E94;&#x7528;&#x7EA7;&#x522B;&#x7684;test</p></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="how-do-you-switch-to-tdd-midstream"><a name="how-do-you-switch-to-tdd-midstream" style="background: transparent; color: #1980e6; text-decoration: none;">How do you switch to TDD midstream?</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E5F;&#x662F;&#x6211;&#x60F3;&#x95EE;&#x7684;&#xFF0C;&#x4F5C;&#x8005;&#x7684;&#x56DE;&#x7B54;&#x662F;&#x8FD9;&#x672C;&#x4E66;&#x5C31;&#x662F;&#x4E3A;&#x4E86;&#x8FD9;&#x4E2A;&#x800C;&#x5199;&#x7684;&#x3002;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">There is a whole book (or books) to be written about switching to TDD when you have lots of code. What follows is necessarily only a teaser.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x600E;&#x4E48;&#x505A;&#xFF1F;</p><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">So first we have to decide to limit the scope of our changes. </li><li style="line-height: 1.6;">Second, we have to break the deadlock between tests and refactoring.  <br><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">&#x600E;&#x4E48;&#x83B7;&#x5F97;feedback <br>1) We can get feedback other ways than with tests, like working very carefully and with a partner.  <br>2) We can get feedback at a gross level, like system-level tests that we know aren&#x2019;t adequate but give us some confidence. With this feedback, we can make the areas we have to change more accepting of change.</li></ol></li></ol></div><div style="line-height: 1.6;"><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 1.7em; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;" id="how-does-tdd-relate-to-the-practices-of-extreme-programming"><a name="how-does-tdd-relate-to-the-practices-of-extreme-programming" style="background: transparent; color: #1980e6; text-decoration: none;">How does TDD relate to the practices of Extreme Programming?</a></h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x540D;&#x8BCD;&#x89E3;&#x91CA;&#xFF1A;<a href="http://baike.baidu.com/link?url=NgfFcw4hxjOQHRtEArm4buq177_Xw562MDhrOykDcd-0EOv1xB_Oz3eslAn9X65cFdUel2xI7tTiqB3Gqyz3Ja" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Extreme Programming - XP</a>&#x6781;&#x9650;&#x7F16;&#x7A0B;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">&#x6781;&#x9650;&#x7F16;&#x7A0B;&#x662F;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;&#x3001;&#x7075;&#x5DE7;&#x7684;&#x8F6F;&#x4EF6;&#x5F00;&#x53D1;&#x65B9;&#x6CD5;&#xFF1B;&#x540C;&#x65F6;&#x5B83;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x4E25;&#x8C28;&#x548C;&#x5468;&#x5BC6;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x5B83;&#x7684;&#x57FA;&#x7840;&#x548C;&#x4EF7;&#x503C;&#x89C2;&#x662F;&#x4EA4;&#x6D41;&#x3001;&#x6734;&#x7D20;&#x3001;&#x53CD;&#x9988;&#x548C;&#x52C7;&#x6C14;&#xFF1B;&#x5373;&#xFF0C;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x8F6F;&#x4EF6;&#x9879;&#x76EE;&#x90FD;&#x53EF;&#x4EE5;&#x4ECE;&#x56DB;&#x4E2A;&#x65B9;&#x9762;&#x5165;&#x624B;&#x8FDB;&#x884C;&#x6539;&#x5584;&#xFF1A;&#x52A0;&#x5F3A;&#x4EA4;&#x6D41;&#xFF1B;&#x4ECE;&#x7B80;&#x5355;&#x505A;&#x8D77;&#xFF1B;&#x5BFB;&#x6C42;&#x53CD;&#x9988;&#xFF1B;&#x52C7;&#x4E8E;&#x5B9E;&#x4E8B;&#x6C42;&#x662F;&#x3002;XP&#x662F;&#x4E00;&#x79CD;&#x8FD1;&#x87BA;&#x65CB;&#x5F0F;&#x7684;&#x5F00;&#x53D1;&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x5C06;&#x590D;&#x6742;&#x7684;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x5206;&#x89E3;&#x4E3A;&#x4E00;&#x4E2A;&#x4E2A;&#x76F8;&#x5BF9;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x5C0F;&#x5468;&#x671F;&#xFF1B;&#x901A;&#x8FC7;&#x79EF;&#x6781;&#x7684;&#x4EA4;&#x6D41;&#x3001;&#x53CD;&#x9988;&#x4EE5;&#x53CA;&#x5176;&#x5B83;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x548C;&#x5BA2;&#x6237;&#x53EF;&#x4EE5;&#x975E;&#x5E38;&#x6E05;&#x695A;&#x5F00;&#x53D1;&#x8FDB;&#x5EA6;&#x3001;&#x53D8;&#x5316;&#x3001;&#x5F85;&#x89E3;&#x51B3;&#x7684;&#x95EE;&#x9898;&#x548C;&#x6F5C;&#x5728;&#x7684;&#x56F0;&#x96BE;&#x7B49;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#x53CA;&#x65F6;&#x5730;&#x8C03;&#x6574;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x3002;</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">TDD&#x4E0E;XP&#x7684;&#x5171;&#x901A;&#x4E4B;&#x5904;&#xFF1A;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">Pairing</li><li style="line-height: 1.6;">Work fresh</li><li style="line-height: 1.6;">Continuous integration</li><li style="line-height: 1.6;">Simple design</li><li style="line-height: 1.6;">Refactoring</li><li style="line-height: 1.6;">Continuous delivery</li></ul></div><div style="line-height: 1.6;"></div><center style="display:none">%23Test-Driven%20Development%0A@%28%u5B66%u4E60%u7B14%u8BB0%29%5BProgramming%2C%20TDD%5D%0A%0A%5BTOC%5D%0A%0A%u6700%u8FD1%u5728%u8BFBKent%20Beck%u7684%u300ATest-Driven%20Development%20By%20Example%u300B%uFF0C%u8BA9%u6211%u5BF9%u8F6F%u4EF6%u5F00%u53D1%u6709%u4E86%u65B0%u7684%u8BA4%u8BC6%u3002%0A%3E%u5199test%u5E76%u4E0D%u4E3A%u4E86%u6D4B%u8BD5%u800C%u6D4B%u8BD5%uFF0C%u662F%u4E3A%u4E86%u589E%u5F3A%u5BF9%u7A0B%u5E8F%u7684%u4FE1%u5FC3%uFF0C%u51CF%u5C11%u7126%u8651%u3002%u90A3%u4E48%u5982%u4F55%u51CF%u5C11%u7126%u8651%u5462%uFF0C%u662F%u901A%u8FC7%u4E00%u6B21%u53EA%u5173%u5FC3%u4E00%u4EF6%u4E8B%u60C5%u3002%u5982%u4F55%u4E00%u6B21%u53EA%u5173%u5FC3%u4E00%u4EF6%u4E8B%u60C5%uFF0C%u8FD9%u5C31%u662FTDD%u3002%0A%0A%u672C%u4E66%u5206%u4E09%u4E2A%u90E8%u5206%0A1.%20The%20Money%20Example%0A2.%20The%20xUnit%20Example%0A3.%20Patterns%20for%20Test-Driven%20Development%0A%u524D%u4E24%u4E2A%u90E8%u5206%u8BB2%u4E86%u4E24%u4E2A%u4F8B%u5B50%uFF0C%u6765%u9610%u8FF0%u5982%u4F55%u8FDB%u884CTDD%u5F00%u53D1%uFF0C%u6700%u540E%u4E00%u4E2A%u90E8%u5206%u7B97%u662F%u603B%u7ED3%uFF0C%u5168%u4E66%u7684%u7CBE%u534E%u6240%u5728%u3002%u672C%u6587%u4E0D%u6253%u7B97%u8BB2%u8FD9%u4E24%u4E2A%u4F8B%u5B50%u4E86%uFF0C%u56E0%u4E3A%u4F8B%u5B50%u6700%u597D%u81EA%u5DF1%u624B%u5199%u4E00%u904D%uFF0C%u624D%u53EF%u4EE5%u52A0%u6DF1%u4E86%u89E3%u3002%u672C%u6587%u4E3B%u8981%u6458%u5F55%u4E00%u4E9BTDD%u7684%u6A21%u5F0F%u65B9%u6CD5%28pattern%29%u3002%0A%0A%u4E0B%u9762%u8FD9%u6BB5%u8BDD%u6765%u81EA%u7B2C%u4E00%u7AE0%uFF0C%u63D0%u7EB2%u6308%u9886%uFF1A%0A%3EMy%20goal%20is%20for%20you%20to%20see%20the%20rhythm%20of%20Test-Driven%20Development%20%28TDD%29%2C%20which%20can%20be%20summed%20up%20as%20follows.%0A%3E%201.%20Quickly%20add%20a%20test.%0A%3E%202.%20Run%20all%20tests%20and%20see%20the%20new%20one%20fail.%0A%3E%203.%20Make%20a%20little%20change.%0A%3E%204.%20Run%20all%20tests%20and%20see%20them%20all%20succeed.%0A%3E%205.%20Refactor%20to%20remove%20duplication.%0A%0A%3EThe%20surprises%20are%20likely%20to%20include.%0A%3E%20*%20How%20each%20test%20can%20cover%20a%20**small%20increment**%20of%20functionality.%0A%3E%20*%20How%20**small%20and%20ugly%20the%20changes**%20can%20be%20to%20make%20the%20new%20tests%20run.%0A%3E%20*%20How%20often%20the%20tests%20are%20run.%0A%3E%20*%20How%20many%20teensy-weensy%20steps%20make%20up%20the%20refactorings.%0A%0A%u8FD9%u5C31%u662FTDD%u7684%u7CBE%u9AD3%u3002%u6309%u4F5C%u8005%u7684%u8BF4%u6CD5%u5C31%u662F%60Green/Red/Green/Refactor%60%u8282%u594F%u3002%0A%u8FD9%u4E5F%u56DE%u7B54%u4E86%u6211%u4E00%u76F4%u4EE5%u6765%u7684%u56F0%u6270%uFF0C%u5230%u5E95%u5E94%u8BE5%u5982%u4F55%u8BBE%u8BA1%u4E00%u6BB5%u7A0B%u5E8F%uFF0C%u5230%u5E95%u8981%u8003%u8651%u591A%u5C11%u79CD%u60C5%u51B5%u3002%u6309%u7167TDD%u7684%u5EFA%u8BAE%u5C31%u662F%uFF0C%u9996%u5148%u5199%u6D4B%u8BD5%uFF0C%u7136%u540E%u4EE3%u7801%u600E%u4E48%u5FEB%u600E%u4E48%u6765%uFF0C%u4E0D%u7BA1%u6709%u591Augly%uFF0C%u7136%u540E%u5982%u679C%u53D1%u73B0%u91CD%u590D%uFF0C%u53CA%u65F6%u505A%u91CD%u6784%u3002%u4E0D%u8981%u8003%u8651%u4EC0%u4E48%u6269%u5C55%u6027%u4E4B%u7C7B%u7684%uFF0C%u8FD9%u4E2A%u8BBE%u8BA1%u65B9%u5F0F%u672C%u8EAB%u5C31%u80FD%u63D0%u4F9B%u3002%u56E0%u4E3A%u5B83%u63D0%u9AD8%u4E86%u8FD0%u884C%u6D4B%u8BD5%u548C%u91CD%u6784%u7684%u9891%u7387%uFF0C%u65E2%u63D0%u5347%u4E86%u7F16%u7801%u8005%u5BF9%u7A0B%u5E8F%u7684%u4FE1%u5FC3%uFF0C%u4E5F%u964D%u4F4E%u4E86%u4E0D%u5408%u7406%u8BBE%u8BA1%u7684%u53EF%u80FD%u6027%u3002%0A%0A%23%23Chapter%2025.%20Test-Driven%20Development%20Patterns%0A%u4E66%u4E2D%u5F15%u5165%u4E86%u5F88%u591A%u5F71%u50CF%u56FE%28Influence%20Diagram%29%uFF0C%u5F88%u5F62%u8C61%u7684%u8BF4%u660E%u4E86%uFF0C%u5F15%u5165TDD%u80FD%u7ED9%u6211%u4EEC%u65E5%u5E38%u7684%u5F00%u53D1%u5DE5%u4F5C%u5F15%u5165%u4EC0%u4E48%u597D%u5904%u3002%0A%21%5BAlt%20text%5D%28./1455616022147.png%29%0A%3EThis%20is%20a%20positive%20feedback%20loop.%20%0A%3E-%20The%20more%20stress%20you%20feel%2C%20the%20less%20testing%20you%20will%20do.%20%0A%3E-%20The%20less%20testing%20you%20do%2C%20the%20more%20errors%20you%20will%20make.%20%0A%3E-%20The%20more%20errors%20you%20make%2C%20the%20more%20stress%20you%20feel.%20%0A%3E-%20Rinse%20and%20repeat.%0A%0A%23%23%23Isolated%20Test%0A%u80FD%u5C06%u5927%u5757%u7684%u6D4B%u8BD5%u5206%u5272%u6210%u677E%u8026%u5408%u7684%u5C0F%u6D4B%u8BD5%u4E0D%u5BB9%u6613%uFF0C%u4F46%u662F%u597D%u5904%u5927%u5927%u7684%u3002%u4F5C%u8005%u8BF4%uFF1A%0A%3EI%20never%20knew%20exactly%20how%20to%20achieve%20high%20cohesion%20and%20loose%20coupling%20regularly%20until%20I%20started%20writing%20isolated%20tests.%0A%23%23%23Test%20List%0A%u6211%u4EEC%u8981%u600E%u4E48%u5F00%u59CBTDD%u5462%uFF1F%u4F5C%u8005%u7ED9%u51FA%u4E86%u5F88%u5177%u64CD%u4F5C%u6027%u7684%u5EFA%u8BAE%uFF1A%0A%3EBefore%20you%20begin%2C%20write%20a%20list%20of%20all%20the%20tests%20you%20know%20you%20will%20have%20to%20write.%0A%u8FD9%u4E2Alist%u4E0A%u5199%u70B9%u4EC0%u4E48%u5462%uFF1F%0A%3E%201.%20Put%20on%20the%20list%20examples%20of%20every%20operation%20that%20you%20know%20you%20need%20to%20implement.%20%u8981%u54EA%u4E9B%u64CD%u4F5C%u3002%0A%3E%202.%20for%20those%20operations%20that%20don%27t%20already%20exist%2C%20put%20the%20null%20version%20of%20that%20operation%20on%20the%20list.%u54EA%u4E9B%u64CD%u4F5C%u6CA1%u5B9E%u73B0%uFF0C%u5199%u4E0A%u5B58%u6839%u3002%0A%3E%203.%20List%20all%20of%20the%20refactorings%20that%20you%20think%20you%20will%20have%20to%20do%20in%20order%20to%20have%20clean%20code%20at%20the%20end%20of%20this%20session.%20%u5B8C%u6210%u4E4B%u540E%uFF0C%u5217%u51FA%u9700%u8981%u91CD%u6784%u7684%u5730%u65B9%u3002%u800C%u5982%u679C%u6709%u5927%u7684%u91CD%u6784%u7684%u9700%u8981%u65F6%uFF0C%u653E%u5230later%20list%u91CC%u9762%uFF0C%u628A%u624B%u91CC%u7684%u4E8B%u60C5%u5904%u7406%u5B8C%uFF0C%u518D%u53BB%u5904%u7406%u5927%u7684%u91CD%u6784%u3002%0A%0A%u770B%u4F5C%u8005%u65F6%u523B%u5728%u5F3A%u8C03TDD%u5C31%u662Ftiny%20steps%uFF1A%0A%3E%20The%20pure%20form%20of%20TDD%2C%20wherein%20you%20are%20never%20more%20than%20one%20change%20away%20from%20a%20green%20bar%2C%20is%20like%20that%20three-out-of-four%20rule.%0A%23%23%23Test%20First%0A%u4EC0%u4E48%u65F6%u5019%u5199%u6D4B%u8BD5%uFF1F%0A%u7B54%uFF1A%u5728%u5199code%u4E4B%u524D%uFF0C%u56E0%u4E3A%u4E00%u65E6%u4F60%u5F00%u59CB%u5199code%uFF0C%u4F60%u53EF%u80FD%u5C31%u8EAB%u9677%u6CE5%u6F6D%uFF0C%u65E0%u6687%u987E%u53CAtest%20case%u4E86%u3002%0A%0A%23%23Chapter%2026.%20Red%20Bar%20Patterns%0A%23%23%23One%20Step%20Test%0A%3EEach%20test%20should%20represent%20one%20step%20toward%20your%20overall%20goal.%0A%23%23%23Starter%20Test%0A%u5982%u4F55%u5F00%u59CB%u5199%u6D4B%u8BD5%uFF1F%u4E0D%u8981%u4E00%u5F00%u59CB%u5C31%u60F3%u5199%u4E00%u4E2A%u771F%u6B63%u7684%u6D4B%u8BD5%uFF0C%u56E0%u4E3A%u8FD9%u6837%u4F1A%u4E00%u6B21%u9762%u5BF9%u592A%u591A%u7684%u95EE%u9898%u3002%u4F5C%u8005%u5EFA%u8BAE%u5C1D%u8BD5%u4ECE%u4E00%u4E2A%u7B80%u5355%u7684%u6D4B%u8BD5%u8F93%u5165%u8F93%u51FA%u5F00%u59CB%u3002%u8FD9%u6837%u4EE5%u4FBF%u4E8E%u4F60%u4ECEGreenxun%u8FC5%u901F%u5F00%u59CB%u4F60%u7684Green/Red/Green/Refactor%u8282%u594F%u3002%u4F5C%u8005%u4E3E%u4E86%u4E00%u4E2A%u4EA7%u751F%u591A%u8FB9%u5F62%u7684%u4F8B%u5B50%uFF1A%0A%60%60%60%20java%0AReducer%20r%3D%20new%20Reducer%28new%20Polygon%28%29%29%3B%20%0AassertEquals%280%2C%20reducer.result%28%29.npoints%29%3B%0A%60%60%60%0A%u4E0D%u592A%u61C2%u8FD9%u4E2A%u95EE%u9898%uFF0C%u4E0D%u8FC7%u53EF%u4EE5%u4ECE%u4E2D%u770B%u51FA%u4F5C%u8005%u5BF9TDD%u7684%u89E3%u91CA%u3002%u95EE%u9898%u672C%u8EAB%u662F%u8981%u89E3%u4E00%u4E2A%u964D%u4F4E%u591A%u8FB9%u5F62%u8FB9%u6570%u7684%u95EE%u9898%u3002%u4F5C%u8005%u7684%u542F%u52A8%u6D4B%u8BD5%u5C31%u662F%u4E00%u4E2A%u201C0%u201D%u8FB9%u591A%u8FB9%u5F62%uFF0C%u90A3%u7ED3%u679C%u4E00%u5B9A%u662F%220%22%u8FB9%u591A%u8FB9%u5F62%u3002%u5BF9%u5B9E%u9645%u610F%u4E49%u5F88%u8352%u8BDE%uFF0C%u4F46%u5BF9%u6D4B%u8BD5%u6765%u8BF4%u662F%u4E00%u4E2A%u4E0D%u9519%u7684%u5F00%u59CB%u3002%u7B26%u5408%u6211%u4EEC%u7684%u9884%u671F%uFF0C%u7B80%u5355%u800C%u4E14%u53C8%60represent%20one%20step%20toward%20your%20overall%20goal%60%u3002%0A%23%23%23Explanation%20Test%0A%u8FD9%u4E00%u7AE0%u662F%u5728%u8BF4%u5982%u4F55%u4E0D%u7528%u5F3A%u8FEB%u7684%u624B%u6BB5%u8BA9%u975ETDD%u7684%u56E2%u961F%u6210%u5458%u80FD%u8F6C%u5411TDD%u3002%u5F53%u5F00%u53D1%u8005%u5411%u4F60%u89E3%u91CA%u4ED6%u7684%u7A0B%u5E8F%u65F6%uFF0C%u4F60%u90FD%u53EF%u4EE5%u5C06%u4E4B%u8F6C%u5316%u4E3Atest%20case%u3002%0A%u672C%u4E66%u8FD8%u6709%u4E00%u4E2A%u5F88%u6709%u7279%u8272%u7684%u5730%u65B9%u662F%uFF0C%u8D2F%u7A7F%u5168%u6587%uFF0C%u4F5C%u8005%u603B%u662F%u5728%u7ECF%u610F%u4E0D%u7ECF%u610F%u95F4%u6D41%u9732%u7740%u5404%u79CD%u5B9D%u8D35%u7684%u5DE5%u4F5C%u7ECF%u9A8C%uFF1A%u5982%u4F55%u957F%u671F%u4FDD%u6301%u66F4%u9AD8%u6548%u7684%u7F16%u7A0B%uFF1F%u5982%u679C%u4F60%u662F%u7ECF%u7406%uFF0C%u4F60%u5982%u4F55%u4E0E%u4F60%u7684%u56E2%u961F%u6210%u5458%u4E00%u8D77%u5DE5%u4F5C%uFF1F%u7B49%u7B49%u3002%u8FD9%u4E00%u7AE0%u5C31%u6709%u8FD9%u6837%u4E00%u53E5%u8BDD%uFF1A%0A%3EIf%20you%27re%20a%20manager%20or%20a%20leader%2C%20you%20can%27t%20force%20anyone%20to%20change%20the%20way%20they%20work.%0A%3EWhat%20can%20you%20do%3F%20A%20simple%20start%20is%20to%20start%20asking%20for%20explanations%20in%20terms%20of%20test%20cases%3A%20%22Let%20me%20see%20if%20I%20understand%20what%20you%27re%20saying.%0A%0A%23%23%23Learning%20Test%0A%u8FD9%u4E00%u7AE0%u8BB2%u4E86%u6D4B%u8BD5%u9A71%u52A8%u5F00%u53D1%u9488%u5BF9%u96C6%u6210%u7B2C%u4E09%u65B9%u5E93%u7684%u4F18%u52BF%u3002%0A%23%23%23Regression%20Test%0A%3E**%u56DE%u5F52%u6D4B%u8BD5**%u662F%u6307%u4FEE%u6539%u4E86%u65E7%u4EE3%u7801%u540E%uFF0C%u91CD%u65B0%u8FDB%u884C%u6D4B%u8BD5%u4EE5%u786E%u8BA4%u4FEE%u6539%u6CA1%u6709%u5F15%u5165%u65B0%u7684%u9519%u8BEF%u6216%u5BFC%u81F4%u5176%u4ED6%u4EE3%u7801%u4EA7%u751F%u9519%u8BEF%u3002%0A%3E%u81EA%u52A8%u56DE%u5F52%u6D4B%u8BD5%u5C06%u5927%u5E45%u964D%u4F4E%u7CFB%u7EDF%u6D4B%u8BD5%u3001%u7EF4%u62A4%u5347%u7EA7%u7B49%u9636%u6BB5%u7684%u6210%u672C%u3002%u56DE%u5F52%u6D4B%u8BD5%u4F5C%u4E3A%u8F6F%u4EF6%u751F%u547D%u5468%u671F%u7684%u4E00%u4E2A%u7EC4%u6210%u90E8%u5206%uFF0C%u5728%u6574%u4E2A%u8F6F%u4EF6%u6D4B%u8BD5%u8FC7%u7A0B%u4E2D%u5360%u6709%u5F88%u5927%u7684%u5DE5%u4F5C%u91CF%u6BD4%u91CD%uFF0C%u8F6F%u4EF6%u5F00%u53D1%u7684%u5404%u4E2A%u9636%u6BB5%u90FD%u4F1A%u8FDB%u884C%u591A%u6B21%u56DE%u5F52%u6D4B%u8BD5%u3002%u5728%u6E10%u8FDB%u548C%u5FEB%u901F%u8FED%u4EE3%u5F00%u53D1%u4E2D%uFF0C%u65B0%u7248%u672C%u7684%u8FDE%u7EED%u53D1%u5E03%u4F7F%u56DE%u5F52%u6D4B%u8BD5%u8FDB%u884C%u7684%u66F4%u52A0%u9891%u7E41%uFF0C%u800C%u5728%u6781%u7AEF%u7F16%u7A0B%u65B9%u6CD5%u4E2D%uFF0C%u66F4%u662F%u8981%u6C42%u6BCF%u5929%u90FD%u8FDB%u884C%u82E5%u5E72%u6B21%u56DE%u5F52%u6D4B%u8BD5%u3002%u56E0%u6B64%uFF0C%u901A%u8FC7%u9009%u62E9%u6B63%u786E%u7684%u56DE%u5F52%u6D4B%u8BD5%u7B56%u7565%u6765%u6539%u8FDB%u56DE%u5F52%u6D4B%u8BD5%u7684%u6548%u7387%u548C%u6709%u6548%u6027%u662F%u975E%u5E38%u6709%u610F%u4E49%u7684%u3002%0A%u2014%u2014%20**%u767E%u5EA6%u767E%u79D1**%0A%0A%u672C%u4E66%u8BB2%u7684%u56DE%u5F52%u6D4B%u8BD5%u6982%u5FF5%u53EF%u80FD%u7565%u6709%u4E0D%u540C%u3002%u6309%u7167%u6211%u7684%u7406%u89E3%uFF0C%u4F5C%u8005%u662F%u60F3%u8BF4%uFF0C%u5728%u8FDB%u884C%u5B8C%u6240%u6709%u7684%u7F16%u7801%u4EE5%u540E%uFF0C%u4F60%u5DF2%u7ECF%u5BF9%u4F60%u7684%u8981%u5B9E%u73B0%u7684%u6240%u6709%u4E1C%u897F%u5B8C%u6210%u4E86unknown%24%5Crightarrow%20%24known%u7684%u8FC7%u7A0B%u3002%u90A3%u4E48%u73B0%u5728%uFF0C%u4F60%u53EF%u4EE5%u56DE%u8FC7%u5934%u770B%u770B%uFF0C%u5982%u679C%u8FD9%u65F6%u5019%u91CD%u65B0%u5199%u4E00%u4EFD%u6D4B%u8BD5%u4F60%u5E94%u8BE5%u5199%u4EC0%u4E48%u3002%0A%0A%3E%u56DE%u5230%u4F60%u9488%u5BF9%u8FD9%u4E2A%u7CFB%u7EDF%u7684%u6700%u521D%u7684%u60F3%u6CD5%u6765%u5BF9%u6574%u4E2A%u7CFB%u7EDF%u505A%u4E00%u4E2A%u6D4B%u8BD5%u3002%u4EE5%u671F%u5BF9%u6574%u4E2A%u7CFB%u7EDF%u6709%u4E2A%u6574%u4F53%u7684%u8BC4%u4EF7%u3002%0A%23%23%23Break%0A%u52B3%u9038%u7ED3%u5408%u5BF9%u7A0B%u5E8F%u5458%u662F%u975E%u5E38%u975E%u5E38%u975E%u5E38%u91CD%u8981%u7684%uFF01%0A%3E%20**Shower%20Methodology**%3AIf%20you%20know%20what%20to%20type%2C%20then%20type.%20If%20you%20don%27t%20know%20what%20to%20type%2C%20then%20take%20a%20shower%2C%20and%20stay%20in%20the%20shower%20until%20you%20know%20what%20to%20type.%0A%3E**TDD%20Rule**%3A%20If%20you%20don%27t%20know%20what%20to%20type%2C%20then%20Fake%20It.%20If%20the%0Aright%20design%20still%20isn%27t%20clear%2C%20then%20Triangulate.%20%0A%0A%u770B%u770B%u4F5C%u8005%u63D0%u5021%u7684%u65F6%u95F4%u7BA1%u7406%0A%3E*%20At%20the%20scale%20of%20hours%2C%20keep%20a%20water%20bottle%20by%20your%20keyboard%20so%20that%20biology%20provides%20the%20motivation%20for%20regular%20breaks.%0A%3E*%20At%20the%20scale%20of%20a%20day%2C%20commitments%20after%20regular%20work%20hours%20can%20help%20you%20to%20stop%20when%20you%20need%20sleep%20before%20progress.%0A%3E*%20At%20the%20scale%20of%20a%20week%2C%20weekend%20commitments%20help%20get%20your%20conscious%2C%20energysucking%20thoughts%20off%20work.%20%28My%20wife%20swears%20I%20get%20my%20best%20ideas%20on%20Friday%20evening.%29%0A%3E*%20At%20the%20scale%20of%20a%20year%2C%20mandatory%20vacation%20policies%20help%20you%20refresh%20yourself%20completely.%20The%20French%20do%20this%20right%u2014two%20contiguous%20weeks%20of%20vacation%20aren%27t%20enough.%20You%20spend%20the%20first%20week%20decompressing%2C%20and%20the%20second%20week%20getting%20ready%20to%20go%20back%20to%20work.%20Therefore%2C%20three%20weeks%2C%20or%20better%20four%2C%20are%20necessary%20for%20you%20to%20be%20your%20most%20effective%20the%20rest%20of%20the%20year.%0A%23%23%23Do%20Over%0A%3EWhat%20do%20you%20do%20when%20you%20are%20feeling%20lost%3F%20Throw%20away%20the%20code%20and%20start%20over.%0A%u4F5C%u8005%u5728%u8FD9%u4E00%u7AE0%u544A%u8BC9%u4F60%uFF0C%u4E0D%u8981%u5728%u6CE5%u6F6D%u8D8A%u9677%u8D8A%u6DF1%uFF0C%u4E0D%u8981%u5BB3%u6015%u91CD%u65B0%u5F00%u59CB%u3002%u6362%u4E2A%u4F19%u4F34%uFF0C%u6362%u4E2A%u601D%u8DEF%uFF0C%u4F60%u53EF%u80FD%u6709%u66F4%u597D%u7684%u53D1%u73B0%u3002%0A%23%23Chapter%2027.%20Testing%20Patterns%0A%23%23%23Child%20Test%0A%u8FD9%u91CC%u8BF4%u7684%u662F%uFF0C%u5982%u679C%u4F60%u89C9%u5F97%u8FD9%u4E2A%u6D4B%u8BD5%u592A%u5927%uFF0C%u90A3%u5C31%u8981%u628A%u8FD9%u4E2A%u5927%u7684%u6D4B%u8BD5%u7834%u6210%u82E5%u5E72%u4E2A%u5C0F%u7684%u6D4B%u8BD5%uFF0C%u7136%u540E%u770B%u770B%u6709%u6CA1%u6709%u8FDB%u5C55%u3002%0A%23%23%23Mock%20Object%0A%3EHow%20do%20you%20test%20an%20object%20that%20relies%20on%20an%20expensive%20or%20complicated%20resource%3F%20Create%20a%20fake%20version%20of%20the%20resource%20that%20answers%20constants.%0A%3EIf%20you%20want%20to%20use%20Mock%20Objects%2C%20you%20can%27t%20easily%20store%20expensive%20resources%20in%20global%20variables.%u8981%u8BB0%u5F97%u6E05%u7406%u73B0%u573A%uFF0C%u5426%u5219%u4E07%u4E00%u5176%u4ED6%u7684%u4EE3%u7801%u628A%u4ED6%u5F53%u4F5C%u771F%u7684object%u5728%u4F7F%u7528%uFF0C%u5C31%u4F1A%u51FA%u5927%u95EE%u9898%u3002%u6240%u4EE5%u7F16%u7801%u6700%u57FA%u672C%u7684%u51C6%u5219%u662F%u5C11%u7528%u5168%u5C40%u53D8%u91CF%u3002%0A%3EMock%20Objects%20encourage%20you%20down%20the%20path%20of%20carefully%20considering%20the%20visibility%20of%20every%20object%2C%20reducing%20the%20coupling%20in%20your%20designs.%20%u8FD9%u91CC%u8BF4%u7684%u662F%uFF0C%u5982%u679C%u4F60%u7528Mock%20Object%uFF0C%u4F60%u5C31%u8981%u601D%u8003%u6211%u5230%u5E95%u8BE5%u4E0D%u8BE5%u628A%u8FD9%u4E2A%u5E9E%u7136%u5927%u7269%u66B4%u9732%u7ED9%u8FD9%u6BB5%u4EE3%u7801%u3002%u8FD9%u79CD%u601D%u8003%u6709%u52A9%u4E8E%u51CF%u5C0F%u8026%u5408%u6027%u3002%0A%23%23%23Self%20Shunt%0A%3EHow%20do%20you%20test%20that%20one%20object%20communicates%20correctly%20with%20another%3F%20Have%20the%20object%20under%20test%20communicate%20with%20the%20test%20case%20instead%20of%20with%20the%20object%20it%20expects.%0A%0A**Without%20Self%20Shunt**%0A%60%60%60python%0A%23%20ResultListenerTest%0Adef%20testNotification%28self%29%3A%20%0A%09result%3D%20TestResult%28%29%20%0A%09listener%3D%20ResultListener%28%29%20%0A%09result.addListener%28listener%29%20%0A%09WasRun%28%22testMethod%22%29.run%28result%29%0A%09assert%201%20%3D%3D%20listener.count%20%0A%0A%23%20ResultListener%0Aclass%20ResultListener%3A%0A%09def%20__init__%28self%29%3A%20%0A%09%09self.count%3D%200%20%0A%09def%20startTest%28self%29%3A%20%0A%09%09self.count%3D%20self.count%20+%201%20%0A%60%60%60%0A%0A**With%20Self%20Shunt**%0A%60%60%60python%0A%23%20ResultListenerTest%0Adef%20testNotification%28self%29%3A%20%0A%09self.count%3D%200%20%0A%09result%3D%20TestResult%28%29%0A%09result.addListener%28self%29%0A%09WasRun%28%22testMethod%22%29.run%28result%29%20%0A%09assert%201%20%3D%3D%20self.count%0Adef%20startTest%28self%29%3A%0A%09self.count%3D%20self.count%20+%201%0A%60%60%60%0A%0A%u8FD9%u91CC%u4E3E%u5F97%u4F8B%u5B50%u4E0D%u662F%u5F88%u660E%u767D%u3002%u4E2D%u6587%u8BD1%u672C%u91CC%uFF0C%u5C06self%20shunt%u7FFB%u8BD1%u6210%u81EA%u5206%u6D41%uFF0C%u611F%u89C9%u4E5F%u662F%u5B57%u9762%u7FFB%u8BD1%u3002%u6211%u7406%u89E3%u8FD9%u91CC%u60F3%u8BF4%u7684%u662F%uFF0C%u4E0D%u4E00%u5B9A%u8981%u5B9A%u4E49%u4E00%u4E2A%u7C7B%u6765%u505A%u5F53%u524D%u88AB%u6D4B%u8BD5%u7C7B%u6765%u505A%u7684%u4E8B%u60C5%uFF0C%u53EF%u4EE5%u5728test%20case%u91CC%u9762%u7528%u8BE5%u7C7B%u66B4%u9732%u7684%u63A5%u53E3%u6765%u505A%u4E8B%u60C5%u3002%0A%3ESelf%20Shunt%20may%20require%20that%20you%20use%20**Extract%20Interface**%20to%20get%20an%20interface%20to%20implement.%20You%20will%20have%20to%20decide%20whether%20extracting%20the%20interface%20is%20easier%2C%20or%20if%20testing%20the%20existing%20class%20as%20a%20**black%20box**%20is%20easier.%0A%0A%u8FD9%u91CC%u53C8%u770B%u6655%u4E86%uFF0Cself%20shunt%u8DDFextract%20interface%u6709%u5565%u5173%u7CFB%u3002%0A%3E%u5F53%u6211%u4EEC%u6CE8%u610F%u5230%u5728%u6211%u4EEC%u4EE3%u7801%u7ED3%u6784%u4E2D%u8D85%u8FC7%u4E00%u4E2A%u7C7B%u4F7F%u7528%u5230%u53E6%u4E00%u4E2A%u7279%u6B8A%u7C7B%u4E2D%u7684%u540C%u4E00%u4E2A%u65B9%u6CD5%u65F6%uFF0C%u6B64%u65F6%u5E94%u8BE5%u5C06%u8BE5%u7C7B%u4E2D%u7684%u65B9%u6CD5%u63D0%u53D6%u51FA%u6765%u653E%u5230%u4E00%u4E2A%u63A5%u53E3%uFF08interface%uFF09%u4E2D%uFF0C%u5E76%u5BF9%u5916%u63D0%u4F9B%u8FD9%u4E2A%u63A5%u53E3%u4EE5%u4FBF%u88AB%u7528%u6237%u7C7B%u8BBF%u95EE%u3001%u4F7F%u7528%uFF0C%u8FD9%u6837%u6709%u5229%u4E8E%u6253%u7834%u539F%u6765%u591A%u4E2A%u7C7B%u4E0E%u8FD9%u4E2A%u7279%u6B8A%u7C7B%u7684%u4F9D%u8D56%u5173%u7CFB%u3002%u8FD9%u4E2A%u91CD%u6784%u624B%u6CD5%u5F88%u5BB9%u6613%u5B9E%u73B0%uFF0C%u66F4%u91CD%u8981%u7684%u662F%u8FD9%u6837%u505A%u6709%u5229%u4E8E%u677E%u8026%u5408%u3002%20%u2014%u2014%u7F51%u7EDC%u4E0A%u7684%u89E3%u91CA%0A%0A%u6211%u89C9%u5F97%u8FD9%u91CC%u4F5C%u8005%u63D0%u5230%u7684extract%20interface%uFF0C%u5E76%u4E0D%u662F%u6211%u4EEC%u8BF4%u7684%u91CD%u6784%u91CC%u7684extract%20interface%u3002%u8FD9%u91CC%u8BF4%u8981%u6D4B%u8BD5A%u7C7B%u548CB%u7C7B%u901A%u4FE1%uFF0C%u6211%u4EEC%u4E0D%u76F4%u63A5%u7528B%u7C7B%uFF0C%u800C%u7528test%20case%u4E0EA%u7C7B%u901A%u4FE1%uFF0C%u4EE5%u6D4B%u8BD5%u901A%u4FE1%u7684A%u7C7B%u7AEF%u63A5%u53E3%u662F%u5426%u6B63%u786E%u3002extract%20interface%u8BF4%u7684%u662F%u4ECEB%u7C7B%u4E2Dextract%u63A5%u53E3%u51FA%u6765%u5230test%20case%u4E2D%u53BBimplement%u3002%u6216%u8005%u628AB%u7C7B%u76F4%u63A5%u5F53%u9ED1%u76D2%u5B50%u5728test%20case%u4E2D%u4F7F%u7528%u3002%0A%23%23%23Log%20String%0A%u8FD9%u4E2A%u5F88%u6709%u7528%u3002%u6709%u4E9B%u51FD%u6570%u6216%u8005%u8FC7%u7A0B%u662F%u6CA1%u6709%u8FD4%u56DE%u503C%u7684%uFF0C%u6211%u4EEC%u5C31%u53EF%u4EE5%u7528Log%20String%u7684%u65B9%u5F0F%u6765%u67E5%u770B%u8BE5%u8FC7%u7A0B%u6216%u51FD%u6570%u6709%u6CA1%u6709%u88AB%u8C03%u7528%u3002%u7C7B%u4F3C%u6211%u4EEC%u770Btrace%20log%u4E00%u6837%uFF0C%u901A%u8FC7%u770Btrace%20log%u80FD%u77E5%u9053%u673A%u5668%u6267%u884C%u7684%u4EE3%u7801%u662F%u5426%u6B63%u786E%u3002%0A%23%23%23Crash%20Test%20Dummy%0A%3EHow%20do%20you%20test%20error%20code%20that%20is%20unlikely%20to%20be%20invoked%3F%20Invoke%20it%20anyway%20with%20a%20special%20object%20that%20throws%20an%20exception%20instead%20of%20doing%20real%20work.%0A%23%23%23Broken%20Test%0A%u4F5C%u8005%u7ECF%u5E38%u80FD%u7ED9%u51FA%u4E00%u4E9B%u5F88%u5B9E%u7528%u7684%u5C0F%u7ECF%u9A8C%uFF0C%u8FD9%u91CC%u53C8%u6765%u4E86%uFF0C%u770B%u4E0B%u9762%u3002%0A%3EHow%20do%20you%20leave%20a%20programming%20session%20when%20you%27re%20programming%20alone%3F%20Leave%20the%20last%20test%20broken.%0A%0A%u5F53%u4F60%u8981%u8F6C%u53BB%u505A%u53E6%u5916%u4E00%u4EF6%u4E8B%u60C5%uFF0C%u800C%u624B%u5934%u4E0A%u7684%u4E8B%u60C5%u53C8%u6CA1%u7ED3%u675F%u65F6%u600E%u4E48%u529E%uFF1F%u8BA9%u6700%u540E%u4E00%u4E2A%u6D4B%u8BD5%u6545%u610F%u7684%u4E0D%u901A%u8FC7%u3002%u8FD9%u6837%u4E0B%u6B21%u5C31%u77E5%u9053%u4ECE%u54EA%u513F%u5F00%u59CB%uFF0C%u7136%u540E%u80FD%u8FC5%u901F%u4E0A%u624B%u3002%u918D%u9190%u704C%u9876%u554A%uFF01%u4EE5%u524D%u90FD%u662F%u8BA4%u4E3A%u505A%u53E6%u5916%u4E00%u4EF6%u4E8B%u60C5%u4E4B%u524D%u8981%u628A%u624B%u5934%u4E0A%u7684%u4E8B%u60C5%u5F04%u7684%u5C3D%u5584%u5C3D%u7F8E%uFF0C%u5176%u5B9E%u4E0D%u7136%u3002%u600E%u4E48%u505A%u5229%u4E8E%u540E%u671F%u7EE7%u7EED%u8FDB%u884C%uFF0C%u90A3%u5C31%u5E94%u8BE5%u600E%u4E48%u505A%u3002%0A%23%23%23Clean%20Check-in%0A%3EYou%20will%20occasionally%20find%20a%20test%20broken%20in%20the%20integration%20suite%20when%20you%20try%20to%20check%20in.%20What%20to%20do%3F%0A**The%20simplest%20rule**%20is%20to%20just%20throw%20away%20your%20work%20and%20start%20over.%20The%20broken%20test%20is%20pretty%20strong%20evidence%20that%20you%20didn%27t%20know%20enough%20to%20program%20what%20you%20just%20programmed.%0A%u4EC0%u4E48%u4EC0%u4E48%uFF1F%u7ADF%u7136%u8981%u6211%u4EEC%u6254%u6389%u6211%u4EEC%u505A%u7684%uFF0C%u7136%u540E%u91CD%u65B0%u5F00%u59CB%u3002%u5C31%u56E0%u4E3A%u6211%u4EEC%u7684%u6D4B%u8BD5%u548Cintegration%u6D4B%u8BD5%u7ED3%u679C%u4E0D%u4E00%u81F4%u3002%0A%u5927%u5E08%u7684%u8BDD%u603B%u662F%u6709%u9053%u7406%u7684%uFF0C%u4EE5%u540E%u8981%u597D%u597D%u8003%u8651%u8FD9%u4E00%u70B9%u3002%0A%23%23Chapter%2028.%20Green%20Bar%20Patterns%0A%23%23%23Fake%20It%20%28%27Til%20You%20Make%20It%29%0A%u505A%u5047%u4EE3%u7801%u8BA9%u6D4B%u8BD5%u901A%u8FC7%uFF0C%u7136%u540E%u518D%u4E00%u9879%u4E00%u9879%u5730%u5B8C%u6210%0A%23%23%23Triangulate%0A%u4F5C%u8005%u63D0%u5230%u7684%u6240%u8C13%u4E09%u89D2%u6CD5%u3002%u901A%u4FD7%u7684%u8BF4%uFF0C%u5C31%u662F%u53EA%u5728%u5FC5%u8981%u7684%u65F6%u5019%u505A%u62BD%u8C61%u6216%u901A%u7528%u5316%u5904%u7406%u3002%u901A%u5E38%u662F%u5728TDD%u7684%u91CD%u6784%u8FD9%u4E00%u6B65%u5B8C%u6210%u8FD9%u4E2A%u62BD%u8C61%u7684%u8FC7%u7A0B%u3002%u518D%u901A%u4FD7%u70B9%u8BF4%uFF0C%u5C31%u662F%u591A%u5F04%u51E0%u4E2Acase%uFF0C%u518D%u603B%u7ED3%u5171%u540C%u70B9%uFF0C%u4E4B%u540E%u505A%u62BD%u8C61%0A%u4ECE%u53E6%u4E00%u4E2A%u89D2%u5EA6%uFF0C%u4F5C%u8005%u53C8%u8BF4%u4E86%uFF1A%0A%3EI%20only%20use%20Triangulation%20when%20I%27m%20really%2C%20really%20unsure%20about%20the%20correct%20abstraction%20for%20the%20calculation.%20Otherwise%20I%20rely%20on%20either%20Obvious%20Implementation%20or%20Fake%20It.%0A%23%23%23One%20to%20Many%0A%3EHow%20do%20you%20implement%20an%20operation%20that%20works%20with%20collections%20of%20objects%3F%20Implement%20it%20without%20the%20collections%20first%2C%20then%20make%20it%20work%20with%20collections.%0A%0A%u4E2D%u5FC3%u601D%u60F3%u8FD8%u662F%u4E00%u4E2A%uFF0C%u4ECE%u663E%u800C%u6613%u89C1%u7684%u5730%u65B9%u5F00%u59CB%uFF0C%u6BCF%u6B21%u53EA%u505A%u4E00%u5C0F%u6B65%uFF0C%u7136%u540E%u4E00%u6B65%u4E00%u6B65%u5230%u8FBE%u6700%u7EC8%u7684%u76EE%u7684%u5730%u3002%u770B%u4E0B%u9762%u7684%u4F8B%u5B50%uFF1A%0A%60%60%60java%0A//%201.%20fake%20code%0Apublic%20void%20testSum%28%29%20%7B%20%0A%09assertEquals%285%2C%20sum%285%29%29%3B%20%0A%7D%20%0Aprivate%20int%20sum%28int%20value%29%20%7B%0A%09return%20value%3B%0A%7D%0A%0A//%202.%20add%20arrays%0Apublic%20void%20testSum%28%29%20%7B%0A%09assertEquals%285%2C%20sum%285%2C%20new%20int%5B%5D%20%7B5%7D%29%29%3B%0A%7D%0Aprivate%20int%20sum%28int%20value%2C%20int%5B%5D%20values%29%20%7B%0A%09return%20value%3B%0A%7D%0A%0A//%203.%20add%20real%20sum%20functionality%0Apublic%20void%20testSum%28%29%20%7B%0A%09assertEquals%285%2C%20sum%285%2C%20new%20int%5B%5D%20%7B5%7D%29%29%3B%0A%7D%0Aprivate%20int%20sum%28int%20value%2C%20int%5B%5D%20values%29%20%7B%0A%09int%20sum%3D%200%3B%20%0A%09for%20%28%20int%20i%3D%200%3B%20i%3Cvalues.length%3B%20i++%29%0A%09%09sum%20+%3D%20values%5Bi%5D%3B%0A%09return%20sum%3B%0A%7D%0A%0A//%204.%20delete%20unnecessary%20code%0Apublic%20void%20testSum%28%29%20%7B%20%0A%09assertEquals%285%2C%20sum%28new%20int%5B%5D%20%7B5%7D%29%29%3B%0A%7D%0Aprivate%20int%20sum%28%20int%5B%5D%20values%29%20%7B%0A%09int%20sum%3D%200%3B%20%0A%09for%20%28int%20i%3D%200%3B%20i%3Cvalues.length%3B%20i++%29%0A%09%09sum%20+%3D%20values%5Bi%5D%3B%0A%09return%20sum%3B%20sum%3B%0A%7D%0A%60%60%60%0A%u7EC6%u7EC6%u4F53%u4F1A%u5176%u95F4%u7684%u5DEE%u522B%u5427%u3002%0A%23%23Chapter%2029.%20xUnit%20Patterns%0A%23%23%23Assertion%0A%3EHow%20do%20you%20check%20that%20tests%20worked%20correctly%3F%20%0A%3EWrite%20boolean%20expressions%20that%20automate%20your%20judgment%20about%20whether%20the%20code%20worked.%0A%0A%u4F5C%u8005%u5728%u8FD9%u4E00%u7AE0%u53C8%u7ED9%u51FA%u4E86%u4E00%u4E2A%u5F88%u6709%u6307%u5BFC%u610F%u4E49%u7684%u89C2%u70B9%u3002%0A%3E%u5C3D%u91CF%u4E0D%u8981%u505A%u767D%u76D2%u6D4B%u8BD5%uFF0C%u5982%u679C%u4F60%u60F3%u505A%uFF0C%u8BF4%u660E%u4F60%u7684%u8BBE%u8BA1%u6709%u95EE%u9898%0A%23%23%23Fixture%0A%u8FD9%u91CC%u4F5C%u8005%u629B%u51FA%u4E86%u4E00%u4E2A%u95EE%u9898%uFF0C%u5982%u679C%u6709%u591A%u4E2A%u6D4B%u8BD5%u6709%u7C7B%u4F3C%u7684%u4EE3%u7801%u600E%u4E48%u529E%uFF1F%u4E24%u4E2A%u9009%u62E9%uFF1A%0A1.%20test%20case%u7C7B%u5B9A%u4E49%u4E2D%u62BD%u8C61%u51FA%u7C7B%u4F3CsetUp%u7684%u51FD%u6570%uFF0C%u6765%u505A%u91CD%u590D%u7684%u5DE5%u4F5C%0A2.%20%u6216%u8005%u7528%u7C7B%u4F3C%u4EE3%u7801%u751F%u6210%u5668%u7684%u4E1C%u897F%u6765%u4E3A%u6240%u6709%u9700%u8981%u7684%u6D4B%u8BD5%u751F%u6210fixture%0A%0A%u65B9%u6CD51%u6709%u65F6%u5019%u66F4%u7B26%u5408DRY%u539F%u5219%uFF0C%u4F46%u5B83%u7684%u7F3A%u70B9%u662F%uFF0C%u4F60%u8981%u8BB0%u4F4FsetUp%u91CC%u9762%u5230%u5E95%u505A%u4E86%u4EC0%u4E48%u3002%u4E24%u79CD%u65B9%u6CD5%u90FD%u53EF%u4EE5%uFF0C%u9009%u62E9%u66F4%u5408%u9002%u7684%u3002%0A%0A%23%23%23External%20Fixture%0A%u6240%u8C13%u7684%u5916%u90E8fixture%uFF0C%u5C31%u662F%u8981%u4FDD%u8BC1%u6D4B%u8BD5%u80FD%u6062%u590D%u73AF%u5883%u914D%u7F6E%u3002%0A%3E%u5728%u6240%u6709%u6D4B%u8BD5%u5F00%u59CB%u524D%u8C03setUp%uFF0C%u6240%u6709%u6D4B%u8BD5%u7ED3%u675F%u540E%u8C03tearDown%u3002%u8FD9%u5C31%u662FExternal%20Fixture%0A%23%23%23Test%20Method%0A%u8FD9%u4E00%u8282%u9488%u5BF9%u5982%u4F55%u5199%u6D4B%u8BD5%u65B9%u6CD5%u7ED9%u51FA%u4E86%u4E00%u4E9B%u5EFA%u8BAE%u3002%0A1.%20hierarchy%0A*%20Module%20%24%5Crightarrow%24%20Framework%0A*%20Class%20%24%5Crightarrow%24%20internal%20fixture%0A*%20Method%20%24%20%5Crightarrow%24%20test%20case%0A2.%20%u540D%u5B57%u957F%u6CA1%u5173%u7CFB%uFF0C%u8981%u8BA9%u4EE5%u540E%u7684%u8BFB%u8005%u6709%u8DB3%u591F%u7684%u7EBF%u7D22%u77E5%u9053%u4E3A%u4EC0%u4E48%u8981%u5199%u8FD9%u4E2Atest%0A3.%20%u6D4B%u8BD5%u4EE3%u7801%u8981%u591F%u76F4%u89C9%uFF0C%u8981%u591F%u7B80%u6D01%uFF08%u6700%u77ED3%u884C%uFF09%20%0A4.%20%u6CE8%u91CA%u91CC%u5199outline%uFF0C%u4E00%u9897%u661F%u8868%u793A%u4E00%u7EA7%uFF0C%u4F5C%u8005%u8BF4%u4ED6%u4E00%u822C%u51992-3%u7EA7outline%0A%60%60%60%20cpp%0A/*%20Adding%20to%20tuple%20spaces.%20*/%20%0A/*%20Taking%20from%20tuple%20spaces.%20*/%0A/**%20Taking%20a%20non-existent%20tuple.%20**/%20%0A/**%20Taking%20an%20existing%20tuple.%20**/%20%0A/**%20Taking%20multiple%20tuples.%20**/%20%0A/*%20Reading%20from%20tuple%20space.%20*/%0A%60%60%60%0A%23%23%23Exception%20Test%0A%u8FD9%u4E00%u8282%u8BF4%u7684%u662F%uFF0C%u5982%u679C%u5F85%u6D4B%u7684%u51FD%u6570%u9700%u8981%u629B%u51FA%u5F02%u5E38%uFF0C%u7528%u5982%u4E0B%u7684%u65B9%u6CD5%uFF1A%0A%60%60%60java%0Apublic%20void%20testMissingRate%28%29%20%7B%0A%09try%20%7B%0A%09%09exchange.findRate%28%22USD%22%2C%20%22GBP%22%29%3B%20%0A%09%09fail%28%29%3B%20//%20%u5982%u679C%u6CA1%u629B%u5F02%u5E38%u5C31fail%0A%09%7D%20catch%20%28IllegalArgumentException%20expected%29%20%7B%20%0A%09%7D%0A%7D%0A%60%60%60%0A%23%23%23All%20Tests%0A%3EHow%20do%20you%20run%20all%20tests%20together%3F%20Make%20a%20suite%20of%20all%20the%20suites%u2014one%20for%20each%20package%2C%20and%20one%20aggregating%20the%20package%20tests%20for%20the%20whole%20application.%0A%60%60%60java%0Apublic%20class%20AllTests%20%7B%0A%09//%20%u8FD9%u91CC%u6709%u4E2Amain%uFF0C%u65B9%u4FBF%u76F4%u63A5%u8C03%u7528%u7A0B%u5E8F%u5F00%u59CB%u6D4B%u8BD5%0A%09public%20static%20void%20main%28String%5B%5D%20args%29%20%7B%20%0A%09%09junit.swingui.TestRunner.run%28AllTests.class%29%3B%20%0A%09%7D%0A%09//%20%u8FD9%u91CC%u6709%u4E2Asuite%u5305%u542B%u4E86%u6240%u6709test%20case%0A%09public%20static%20Test%20suite%28%29%20%7B%20%0A%09%09TestSuite%20result%3D%20new%20TestSuite%28%22TFD%20tests%22%29%3B%20%0A%09%09result.addTestSuite%28MoneyTest.class%29%3B%20%0A%09%09result.addTestSuite%28ExchangeTest.class%29%3B%20%0A%09%09result.addTestSuite%28IdentityRateTest.class%29%3B%20%0A%09%09return%20result%3B%0A%09%7D%0A%7D%0A%60%60%60%0A%23%23Chapter%2030.%20Design%20Patterns%0A%u4F5C%u8005%u5728%u8FD9%u4E00%u7AE0%u5F15%u5165%u4E86%u4E00%u4E9BTDD%u4E2D%u4F1A%u7528%u5230%u7684%u8BBE%u8BA1%u6A21%u5F0F%u3002%u6709%u4E9B%u662F%u5199%u6D4B%u8BD5%u65F6%u7528%u7684%uFF0C%u6709%u7684%u662F%u91CD%u6784%u65F6%u7528%u7684%uFF0C%u6709%u7684%u4E24%u8005%u7686%u53EF%u3002%u4E0B%u9762%u662F%u672C%u7AE0%u6240%u6709%u6A21%u5F0F%u7684%u603B%u7EB2%u3002%0A%21%5BAlt%20text%5D%28./1456036251528.png%29%0A%23%23%23Command%0A%3EWhat%20do%20you%20do%20when%20you%20need%20the%20invocation%20of%20a%20computation%20to%20be%20more%20complicated%20than%20a%20simple%20method%20call%3F%0A%3EMake%20an%20object%20for%20the%20computation%20and%20invoke%20it.%0A%0A%u8FD9%u91CC%u6240%u8BF4%u7684%u547D%u4EE4%u662F%u8BF4%uFF0C%u628A%u8981%u8C03%u7528%u7684%u65B9%u6CD5%u5C01%u88C5%u6210%u4E00%u4E2Aobject%uFF0C%u7136%u540E%u8C03%u7528%u90A3%u4E2Aobject%0A%0A%23%23%23Value%20Object%0A%u628A%u4E00%u4E9B%u5E38%u91CF%u53C2%u6570%u505A%u6210object%u6765%u4F20%u9012%0A%3EWhen%20implementing%20a%20Value%20Object%2C%20every%20operation%20has%20to%20return%20a%20fresh%20object%2C%20%0A%3EAll%20Value%20Objects%20have%20to%20implement%20equality%20%0A%0A%23%23%23Null%20Object%0A%60%60%60java%0Apublic%20boolean%20setReadOnly%28%29%20%7B%20%0A%09SecurityManager%20guard%20%3D%20System.getSecurityManager%28%29%3B%20%0A%09if%20%28guard%20%21%3D%20null%29%20%7B%20%29%20%7B%0A%09%09guard.canWrite%28path%29%3B%0A%09%7D%20%0A%09return%20fileSystem.setReadOnly%28this%29%3B%0A%7D%0A%60%60%60%0A%u4E0A%u9762%u8FD9%u4E2A%u4F8B%u5B50getSecurityManager%u5728%u4E0D%u6210%u529F%u65F6%u8FD4%u56DENull%uFF0C%u7136%u540E%u8C03%u7528%u8005%u518D%u5224%u65AD%u8FD4%u56DE%u503C%u4EE5%u51B3%u5B9A%u4F1A%u4E0D%u4F1A%u7528%u7A7A%u6307%u9488%u6765%u8C03%u7528%u6210%u5458%u53D8%u91CF%u3002%0A%u8FD9%u662F%u4E00%u4E2A%u5F88%u5E38%u89C1%u7684%u505A%u6CD5%uFF0C%u8FD9%u6837%u505A%u4E0D%u597D%u7684%u662F%uFF0C%u901A%u5E38%u8FD9%u79CD%u5224%u65AD%u4F1A%u975E%u5E38%u975E%u5E38%u591A%uFF0C%u800C%u4E14%u7ED9%u4EBA%u4E00%u79CD%u201C%u4F1A%u4E0D%u4F1A%u6709%u54EA%u91CC%u6CA1%u5224%u65AD%uFF0C%u4EE5%u540E%u4F1A%u5BFC%u81F4crash%uFF1F%u201D%u7684%u62C5%u5FE7%u3002%0ANull%20Object%u8BBE%u8BA1%u6A21%u5F0F%u5C31%u662F%u8BA9getSecurityManager%u8FD4%u56DE%u4E00%u4E2A%u7279%u6B8A%u7684object%u6765%u53D6%u4EE3Null%uFF0C%u8FD9%u6837%u8BA9%u6240%u6709%u7684%u64CD%u4F5C%u90FD%u7EDF%u4E00%uFF0C%u4EE5%u51CF%u5C11%u91CD%u590D%u4EE3%u7801%u3002%0A%0A%23%23%23Template%20Method%0A%u6A21%u677F%u65B9%u6CD5%u3002%0A%3EWhen%20you%20find%20two%20variants%20of%20a%20sequence%20in%20two%20subclasses%2C%20you%20need%20to%20gradually%20move%20them%20closer%20together.%20Once%20you%27ve%20extracted%20the%20parts%20that%20are%20different%20from%20other%20methods%2C%20what%20you%20are%20left%20with%20is%20the%20Template%20Method.%20%0A%60%60%60java%0A//%20TestCase%0Apublic%20void%20runBare%28%29%20throws%20Throwable%20%7B%20%0A%09setUp%28%29%3B%20%0A%09try%20%7B%20%0A%09%09runTest%28%29%3B%0A%09%7D%0A%09finally%20%7B%0A%09%09tearDown%28%29%3B%0A%09%7D%0A%7D%0A%60%60%60%0A%0A%23%23%23Pluggable%20Object%0A%u4E2D%u6587%u8BD1%u540D%u4E3A%u63D2%u5165%u5F0F%u5BF9%u8C61%u3002%u5F88%u96BE%u7406%u89E3%u54EA%u91CC%u6709%u8FD9%u4E2A%u6240%u8C13%u7684%u201C%u63D2%u5165%u201D%u3002%u8FD9%u4E2A%u8BBE%u8BA1%u6A21%u5F0F%u6838%u5FC3%u7684%u601D%u60F3%u5C31%u662F%u6D88%u9664%60if...else...%60%u7684%u60C5%u51B5%u3002%0A%u770B%u4F5C%u8005%u7684%u4F8B%u5B50%uFF0C%u89E3%u91CA%u7684%u5F88%u6E05%u695A%uFF1A%0A%60%60%60java%0A//%20Without%20Pluggable%20Object%0AFigure%20selected%3B%20%0Apublic%20void%20mouseDown%28%29%20%7B%20%0A%09selected%3D%20findFigure%28%29%3B%0A%09if%20%28selected%20%21%3D%20null%29%20//%20%u5230%u5904%u662Fnull%u5224%u65AD%0A%09%09select%28selected%29%3B%20%0A%7D%0Apublic%20void%20mouseMove%28%29%20%7B%0A%09if%20%28selected%20%21%3D%20null%29%0A%09%09move%28selected%29%3B%20%0A%09else%0A%09%09moveSelectionRectangle%28%29%3B%20%0A%7D%0Apublic%20void%20mouseUp%28%29%20%7B%0A%09if%20%28selected%20%3D%3D%20null%29%0A%09%09selectAll%28%29%3B%0A%7D%20%0A%0A//%20With%20Pluggable%20Object%0ASelectionMode%20mode%3B%0Apublic%20void%20mouseDown%28%29%20%7B%0A%09selected%3D%20findFigure%28%29%3B%0A%09//%20%u5168%u90E8%u5F52%u7ED3%u5230mode%u5B50%u7C7B%u91CC%u9762%u53BB%u5904%u7406%0A%09if%20%28selected%20%21%3D%20null%29%0A%09%09mode%3D%20SingleSelection%28selected%29%3B%0A%09else%0A%09%09mode%3D%20MultipleSelection%28%29%3B%0A%7D%0Apublic%20void%20mouseMove%28%29%20%7B%0A%09mode.mouseMove%28%29%3B%0A%7D%0Apublic%20void%20mouseUp%28%29%20%7B%0A%09mode.mouseUp%28%29%3B%0A%7D%0A%60%60%60%0A%23%23%23Pluggable%20Selector%0A%u8FD9%u4E00%u8282%u7684%u8BBE%u8BA1%u6A21%u5F0F%u548C%u4E0A%u4E00%u8282%u7684%u6781%u4E3A%u7C7B%u4F3C%u3002%u8FD9%u6B21%u8981%u5904%u7406%u6389%u7684%u662F%60switch...case...%60%u800C%u53C8%u4E0D%u7528%u5B50%u7C7B%u7EE7%u627F%u7684%u65B9%u5F0F%u6765%u52A8%u6001%u8C03%u7528%u3002%u8FD9%u91CC%u4F7F%u7528%u7684%u65B9%u6CD5%u53EB%u53CD%u5C04%u3002%0A%3E%u53CD%u5C04%uFF1A%u901A%u8FC7%u81EA%u8EAB%u7684%u5C5E%u6027%uFF08%u5982%u7C7B%u540D%uFF0C%u65B9%u6CD5%u540D%uFF09%u6765%u505A%u76F8%u5173%u903B%u8F91%0A%0A%u540C%u6837%u770B%u4F5C%u8005%u7684%u4F8B%u5B50%0A%60%60%60java%0Avoid%20print%28%29%20%7B%20%0A%09Method%20runMethod%3D%20getClass%28%29.getMethod%28printMessage%2C%20null%29%3B%0A%09runMethod.invoke%28this%2C%20new%20Class%5B0%5D%29%3B%0A%7D%0A%60%60%60%0A%u770B%u5230%u4E86%u6CA1getClass%uFF0CgetMethod%uFF0C%u8FD9%u5C31%u662F%u53CD%u5C04%u3002%u6709%u4E86%u8FD9%u4E2A%u51FD%u6570%u65E2%u4E0D%u9700%u8981switch%u6765%u8C03%u7528%u4E0D%u540C%u7684printxxx%u51FD%u6570%28printHtml%2C%20printXml...%29%uFF0C%u4E5F%u4E0D%u9700%u8981%u5B9A%u4E49%u5B50%u7C7B%u6765%u8C03%u7528%u4E0D%u540C%u7684print%u51FD%u6570%u3002%0A%u4F5C%u8005%u5728%u672C%u8282%u6700%u540E%u7ED9%u51FA%u4E86%u4E00%u6BB5%u5FE0%u544A%uFF1A%0A%3EPluggable%20Selector%20can%20definitely%20be%20overused.%20The%20biggest%20problem%20with%20it%20is%20tracing%20code%20to%20see%20whether%20a%20method%20is%20invoked.%20Use%20Pluggable%20Selector%20only%20when%20you%20are%20cleaning%20up%20a%20fairly%20straightforward%20situation%20in%20which%20each%20of%20a%20bunch%20of%20**subclasses%20has%20only%20one%20method.**%0A%23%23%23Factory%20Method%0A%u4F5C%u8005%u8BF4%u5DE5%u5382%u65B9%u6CD5%u63D0%u4F9B%u4E86%u7075%u6D3B%u6027%u3002%u6211%u662F%u6CA1%u770B%u51FA%u6765%u3002%u5BF9%u6BD4%u4E0B%u9762%u4E24%u6BB5%u4EE3%u7801%uFF0C%u8FD9%u91CC%u589E%u52A0%u4E86%u7075%u6D3B%u6027%uFF1F%0A%60%60%60java%0Apublic%20void%20testMultiplication%28%29%20%7B%0A%09Dollar%20five%3D%20Dollar%20five%3D%20new%20Dollar%285%29%3B%0A%09assertEquals%28new%20Dollar%2810%29%2C%20five.times%282%29%29%3B%20%0A%09assertEquals%28new%20Dollar%2815%29%2C%20five.times%283%29%29%3B%0A%7D%0A%0Apublic%20void%20testMultiplication%28%29%20%7B%20%0A%09Dollar%20five%20%3D%20Money.dollar%285%29%3B%20//%20%u5DE5%u5382%u65B9%u6CD5%0A%09assertEquals%28new%20Dollar%2810%29%2C%20five.times%282%29%29%3B%20%0A%09assertEquals%28new%20Dollar%2815%29%2C%20five.times%283%29%29%3B%20%0A%7D%0A//%20Money%0Astatic%20Dollar%20dollar%28%20Dollar%20dollar%28int%20amount%29%20%7B%20%0A%09return%20new%20Dollar%28amount%29%3B%0A%7D%0A%60%60%60%0A%u4F5C%u8005%u6700%u540E%u7ED9%u51FA%u4E86%u4E00%u70B9%u5FE0%u544A%0A%3E%20You%20have%20to%20remember%20that%20the%20method%20is%20really%20creating%20an%20object%2C%20even%20though%20it%20doesn%27t%20look%20like%20a%20constructor.%20Use%20Factory%20Method%20only%20when%20you%20need%20the%20flexibility%20it%20creates.%20%0A%0A%23%23%23Imposter%0A%u4E2D%u6587%u8BD1%u540D%u4E3A%u5192%u540D%u9876%u66FF%u3002%u6839%u636E%u6587%u4E2D%u7684%u9610%u8FF0%uFF0C%u6211%u7406%u89E3%u8FD9%u91CC%u8BB2%u7684%u4E0D%u662F%u4E00%u79CD**%u8BBE%u8BA1**%u6A21%u5F0F%uFF0C%u800C%u53EA%u662F%u4E00%u79CD%u6A21%u5F0F%uFF0C%u4E00%u79CD%u7279%u6B8A%u60C5%u51B5%u3002%u6307%u7684%u662F%u5982%u679C%u67D0%u4E00%u6BB5%u4EE3%u7801%uFF0C%u53EA%u5C06%u5176%u4E2D%u7684%u4E00%u4E2A%u540D%u5B57%uFF08%u7C7B%u3001%u65B9%u6CD5%u6216%u8005%u53D8%u91CF%u7B49%u7B49%uFF09%u66FF%u6362%u6210%u53E6%u5916%u4E00%u4E2A%u540D%u5B57%uFF0C%u5C31%u80FD%u5F97%u5230%u4E00%u6BB5%u65B0%u7684%u4EE3%u7801%uFF0C%u79F0%u4E3A%u5192%u540D%u9876%u66FF%u3002%u53D1%u73B0%u53EF%u4EE5Imposter%u7684%u60C5%u51B5%uFF0C%u5176%u5B9E%u5C31%u662F%u53D1%u73B0%u91CD%u590D%u3002%0A%60%60%60java%0A//%20%u4E0B%u9762%u8FD9%u4E24%u6BB5%u4EE3%u7801%u5C31%u53EA%u662F%u5C06RectangleFigure%u6362%u6210OvalFigure%uFF0C%u6B64%u662F%u4E3AImposter%u5192%u540D%u9876%u66FF%u3002%0AtestRectangle%28%29%20%7B%0A%09Drawing%20d%3D%20new%20Drawing%28%29%3B%0A%09d.addFigure%28new%20RectangleFigure%280%2C%2010%2C%2050%2C%20100%29%29%3B%20RectangleFigure%280%2C%2010%2C%2050%2C%20100%29%29%3B%0A%09RecordingMedium%20brush%3D%20new%20RecordingMedium%28%29%3B%20%0A%09d.display%28brush%29%3B%20%0A%09assertEquals%28%22rectangle%200%2010%2050%20100%5Cn%22%2C%20brush.log%28%29%29%3B%0A%7D%0A%0AtestOval%28%29%20%7B%0A%09Drawing%20d%3D%20new%20Drawing%28%29%3B%0A%09d.addFigure%28new%20OvalFigure%280%2C%2010%2C%2050%2C%20100%29%29%3B%20%0A%09RecordingMedium%20brush%3D%20new%20RecordingMedium%28%29%3B%20%0A%09d.display%28brush%29%3B%0A%09assertEquals%28%22oval%200%2010%2050%20100%5Cn%22%2C%20brush.log%28%29%29%3B%20%0A%7D%0A%60%60%60%0A%u4F5C%u8005%u8FD8%u63D0%u5230%u53E6%u5916%u4E24%u4E2A%u5728%u91CD%u6784%u4E2D%u7ECF%u5E38%u7528%u5230%u7684%u8BBE%u8BA1%u6A21%u5F0F%uFF0C%u672C%u8D28%u5176%u5B9E%u5C31%u662FImposter%20%u2014%u2014%20Null%20Object%20%26%20Composite%u3002%0A%0A%23%23%23Composite%0A%u6839%u636E%u4E0A%u4E00%u7AE0%u4F5C%u8005%u7684%u89C2%u70B9%uFF0C%u7EC4%u5408%u5176%u5B9E%u5C31%u662F%u4E00%u79CD%u5192%u540D%u9876%u66FF%u3002%u4F5C%u8005%u5728%u672C%u8282%u5F00%u5934%u8BF4%u4E86%uFF1A%0A%3EHow%20do%20you%20implement%20**an%20object**%20whose%20behavior%20is%20the%20composition%20of%20the%20behavior%20of%20a%20list%20of%20other%20objects%3F%20Make%20it%20an%20**Imposter**%20for%20**the%20component%20objects**.%0A%0A%u8BA9%u8FD9%u4E2A%u5BF9%u8C61%u79F0%u4E3A%u7EC4%u6210%u4ED6%u7684%u5BF9%u8C61%u7684%u5192%u540D%u9876%u66FF%u8005%u3002%u8BF4%u8D77%u6765%u5F88%u62D7%u53E3%u3002%u770B%u4F8B%u5B50%uFF1A%0A%60%60%60java%0A//%20Transaction%0ATransaction%28Money%20value%29%20%7B%0A%09this.value%3D%20value%3B%0A%7D%0A//%20Account%0ATransaction%20transactions%5B%5D%3B%0AMoney%20balance%28%29%20%7B%0A%09Money%20sum%3D%20Money.zero%28%29%3B%0A%09for%20%28int%20i%3D%200%3B%20i%20%3C%20transactions.length%3B%20i++%29%20%0A%09%09sum%3D%20sum.plus%28transactions%5Bi%5D.value%29%3B%0A%09return%20sum%3B%0A%7D%0A%60%60%60%0A%u8FD9%u4E2A%u5199%u6CD5%u7684%u7F3A%u70B9%u662F%uFF0C%u5F53%u8981%u7B97OverallAccount%u65F6%uFF0C%u6CA1%u8F99%u4E86%uFF0C%u8981%u5B9A%u4E49%u4E00%u4E2A%u65B0%u7C7B%u6765%u5904%u7406%u3002%u4E00%u4E2AOverallAccount%u662F%u4E00%u7EC4Account%u3002%u4F46OverallAccount%u5176%u5B9E%u8981%u505A%u7684%u4E5F%u662F%u4E00%u79CD%u7D2F%u52A0%uFF0C%u548CAccount%u505A%u7684%u5E76%u6CA1%u6709%u4EC0%u4E48%u533A%u522B%u3002%u8FD9%u5C31%u662F%u91CD%u590D%u3002%0A%u89E3%u51B3%u7684%u529E%u6CD5%u5C31%u662F%u6240%u8C13%u7684Composite%u3002%u628A%u8981%u7D2F%u52A0%u7684%u4E1C%u897F%u62BD%u8C61%u51FA%u6765%u79F0%u4E3AHoldings%uFF0CAccount%u7D2F%u52A0%u7684%u662FHoldings%uFF0COverallAccount%u7D2F%u52A0%u7684%u4E5F%u662FHoldings%u3002%0A%60%60%60java%0AHolding%20holdings%5B%5D%3B%0AMoney%20balance%28%29%20%7B%0A%09Money%20sum%3D%20Money.zero%28%29%3B%0A%09for%20%28%20%28int%20i%3D%200%3B%20i%20%3C%20holdings.length%3B%20i++%29%0A%09sum%3D%20sum.plus%28holdings%5Bi%5D.balance%28%29%29%3B%0A%09return%20sum%3B%0A%7D%0A%60%60%60%0A%u5199%u5230%u8FD9%u91CC%uFF0C%u6211%u4ECD%u7136%u4E0D%u662F%u7279%u522B%u660E%u767D%u4F55%u4E3AComposite%uFF08%u62FC%u5408%uFF0C%u590D%u5408%u7684%u610F%u601D%uFF09%u3002%u4F46%u6211%u4EEC%u662F%u7AD9%u5728%u5DE8%u4EBA%u7684%u80A9%u8180%u4E0A%uFF0C%u5BF9%u6BD4%u9605%u8BFB%u4E86%u4E2D%u6587%u8BD1%u672C%u540E%u6709%u4E86%u4E00%u70B9%u70B9%u611F%u89C9%u3002%u8FD9%u4E2A%u8BBE%u8BA1%u6A21%u5F0F%u7684%u4E2D%u6587%u8BD1%u540D%u4E3A-**%u9012%u5F52%u7EC4%u5408**%u3002%u6240%u8C13%u9012%u5F52%uFF0C%u5E94%u5F53%u6307%u7684%u662F%uFF0C%u901A%u8FC7%u6982%u5FF5%u4E0A%u7684%u62BD%u8C61%uFF0C%u5C06%u4E00%u4E2A%u5927%u7684%u6DF7%u5408%u7C7B%u5199%u6210%u4E00%u4E9B%u66F4%u62BD%u8C61%u7684%u6982%u5FF5%u7684%u7EC4%u5408%u3002%u4F8B%u5982%3A%20%0A%3EOvreallAccount%20%3C-%20Account%20%3C-%20Transactions%0A%3EOverallAccount%20%3C-%20Holding%20%26%20Account%20%3C-Holding%0A%0A%u901A%u8FC7%u9012%u5F52%u5730%u5C06OverallAccount%u5192%u540D%u9876%u66FF%u6210Holding%uFF0C%u4ECE%u800C%u4F7FOverallAccount%u6210%u4E3A%u4E00%u4E2AAccount%u6765%u8FBE%u5230%u6D88%u9664%u91CD%u590D%u3002%0A%u4F5C%u8005%u5728%u672C%u8282%u6700%u540E%u7ED9%u51FA%u4E86%u4F55%u65F6%u4F7F%u7528Composite%u7684%u5EFA%u8BAE%uFF1A%0A%3EAs%20is%20obvious%20from%20this%20discussion%2C%20I%27m%20still%20not%20able%20to%20articulate%20how%20to%20guess%20when%20a%20collection%20of%20objects%20is%20just%20a%20collection%20of%20objects%20and%20when%20you%20really%20have%20a%20Composite.%20The%20good%20news%20is%2C%20since%20you%27re%20getting%20good%20at%20refactoring%2C%20%3Cb%3E%3Cfont%20color%3D%22IndianRed%22%3Ethe%20moment%20the%20duplication%20appears%3C/font%3E%3C/b%3E%2C%20you%20can%20introduce%20Composite%20and%20watch%20program%20complexity%20disappear.%0A%0A%23%23%23Collecting%20Parameter%0A%u770B%u4E0D%u61C2%uFF0C%u4E0D%u77E5%u6240%u4E91%0A%0A%23%23%23Singleton%0A%u8FD9%u4E2A%u5C31%u662F%u5F88%u8457%u540D%u7684%u5355%u4F8B%u6A21%u5F0F%uFF0C%u7ECF%u5E38%u4F1A%u7528%u5230%u3002%u4F5C%u8005%u6CA1%u6709%u8BE6%u52A0%u9610%u91CA%uFF0C%u53EA%u662F%u544A%u8BEB%u8BFB%u8005%u4E0D%u8981%u7528%u5168%u5C40%u53D8%u91CF%28global%20variable%29%u3002%u6211%u731C%u4F5C%u8005%u7684%u610F%u601D%u662F%uFF0C%u5982%u679C%u8981%u7528%u5168%u5C40%u53D8%u91CF%uFF0C%u5C31%u7528%u5355%u4F8B%u6A21%u5F0F%u7684%u7C7B%u5BF9%u8C61%u5427%u3002%0A%0A%23%23Chapter%2031.%20Refactoring%0A%u5728TDD%u4E2D%uFF0C%u91CD%u6784%u8981%u505A%u7684%u5C31%u662F%uFF0C%u4FDD%u8BC1%u6240%u6709%u6D4B%u8BD5%u901A%u8FC7%u7684%u60C5%u51B5%u4E0B%uFF0C%u964D%u4F4E%u91CD%u590D%uFF08code%u4E4B%u95F4%uFF0Ccode%u4E0Etest%u4E4B%u95F4%uFF09%u3002%0A%23%23%23Reconcile%20Differences%0A%3E-%20How%20do%20you%20unify%20two%20similar%20looking%20pieces%20of%20code%3F%20Gradually%20bring%20them%20closer.%20Unify%20them%20only%20when%20they%20are%20absolutely%20identical.%20%u4E0D%u8981%u5F3A%u5236%u6574%u5408%uFF0C%u7B49%u4ED6%u4EEC%u5B8C%u5168%u76F8%u7B49%u4E86%u518D%u8BF4%0A%3E-%20Such%20a%20leap-of-faith%20refactoring%20is%20exactly%20what%20we%27re%20trying%20to%20avoid%20with%20our%20strategy%20of%20small%20steps%20and%20concrete%20feedback.%20Although%20you%20can%27t%20always%20avoid%20leapy%20refactorings%2C%20you%20can%20reduce%20their%20incidence.%20%u4E0D%u8981%u505A%u8DE8%u8D8A%u5F0F%u7684%u91CD%u6784%u3002%0A%3E-%20Sometimes%20you%20need%20to%20approach%20reconciling%20differences%20backward%u2014that%20is%2C%20think%20about%20how%20the%20last%20step%20of%20the%20change%20could%20be%20trivial%2C%20then%20work%20backward.%20%u53CD%u5411%u601D%u8003%uFF0C%u5C3D%u91CF%u8BA9%u6BCF%u4E00%u6B65%u90FD%u975E%u5E38%u5C0F%28trivial%29%uFF0C%u8FD9%u6837%u65B9%u4FBF%u56DE%u9000%u3002%0A%0A%23%23%23Isolate%20Change%0A%u9694%u79BB%u6539%u52A8%uFF0C%u4E5F%u5C31%u662F%u6211%u4EEC%u901A%u5E38%u505A%u7684%u4E00%u4E9B%u62BD%u8C61%u5C01%u88C5%u3002%u628A%u53D8%u5316%u7684%u90E8%u5206%u7528%u63A5%u53E3%u5305%u88C5%u8D77%u6765%uFF0C%u8FD9%u6837%u5C31%u8FBE%u5230%u4E86%u9694%u79BB%u7684%u6548%u679C%u3002%0A%3ESome%20possible%20ways%20to%20isolate%20change%20are%20Extract%20Method%20%28the%20most%20common%29%2C%20Extract%20Object%2C%20and%20Method%20Object.%0A%0A%23%23%23Migrate%20Data%0A%u4E0D%u77E5%u6240%u4E91%0A%0A%23%23%23Extract%20Method%0A%3EHow%20do%20you%20make%20a%20long%2C%20complicated%20method%20easier%20to%20read%3F%20Turn%20a%20small%20part%20of%20it%20into%20a%20separate%20method%20and%20call%20the%20new%20method.%20%u5C06%u4E00%u4E2A%u5927%u51FD%u6570%u6253%u788E%uFF0C%u4ECE%u4E2D%u63D0%u53D6%u4E00%u4E9B%u65B9%u6CD5%u51FA%u6765%u3002%0A%23%23%23%23%20How%0A%3E1.%20Find%20a%20region%20of%20the%20method%20that%20would%20make%20sense%20as%20its%20own%20method.%20Bodies%20of%0Aloop%2C%20whole%20loops%2C%20and%20branches%20of%20conditionals%20are%20common%20candidates%20for%20extraction.%0A%3E2.%20Make%20sure%20that%20there%20are%20no%20assignments%20to%20temporary%20variables%20declared%20outside%20the%0Ascope%20of%20the%20region%20to%20be%20extracted.%0A%3E3.%20Copy%20the%20code%20from%20the%20old%20method%20to%20the%20new%20method.%20Compile%20it.%0A%3E4.%20For%20each%20temporary%20variable%20or%20parameter%20of%20the%20original%20method%20used%20in%20the%20new%0Amethod%2C%20add%20a%20parameter%20to%20the%20new%20method.%0A%3E5.%20Call%20the%20new%20method%20from%20the%20original%20method.%0A%0A%23%23%23%23Why%0A1.%20%u589E%u5F3A%u53EF%u8BFB%u6027%0A2.%20%u6D88%u9664%u91CD%u590D%uFF0C%u5F53%u4F60%u53D1%u73B0%u6709%u4E24%u4E2A%u5927%u51FD%u6570%uFF0C%u6709%u4E00%u90E8%u5206%u662F%u76F8%u540C%u7684%uFF0C%u90A3%u5C31%u53EF%u4EE5%u63D0%u53D6%u51FA%u6765%u79F0%u4E3A%u65B0%u7684%u65B9%u6CD5%u3002%0A3.%20%u901A%u8FC7inline%u628A%u4E00%u5806%u51FD%u6570%u653E%u5728%u4E00%u8D77%uFF0C%u7136%u540E%u770B%u770B%u54EA%u91CC%u53EF%u4EE5extract%20%uFF08%u8FD9%u4E00%u70B9%u6211%u611F%u89C9%u5E94%u8BE5%u653E%u5728How%u91CC%u9762%uFF0C%u4F5C%u8005%u662F%u60F3%u627F%u4E0A%u542F%u4E0B%uFF0C%u5C06inline%u5427%uFF09%0A%0A%23%23%23Inline%20Method%0Ainline%u5F88%u7384%u4E4E%uFF0C%u5176%u5B9E%u5C31%u662F%u628A%u51FD%u6570%u7684%u4EE3%u7801%u590D%u5236%u5230%u8C03%u7528%u7684%u5730%u65B9%u3002%u597D%u5904%u662F%u4EC0%u4E48%uFF0C%u4F5C%u8005%u6709%u8BDD%u8BF4%uFF1A%0A%3EYou%20might%20like%20the%20second%20version%20better%2C%20or%20you%20might%20not.%20The%20point%20to%20note%20here%20is%20that%20you%20can%20use%20Inline%20Method%20to%20play%20around%20with%20the%20**flow%20of%20control**.%20%0A%u5176%u5B9E%u5C31%u662F%u8BA9%u4F60%u628A%u62BD%u8C61%u51FA%u6765%u7684%u4E1C%u897F%u653E%u5230%u4E00%u8D77%u91CD%u65B0%u62BD%u8C61%uFF0C%u770B%u770B%u4F1A%u4E0D%u4F1A%u6709%u66F4%u597D%u7684%u7ED3%u679C%u3002%u8FD9%u4E5F%u662F%u4E00%u79CD%u91CD%u6784%u7684%u65B9%u6CD5%u3002%0A%0A%23%23%23Extract%20Interface%0A%23%23%23%23How%0A%u5982%u4F55%u5C06%u4E00%u4E2A%u7C7B%u62BD%u8C61%u6210%u4E00%u4E2Ainterface%u3002%u6240%u8C13%u7684interface%u5C31%u662F%u53EA%u6709%u7EAF%u865A%u51FD%u6570%u7684%u7C7B%u3002%0A%3E1.%20Declare%20an%20interface.%20Sometimes%20the%20name%20of%20the%20existing%20class%20should%20be%20the%20name%20of%20the%20interface%2C%20in%20which%20case%20you%20should%20first%20rename%20the%20class.%0A%3E2.%20Have%20the%20existing%20class%20implement%20the%20interface.%0A%3E3.%20Add%20the%20necessary%20methods%20to%20the%20interface%2C%20expanding%20the%20visibility%20of%20the%20methods%20in%20the%20class%20if%20necessary.%0A%3E4.%20Change%20type%20declarations%20from%20the%20class%20to%20the%20interface%20where%20possible.%0A%0A%23%23%23%23Why%0A%u8FD9%u91CC%u63D0%u5230%u4E86%u4E24%u79CD%u60C5%u51B5%uFF1A%0A1.%20%u5F53%u4F60%u9700%u8981%u62BD%u8C61%u51FA%u7236%u7C7B%u65F6%0A2.%20%u5F53%u4F60%u7528%u4E86Mock%20Object%uFF0C%u73B0%u5728%u8981%u4E3A%u8FD9%u4E2Amock%20object%u62BD%u8C61%u51FA%u4E00%u4E2A%u771F%u6B63%u7684%u63A5%u53E3%u65F6%u3002%u4F5C%u8005%u8FD9%u91CC%u63D0%u5230%u4E86%u4E00%u4E2A%u5C0F%u6280%u5DE7%uFF0C%u5728%u8FD9%u79CD%u60C5%u51B5%u4E0B%u547D%u540D%u662F%u4E00%u4E2A%u5934%u75BC%u7684%u95EE%u9898%u3002%u4E0D%u59A8%u5C31%u628A%u65B0%u7684interface%u79F0%u4E3AIXXX%uFF0C%u4F8B%u5982%uFF0C%u539F%u6765%u7684%u53EB%60File%60%uFF0C%u65B0%u7684%u63A5%u53E3%u5C31%u79F0%u4E3A%60IFile%60%0A%0A%23%23%23Move%20Method%0A%u5176%u5B9E%u5C31%u662F%u628A%u4E00%u4E2A%u7C7B%u7684%u65B9%u6CD5%u79FB%u5230%u53E6%u5916%u4E00%u4E2A%u7C7B%u91CC%u9762%u3002%u4F46%u4F5C%u8005%u63D0%u5230%u4E86%u4E00%u79CD%u60C5%u51B5%u4E0B%uFF0C%u8FD9%u4E2A%u65B9%u6CD5%u4E0D%u9002%u7528%u3002%u5C31%u662F%u8FD9%u4E2A%u65B9%u6CD5%u4FEE%u6539%u4E86%u539F%u5148%u90A3%u4E2A%u7C7B%u7684%u6570%u636E%u3002%0A%0A%23%23%23Method%20Object%0A%u8FD9%u4E2A%u8BDD%u9898%u597D%u50CF%u5F88%u65B0%u9C9C%uFF0C%u4E4B%u524D%u770B%u5230%u8FC7%u5F88%u591A%u6B21%uFF0C%u4F46%u5E76%u6CA1%u6709%u6DF1%u7A76%u3002%u5148%u770B%u770BHow%uFF1A%0A%23%23%23%23How%0A%3E1.%20Create%20an%20object%20with%20the%20same%20parameters%20as%20the%20method.%0A%3E2.%20Make%20the%20local%20variables%20also%20instance%20variables%20of%20the%20object.%0A%3E3.%20Create%20one%20method%20called%20run%28%29%2C%20whose%20body%20is%20the%20same%20as%20the%20body%20of%20the%20original%20method.%0A%3E4.%20In%20the%20original%20method%2C%20create%20a%20new%20object%20and%20invoke%20run%28%29.%0A%0A%u6709%u4EC0%u4E48%u597D%u5904%uFF1F%0A%23%23%23%23Why%0A%u4E24%u4E2A%u597D%u5904%0A1.%20%u5728%u6DFB%u52A0%u590D%u6742%u903B%u8F91%u7684%u65F6%u5019%uFF0C%u5982%u679C%u6709%u5BF9%u4E00%u4E2A%u8FC7%u7A0B%u6709%u591A%u79CD%u65B9%u6CD5%uFF0C%u90A3%u521B%u5EFA%u4E00%u4E2A%u65B9%u6CD5%u5BF9%u8C61%uFF0C%u518D%u6269%u5C55%u8D77%u6765%u5C31%u5F88%u7B80%u5355%0A2.%20%u5728%u4E00%u4E2A%u590D%u6742%u51FD%u6570%u91CCextract%20interface%u7684%u65F6%u5019%uFF0C%u901A%u5E38%u4E00%u6BB5code%u9700%u89815%uFF0C6%u4E2A%u53C2%u6570%uFF0C%u8FD9%u6837%u7684%u8BDD%uFF0C%u867D%u7136%u51FD%u6570%u62BD%u53D6%u51FA%u6765%u4E86%uFF0C%u4F46%u662F%u5199%u6CD5%u5E76%u6CA1%u6709%u7B80%u5316%u591A%u5C11%u3002%u8FD9%u65F6%u5019%u5982%u679C%u6709%u65B9%u6CD5%u5BF9%u8C61%uFF0C%u5219%u5728%u7C7B%u91CC%u9762%u662F%u4E00%u4E2A%u72EC%u7ACB%u7684%u540D%u5B57%u7A7A%u95F4%uFF0C%u4F1A%u63D0%u4F9B%u989D%u5916%u7684%u4FBF%u5229%u3002%0A%0A%23%23%23Add%20Parameter%0A%u5C31%u662F%u52A0%u4E00%u4E2A%u53C2%u6570%uFF0C%u6CA1%u4EC0%u4E48%u7279%u522B%u7684%0A%0A%23%23%23Method%20Parameter%20to%20Constructor%20Parameter%0A%u5C31%u662F%u628A%u65B9%u6CD5%u8C03%u7528%u7684%u53C2%u6570%uFF0C%u53D8%u6210%u7C7B%u6210%u5458%u53D8%u91CF%u3002%u4E3A%u4EC0%u4E48%u8981%u8FD9%u4E48%u505A%uFF1F%0A%3EIf%20you%20pass%20the%20same%20parameter%20to%20several%20different%20methods%20in%20the%20same%20object%2C%20then%20you%20can%20simplify%20the%20API%20by%20passing%20the%20parameter%20once%20%28eliminating%20duplication%29.%20You%20can%20run%20this%20refactoring%20in%20reverse%20if%20you%20find%20that%20an%20instance%20variable%20is%20used%20in%20only%20one%20method.%0A%0A%u8FD9%u4E2A%u65B9%u6CD5%u7B80%u5355%u5B9E%u7528%u3002%0A%0A%23%23Chapter%2032.%20Mastering%20TDD%0A%u7ECF%u8FC731%u7AE0%u7684%u5B66%u4E60%uFF0C%u4F5C%u8005%u8BA4%u4E3A%u6211%u4EEC%u5DF2%u7ECF%u5B8C%u5B8C%u5168%u5168%u6709%u80FD%u529B%u6210%u4E3A%u4E00%u4E2A%u5408%u683C%u7684TDD%u7A0B%u5E8F%u5458%u4E86%u3002%u5728%u8FD9%u4E00%u7AE0%u91CC%uFF0C%u4F5C%u8005%u53C8%u603B%u7ED3%u51FA%u5F88%u591ATDD%u521D%u5B66%u8005%u7684%u95EE%u9898%uFF0C%u7ED9%u4E88%u56DE%u7B54%u3002%u7B54%u6848%u90FD%u662F%u4E00%u4E9B%u5F88%u5B9E%u7528%u7684%u5FE0%u544A%uFF0C%u7279%u6458%u53D6%u5982%u4E0B%u3002%0A%0A%23%23%23What%20don%27t%20you%20have%20to%20test%3F%0A%u4F5C%u8005%u5E76%u6CA1%u6709%u76F2%u76EE%u5F3A%u8C03%u6D4B%u8BD5%u91CD%u8981%uFF0C%u4E5F%u6CA1%u6709%u8BF4%u4EFB%u4F55%u5730%u65B9%u90FD%u8981%u5199%u6D4B%u8BD5%u3002%u4F5C%u8005%u8BF4%uFF1A%0A%3EUnless%20you%20have%20reason%20to%20distrust%20it%2C%20don%27t%20test%20code%20from%20others.%20%0A%3E%22Write%20tests%20until%20fear%20is%20transformed%20into%20boredom.%22%0A%0A%u53EA%u5728%u4F60%u4E0D%u76F8%u4FE1%u4F60%u7684code%u65F6%uFF0C%u5BF9%u4ED6%u8FDB%u884C%u6D4B%u8BD5%u3002%u6D4B%u8BD5%u4E5F%u4E0D%u662F%u4E3A%u4E86%u6D4B%u8BD5%u800C%u6D4B%u8BD5%uFF0C%u6216%u8005%u4E3A%u4E86%u4EE3%u7801%u7684%u5065%u58EE%uFF0C%u6D4B%u8BD5%u53EA%u662F%u4E3A%u4E86%u51CF%u5C11%u4F60%u7684%u7126%u8651%u3002%u8BA9%u4F60%u4E0D%u8981%u4ECE%u62C5%u5FC3%u53D8%u6210%u70E6%u8E81%uFF0C%u4EC5%u6B64%u800C%u5DF2%u3002%0A%u54CE%uFF01%u771F%u662F%u918D%u9190%u704C%u9876%uFF01%u76F8%u89C1%u6068%u665A%uFF01%0A%0A%23%23%23How%20do%20you%20know%20if%20you%20have%20good%20tests%3F%0A%u4EC0%u4E48%u6837%u7684%u6D4B%u8BD5%u4E0D%u597D%uFF1F%0A%3E1.%20Long%20setup%20code.%20%u5982%u679C%u4E3A%u4E86%u505A%u4E00%u4E2A%u7B80%u5355%u7684%u6D4B%u8BD5%uFF0C%u53EF%u80FD%u53EA%u6709%u51E0%u884C%u65AD%u8A00%uFF0C%u800C%u4E3A%u6B64%u521B%u5EFA%u4E00%u4E2A%u5DE8%u5927%u7684%u5BF9%u8C61%uFF0C%u90A3%u8BF4%u660E%u54EA%u91CC%u80AF%u5B9A%u51FA%u95EE%u9898%u4E86%u3002%0A%3E2.%20Setup%20duplication.%20%u5982%u679C%u4F60%u53D1%u73B0%u6709%u51E0%u4E2A%u6D4B%u8BD5%u62E5%u6709%u76F8%u540C%u6216%u76F8%u4F3C%u7684setup%u4EE3%u7801%uFF0C%u90A3%u8BF4%u660E%u4F60%u7684%u6D4B%u8BD5%u4E2D%u6709%u91CD%u590D%u7684%u5730%u65B9%u3002%0A%3E3.%20Long%20running%20tests.%20TDD%20tests%20that%20run%20a%20long%20time%20won%27t%20be%20run%20often.%20Suites%20that%20take%20longer%20than%20ten%20minutes%0Ainevitably%20get%20trimmed.%20%u4E00%u4E2A%u6D4B%u8BD5%u5957%u4EF6%u4E0D%u8981%u8D85%u8FC7%u5341%u5206%u949F%u3002%u5426%u5219%uFF0C%u53CD%u590D%u8FD0%u884C%u7684%u673A%u4F1A%u5C31%u4F1A%u6025%u5267%u964D%u4F4E%u3002%0A%3E4.%20Fragile%20tests.%20Tests%20that%20break%20unexpectedly%20suggest%20that%20one%20part%20of%20the%20application%20is%20surprisingly%20affecting%20another%20part.%20%u5982%u679C%u6D4B%u8BD5%u88AB%u65E0%u60C5%u6253%u65AD%uFF0C%u8BF4%u660E%u4F60%u7684%u7A0B%u5E8F%u91CC%u6709%u8026%u5408%u3002%0A%0A%23%23%23How%20does%20TDD%20lead%20to%20frameworks%3F%0A%u53C8%u88AB%u918D%u9190%u704C%u9876%u4E86%uFF01%0A%3ETDD%20appears%20to%20stand%20this%20advice%20on%20its%20head%3A%20%3Cb%3E%3Cfont%20color%3D%22IndianRed%22%3E%22Code%20for%20tomorrow%2C%20design%20for%20today.%22%20%3C/font%3E%3C/b%3EHere%27s%20what%20happens%20in%20practice.%20%u4E0D%u8981%u4E3A%u672A%u6765%u8003%u8651%u90A3%u4E48%u591A%uFF0C%u7B80%u5355%u7684%u8BA9%u6D4B%u8BD5%u901A%u8FC7%uFF0C%u7136%u540E%u53CA%u65F6%u7684%u505A%u91CD%u6784%u6D88%u9664%u91CD%u590D%uFF0C%u53CD%u800C%u80FD%u8FBE%u5230%u66F4%u597D%u7684%u8BBE%u8BA1%u6846%u67B6%uFF08frameworks%uFF09%u3002%0A%0A%23%23%23How%20much%20feedback%20do%20you%20need%3F%0A%u8FD9%u91CC%u8BF4%u7684%u548C%u4E4B%u524D%u4E00%u76F4%u5F3A%u8C03%u7684%u601D%u60F3%u5F88%u4E00%u81F4%0A%3E%20If%20our%20knowledge%20of%20the%20implementation%20gives%20us%20confidence%20even%20without%20a%20test%2C%20then%20we%20will%20not%20write%20that%20test.%20%0A%0A%23%23%23When%20should%20you%20delete%20tests%3F%0A%3E1.%20The%20first%20criterion%20for%20your%20tests%20is%20**confidence**.%20Never%20delete%20a%20test%20if%20it%20reduces%20your%20confidence%20in%20the%20behavior%20of%20the%20system.%0A%3E2.%20The%20second%20criterion%20is%20**communication**.%20If%20you%20have%20two%20tests%20that%20exercise%20the%20same%20path%20through%20the%20code%2C%20but%20they%20speak%20to%20different%20scenarios%20for%20a%20reader%2C%20leave%20them%20alone.%0A%0A%23%23%23Can%20you%20drive%20development%20with%20application-level%20tests%3F%0A%u4E0D%u8981%u5C1D%u8BD5%u505A%u5E94%u7528%u7EA7%u522B%u7684test%0A%0A%23%23%23How%20do%20you%20switch%20to%20TDD%20midstream%3F%0A%u8FD9%u4E5F%u662F%u6211%u60F3%u95EE%u7684%uFF0C%u4F5C%u8005%u7684%u56DE%u7B54%u662F%u8FD9%u672C%u4E66%u5C31%u662F%u4E3A%u4E86%u8FD9%u4E2A%u800C%u5199%u7684%u3002%0A%3EThere%20is%20a%20whole%20book%20%28or%20books%29%20to%20be%20written%20about%20switching%20to%20TDD%20when%20you%20have%20lots%20of%20code.%20What%20follows%20is%20necessarily%20only%20a%20teaser.%0A%0A%u600E%u4E48%u505A%uFF1F%0A1.%20So%20first%20we%20have%20to%20decide%20to%20limit%20the%20scope%20of%20our%20changes.%20%0A2.%20Second%2C%20we%20have%20to%20break%20the%20deadlock%20between%20tests%20and%20refactoring.%20%0A%093.%20%u600E%u4E48%u83B7%u5F97feedback%0A%09%091%29%20We%20can%20get%20feedback%20other%20ways%20than%20with%20tests%2C%20like%20working%20very%20carefully%20and%20with%20a%20partner.%20%0A%09%092%29%20We%20can%20get%20feedback%20at%20a%20gross%20level%2C%20like%20system-level%20tests%20that%20we%20know%20aren%27t%20adequate%20but%20give%20us%20some%20confidence.%20With%20this%20feedback%2C%20we%20can%20make%20the%20areas%20we%20have%20to%20change%20more%20accepting%20of%20change.%0A%0A%23%23%23How%20does%20TDD%20relate%20to%20the%20practices%20of%20Extreme%20Programming%3F%0A%u540D%u8BCD%u89E3%u91CA%uFF1A%5BExtreme%20Programming%20-%20XP%5D%28http%3A//baike.baidu.com/link%3Furl%3DNgfFcw4hxjOQHRtEArm4buq177_Xw562MDhrOykDcd-0EOv1xB_Oz3eslAn9X65cFdUel2xI7tTiqB3Gqyz3Ja%29%u6781%u9650%u7F16%u7A0B%0A%3E%u6781%u9650%u7F16%u7A0B%u662F%u4E00%u4E2A%u8F7B%u91CF%u7EA7%u7684%u3001%u7075%u5DE7%u7684%u8F6F%u4EF6%u5F00%u53D1%u65B9%u6CD5%uFF1B%u540C%u65F6%u5B83%u4E5F%u662F%u4E00%u4E2A%u975E%u5E38%u4E25%u8C28%u548C%u5468%u5BC6%u7684%u65B9%u6CD5%u3002%u5B83%u7684%u57FA%u7840%u548C%u4EF7%u503C%u89C2%u662F%u4EA4%u6D41%u3001%u6734%u7D20%u3001%u53CD%u9988%u548C%u52C7%u6C14%uFF1B%u5373%uFF0C%u4EFB%u4F55%u4E00%u4E2A%u8F6F%u4EF6%u9879%u76EE%u90FD%u53EF%u4EE5%u4ECE%u56DB%u4E2A%u65B9%u9762%u5165%u624B%u8FDB%u884C%u6539%u5584%uFF1A%u52A0%u5F3A%u4EA4%u6D41%uFF1B%u4ECE%u7B80%u5355%u505A%u8D77%uFF1B%u5BFB%u6C42%u53CD%u9988%uFF1B%u52C7%u4E8E%u5B9E%u4E8B%u6C42%u662F%u3002XP%u662F%u4E00%u79CD%u8FD1%u87BA%u65CB%u5F0F%u7684%u5F00%u53D1%u65B9%u6CD5%uFF0C%u5B83%u5C06%u590D%u6742%u7684%u5F00%u53D1%u8FC7%u7A0B%u5206%u89E3%u4E3A%u4E00%u4E2A%u4E2A%u76F8%u5BF9%u6BD4%u8F83%u7B80%u5355%u7684%u5C0F%u5468%u671F%uFF1B%u901A%u8FC7%u79EF%u6781%u7684%u4EA4%u6D41%u3001%u53CD%u9988%u4EE5%u53CA%u5176%u5B83%u4E00%u7CFB%u5217%u7684%u65B9%u6CD5%uFF0C%u5F00%u53D1%u4EBA%u5458%u548C%u5BA2%u6237%u53EF%u4EE5%u975E%u5E38%u6E05%u695A%u5F00%u53D1%u8FDB%u5EA6%u3001%u53D8%u5316%u3001%u5F85%u89E3%u51B3%u7684%u95EE%u9898%u548C%u6F5C%u5728%u7684%u56F0%u96BE%u7B49%uFF0C%u5E76%u6839%u636E%u5B9E%u9645%u60C5%u51B5%u53CA%u65F6%u5730%u8C03%u6574%u5F00%u53D1%u8FC7%u7A0B%u3002%0A%0ATDD%u4E0EXP%u7684%u5171%u901A%u4E4B%u5904%uFF1A%0A-%20Pairing%0A-%20Work%20fresh%0A-%20Continuous%20integration%0A-%20Simple%20design%0A-%20Refactoring%0A-%20Continuous%20delivery</center><br></div></div></div>
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/读书笔记/" rel="tag"># 读书笔记</a>
          
            <a href="/tags/unittest/" rel="tag"># unittest</a>
          
            <a href="/tags/Programming/" rel="tag"># Programming</a>
          
            <a href="/tags/TDD/" rel="tag"># TDD</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/01/25/MongoDB连接/" rel="next" title="MongoDB连接">
                <i class="fa fa-chevron-left"></i> MongoDB连接
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/02/29/UnitTest++简介/" rel="prev" title="UnitTest++简介">
                UnitTest++简介 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Ben Zhou</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">158</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">54</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/zhougy0717" title="GitHub &rarr; https://github.com/zhougy0717" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:benzhou.guangyu@gmail.com" title="E-Mail &rarr; mailto:benzhou.guangyu@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#chapter-25-test-driven-development-patterns"><span class="nav-number">1.</span> <span class="nav-text">Chapter 25. Test-Driven Development Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#isolated-test"><span class="nav-number">1.1.</span> <span class="nav-text">Isolated Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#test-list"><span class="nav-number">1.2.</span> <span class="nav-text">Test List</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#test-first"><span class="nav-number">1.3.</span> <span class="nav-text">Test First</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#chapter-26-red-bar-patterns"><span class="nav-number">2.</span> <span class="nav-text">Chapter 26. Red Bar Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#one-step-test"><span class="nav-number">2.1.</span> <span class="nav-text">One Step Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#starter-test"><span class="nav-number">2.2.</span> <span class="nav-text">Starter Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#explanation-test"><span class="nav-number">2.3.</span> <span class="nav-text">Explanation Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#learning-test"><span class="nav-number">2.4.</span> <span class="nav-text">Learning Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#regression-test"><span class="nav-number">2.5.</span> <span class="nav-text">Regression Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#break"><span class="nav-number">2.6.</span> <span class="nav-text">Break</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#do-over"><span class="nav-number">2.7.</span> <span class="nav-text">Do Over</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#chapter-27-testing-patterns"><span class="nav-number">3.</span> <span class="nav-text">Chapter 27. Testing Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#child-test"><span class="nav-number">3.1.</span> <span class="nav-text">Child Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mock-object"><span class="nav-number">3.2.</span> <span class="nav-text">Mock Object</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#self-shunt"><span class="nav-number">3.3.</span> <span class="nav-text">Self Shunt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#log-string"><span class="nav-number">3.4.</span> <span class="nav-text">Log String</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crash-test-dummy"><span class="nav-number">3.5.</span> <span class="nav-text">Crash Test Dummy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#broken-test"><span class="nav-number">3.6.</span> <span class="nav-text">Broken Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#clean-check-in"><span class="nav-number">3.7.</span> <span class="nav-text">Clean Check-in</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#chapter-28-green-bar-patterns"><span class="nav-number">4.</span> <span class="nav-text">Chapter 28. Green Bar Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#fake-it-x2018til-you-make-it"><span class="nav-number">4.1.</span> <span class="nav-text">Fake It (‘Til You Make It)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#triangulate"><span class="nav-number">4.2.</span> <span class="nav-text">Triangulate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#one-to-many"><span class="nav-number">4.3.</span> <span class="nav-text">One to Many</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#chapter-29-xunit-patterns"><span class="nav-number">5.</span> <span class="nav-text">Chapter 29. xUnit Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#assertion"><span class="nav-number">5.1.</span> <span class="nav-text">Assertion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fixture"><span class="nav-number">5.2.</span> <span class="nav-text">Fixture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#external-fixture"><span class="nav-number">5.3.</span> <span class="nav-text">External Fixture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#test-method"><span class="nav-number">5.4.</span> <span class="nav-text">Test Method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exception-test"><span class="nav-number">5.5.</span> <span class="nav-text">Exception Test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#all-tests"><span class="nav-number">5.6.</span> <span class="nav-text">All Tests</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#chapter-30-design-patterns"><span class="nav-number">6.</span> <span class="nav-text">Chapter 30. Design Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#command"><span class="nav-number">6.1.</span> <span class="nav-text">Command</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#value-object"><span class="nav-number">6.2.</span> <span class="nav-text">Value Object</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#null-object"><span class="nav-number">6.3.</span> <span class="nav-text">Null Object</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#template-method"><span class="nav-number">6.4.</span> <span class="nav-text">Template Method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pluggable-object"><span class="nav-number">6.5.</span> <span class="nav-text">Pluggable Object</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pluggable-selector"><span class="nav-number">6.6.</span> <span class="nav-text">Pluggable Selector</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#factory-method"><span class="nav-number">6.7.</span> <span class="nav-text">Factory Method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#imposter"><span class="nav-number">6.8.</span> <span class="nav-text">Imposter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#composite"><span class="nav-number">6.9.</span> <span class="nav-text">Composite</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#collecting-parameter"><span class="nav-number">6.10.</span> <span class="nav-text">Collecting Parameter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#singleton"><span class="nav-number">6.11.</span> <span class="nav-text">Singleton</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#chapter-31-refactoring"><span class="nav-number">7.</span> <span class="nav-text">Chapter 31. Refactoring</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#reconcile-differences"><span class="nav-number">7.1.</span> <span class="nav-text">Reconcile Differences</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#isolate-change"><span class="nav-number">7.2.</span> <span class="nav-text">Isolate Change</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#migrate-data"><span class="nav-number">7.3.</span> <span class="nav-text">Migrate Data</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#extract-method"><span class="nav-number">7.4.</span> <span class="nav-text">Extract Method</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#how"><span class="nav-number">7.4.1.</span> <span class="nav-text">How</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#why"><span class="nav-number">7.4.2.</span> <span class="nav-text">Why</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inline-method"><span class="nav-number">7.5.</span> <span class="nav-text">Inline Method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#extract-interface"><span class="nav-number">7.6.</span> <span class="nav-text">Extract Interface</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#how"><span class="nav-number">7.6.1.</span> <span class="nav-text">How</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#why"><span class="nav-number">7.6.2.</span> <span class="nav-text">Why</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#move-method"><span class="nav-number">7.7.</span> <span class="nav-text">Move Method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#method-object"><span class="nav-number">7.8.</span> <span class="nav-text">Method Object</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#how"><span class="nav-number">7.8.1.</span> <span class="nav-text">How</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#why"><span class="nav-number">7.8.2.</span> <span class="nav-text">Why</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#add-parameter"><span class="nav-number">7.9.</span> <span class="nav-text">Add Parameter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#method-parameter-to-constructor-parameter"><span class="nav-number">7.10.</span> <span class="nav-text">Method Parameter to Constructor Parameter</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#chapter-32-mastering-tdd"><span class="nav-number">8.</span> <span class="nav-text">Chapter 32. Mastering TDD</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#what-donx2019t-you-have-to-test"><span class="nav-number">8.1.</span> <span class="nav-text">What don’t you have to test?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#how-do-you-know-if-you-have-good-tests"><span class="nav-number">8.2.</span> <span class="nav-text">How do you know if you have good tests?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#how-does-tdd-lead-to-frameworks"><span class="nav-number">8.3.</span> <span class="nav-text">How does TDD lead to frameworks?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#how-much-feedback-do-you-need"><span class="nav-number">8.4.</span> <span class="nav-text">How much feedback do you need?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#when-should-you-delete-tests"><span class="nav-number">8.5.</span> <span class="nav-text">When should you delete tests?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#can-you-drive-development-with-application-level-tests"><span class="nav-number">8.6.</span> <span class="nav-text">Can you drive development with application-level tests?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#how-do-you-switch-to-tdd-midstream"><span class="nav-number">8.7.</span> <span class="nav-text">How do you switch to TDD midstream?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#how-does-tdd-relate-to-the-practices-of-extreme-programming"><span class="nav-number">8.8.</span> <span class="nav-text">How does TDD relate to the practices of Extreme Programming?</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ben Zhou</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.3.7</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.0.1</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  
  

<script src="//cdn1.lncld.net/static/js/3.11.1/av-min.js"></script>



<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'Re6dKwipPweGqNRhK2OybEc1-gzGzoHsz',
    appKey: 'ugNI1WvNfBknqmpQiszrTg2v',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn'
  });
</script>




  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


  

  

  

  

  

  

  

  

</body>
</html>
