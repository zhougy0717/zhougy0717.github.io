<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Big Ben • Posts by &#34;iptables&#34; tag</title>
        <link>https://blog.zhougy.top</link>
        <description></description>
        <language>en</language>
        <pubDate>Sun, 11 Oct 2020 22:09:34 +0800</pubDate>
        <lastBuildDate>Sun, 11 Oct 2020 22:09:34 +0800</lastBuildDate>
        <category>javascript</category>
        <category>angular</category>
        <category>arm</category>
        <category>单片机</category>
        <category>操作系统</category>
        <category>machine learning</category>
        <category>deep learning</category>
        <category>Linux</category>
        <category>内存管理</category>
        <category>Markdown</category>
        <category>python</category>
        <category>win32com</category>
        <category>nas</category>
        <category>synology</category>
        <category>USB</category>
        <category>Linux Device Drivers</category>
        <category>uboot</category>
        <category>http</category>
        <category>同步</category>
        <category>读书笔记</category>
        <category>程序员修炼之道</category>
        <category>算法</category>
        <category>c/c++</category>
        <category>hexo</category>
        <category>capability</category>
        <category>LD_PRELOAD</category>
        <category>C++</category>
        <category>coding</category>
        <category>UT</category>
        <category>TDD</category>
        <category>印象笔记</category>
        <category>Obsidian</category>
        <category>SELinux</category>
        <category>Android</category>
        <category>xposed</category>
        <category>GitHub</category>
        <category>中断处理</category>
        <category>群晖</category>
        <category>docker</category>
        <category>ttrss</category>
        <category>rsshub</category>
        <category>wallabag</category>
        <category>unittest</category>
        <category>mockito</category>
        <category>powermock</category>
        <category>QT</category>
        <category>nlp</category>
        <category>vim</category>
        <category>SpaceVim</category>
        <category>tmux</category>
        <category>面向对象</category>
        <category>promise</category>
        <category>mongodb</category>
        <category>Programming</category>
        <category>security</category>
        <category>C++11</category>
        <category>IoT</category>
        <category>broadlink</category>
        <category>domoticz</category>
        <category>UML</category>
        <category>socket</category>
        <category>iptables</category>
        <category>neural network</category>
        <category>mock</category>
        <category>深度学习</category>
        <category>schedule algorithm</category>
        <category>glibc</category>
        <category>gtest</category>
        <category>gmock</category>
        <category>golang</category>
        <category>elf</category>
        <category>软件开发</category>
        <category>设计模式</category>
        <category>Calibre</category>
        <category>电子书</category>
        <category>Rap</category>
        <category>Eminem</category>
        <category>红楼梦</category>
        <category>教育</category>
        <category>code review</category>
        <category>committer</category>
        <item>
            <guid isPermalink="true">https://blog.zhougy.top/2020/10/11/iptables_+_SELinux%E6%8E%A7%E5%88%B6socket_packet/</guid>
            <title>iptables + SELinux控制socket packet</title>
            <link>https://blog.zhougy.top/2020/10/11/iptables_+_SELinux%E6%8E%A7%E5%88%B6socket_packet/</link>
            <category>SELinux</category>
            <category>socket</category>
            <category>iptables</category>
            <pubDate>Sun, 11 Oct 2020 22:09:34 +0800</pubDate>
            <description><![CDATA[ &lt;div style=&#34;font-size: 14px; margin: 0; padding: 0; width: 100%;&#34;&gt;&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;SELinux&amp;#x5BF9;socket&amp;#x7684;&amp;#x63A7;&amp;#x5236;&amp;#x5305;&amp;#x542B;&amp;#x8FD9;&amp;#x51E0;&amp;#x4E2A;&amp;#x65B9;&amp;#x9762;&amp;#xFF1A;&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;context&amp;#x8BED;&amp;#x6CD5;&amp;#x4E2D;&amp;#x7684;nodecon, portcon, netifcon&amp;#xFF1A;&amp;#x8FD9;&amp;#x4E00;&amp;#x7C7B;&amp;#x63A7;&amp;#x5236;&amp;#x672C;&amp;#x7AEF;&amp;#x7CFB;&amp;#x7EDF;&amp;#x8D44;&amp;#x6E90;&amp;#xFF0C;&amp;#x786E;&amp;#x4FDD;&amp;#x5408;&amp;#x6CD5;&amp;#x8FDB;&amp;#x7A0B;&amp;#x624D;&amp;#x80FD;&amp;#x8BBF;&amp;#x95EE;&amp;#x672C;&amp;#x7AEF;&amp;#x7F51;&amp;#x7EDC;&amp;#x8D44;&amp;#x6E90;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x901A;&amp;#x8FC7;iptables&amp;#x5DE5;&amp;#x5177;&amp;#x7684;SECMARK/CONNSECMARK&amp;#x6269;&amp;#x5C55;&amp;#x4E3A;socket packet&amp;#x6253;&amp;#x4E0A;&amp;#x7684;&amp;#x6807;&amp;#x7B7E;&amp;#xFF1A;&amp;#x8FD9;&amp;#x4E00;&amp;#x7C7B;&amp;#x63A7;&amp;#x5236;socket&amp;#x5305;&amp;#x7684;&amp;#x6D41;&amp;#x5411;&amp;#xFF0C;&amp;#x786E;&amp;#x4FDD;&amp;#x53EA;&amp;#x6709;&amp;#x5408;&amp;#x6CD5;&amp;#x8FDB;&amp;#x7A0B;&amp;#x624D;&amp;#x80FD;&amp;#x8BBF;&amp;#x95EE;&amp;#x67D0;&amp;#x4E9B;&amp;#x7F51;&amp;#x7EDC;&amp;#x62A5;&amp;#x6587;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;NetLable/Labeled IPSec&amp;#xFF1A;&amp;#x8FD9;&amp;#x4E00;&amp;#x7C7B;&amp;#x8FD8;&amp;#x6CA1;&amp;#x770B;&amp;#xFF0C;&amp;#x7559;&amp;#x5F85;&amp;#x540E;&amp;#x9762;&amp;#x7EE7;&amp;#x7EED;&amp;#x5B66;&amp;#x4E60;&lt;br&gt;
&amp;#x672C;&amp;#x6587;&amp;#x5173;&amp;#x6CE8;&amp;#x7B2C;&amp;#x4E8C;&amp;#x79CD;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x6CD5;&amp;#xFF0C;&amp;#x5E76;&amp;#x7ED3;&amp;#x5408;iptables&amp;#xFF0C;&amp;#x7B80;&amp;#x8981;&amp;#x9610;&amp;#x8FF0;&amp;#x5176;&amp;#x5DE5;&amp;#x4F5C;&amp;#x539F;&amp;#x7406;&amp;#x548C;&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x6CD5;&amp;#x3002;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000; margin-top: 14px;&#34;&gt;iptables&amp;#x7B80;&amp;#x4ECB;&lt;/h1&gt;
&lt;blockquote style=&#34;line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;&#34;&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;&#34;&gt;&lt;strong style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700;&#34;&gt;from wiki&lt;/strong&gt;&lt;br&gt;
iptables is a user-space utility program that allows a system administrator to configure the IP packet filter rules of the Linux kernel firewall, implemented as different Netfilter modules. The filters are organized &lt;strong style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700;&#34;&gt;in different tables, which contain chains of rules&lt;/strong&gt; for how to treat network traffic packets. Different kernel modules and programs are currently used for different protocols; iptables applies to IPv4, ip6tables to IPv6, arptables to ARP, and ebtables to Ethernet frames.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;iptables&amp;#x5176;&amp;#x5B9E;&amp;#x5C31;&amp;#x662F;Linux&amp;#x7684;&amp;#x9632;&amp;#x706B;&amp;#x5899;&amp;#xFF0C;&amp;#x7528;&amp;#x6237;&amp;#x901A;&amp;#x8FC7;&amp;#x914D;&amp;#x7F6E;&amp;#x5404;&amp;#x79CD;&amp;#x89C4;&amp;#x5219;&amp;#x6765;&amp;#x5B9E;&amp;#x73B0;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x7684;&amp;#x8FC7;&amp;#x6EE4;&amp;#x3002;&amp;#x4ED6;&amp;#x5229;&amp;#x7528;&amp;#x4E86;Linux&amp;#x7684;Netfilter&amp;#x6846;&amp;#x67B6;&amp;#x7684;hook&amp;#x70B9;&amp;#x5BF9;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x8FDB;&amp;#x884C;&amp;#x5224;&amp;#x65AD;&amp;#xFF0C;&amp;#x5E76;&amp;#x6267;&amp;#x884C;action&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&lt;/p&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;iptables -A INPUT -s 10.10.10.10 -j DROP # &amp;#x6765;&amp;#x81EA;10.10.10.10&amp;#x7684;packet&amp;#x5168;&amp;#x90E8;&amp;#x88AB;&amp;#x4E22;&amp;#x5F03;
iptables -A INPUT -s 10.10.10.0/24 -j DROP # &amp;#x6765;&amp;#x81EA;10.10.10.0/255.255.255.0&amp;#xFF08;24&amp;#x8868;&amp;#x793A;&amp;#x63A9;&amp;#x7801;&amp;#x4F4D;&amp;#x6570;&amp;#xFF09;&amp;#x7684;packet&amp;#x5168;&amp;#x90E8;&amp;#x88AB;&amp;#x4E22;&amp;#x5F03;
&lt;/code&gt;&lt;/pre&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;iptables&amp;#x652F;&amp;#x6301;&amp;#x7684;&amp;#x89C4;&amp;#x5219;&amp;#x5F88;&amp;#x591A;&amp;#xFF0C;&amp;#x5177;&amp;#x4F53;&amp;#x53EF;&amp;#x4EE5;&amp;#x53C2;&amp;#x8003;&lt;a href=&#34;https://linux.die.net/man/8/iptables&#34; style=&#34;line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;&#34;&gt;iptables(8) - Linux man page&lt;/a&gt;&amp;#x3002;&lt;/p&gt;
&lt;h2 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;&#34;&gt;table &amp;amp; chain&lt;/h2&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x5982;wiki page&amp;#x6240;&amp;#x8FF0;&amp;#xFF0C;iptables&amp;#x901A;&amp;#x8FC7;&amp;#x5404;&amp;#x79CD;tables&amp;#x548C;chains&amp;#x6765;&amp;#x7BA1;&amp;#x7406;&amp;#x6240;&amp;#x6709;rules&amp;#x3002;&amp;#x5176;&amp;#x5B9E;chain&amp;#x5C31;&amp;#x662F;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E86;netfilter&amp;#x7684;hook&amp;#x70B9;&amp;#x3002;netfilter&amp;#x7684;hook&amp;#x70B9;&amp;#x6709;&amp;#xFF1A;&lt;/p&gt;
&lt;blockquote style=&#34;line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;&#34;&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0;&#34;&gt;The following hooks represent various well-defined points in the networking stack:&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-bottom: 0;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;NF_IP_PRE_ROUTING: This hook will be triggered by any incoming traffic very soon after entering the network stack. This hook is processed before any routing decisions have been made regarding where to send the packet.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;NF_IP_LOCAL_IN: This hook is triggered after an incoming packet has been routed if the packet is destined for the local system.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;NF_IP_FORWARD: This hook is triggered after an incoming packet has been routed if the packet is to be forwarded to another host.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;NF_IP_LOCAL_OUT: This hook is triggered by any locally created outbound traffic as soon it hits the network stack.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;NF_IP_POST_ROUTING: This hook is triggered by any outgoing or forwarded traffic after routing has taken place and just before being put out on the wire.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x800C;chain&amp;#x5C31;&amp;#x662F;&amp;#x548C;&amp;#x8FD9;&amp;#x4E9B;hook&amp;#x70B9;&amp;#x4E00;&amp;#x4E00;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#xFF0C;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&lt;/p&gt;
&lt;blockquote style=&#34;line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;&#34;&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;PREROUTING: Triggered by the NF_IP_PRE_ROUTING hook.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;INPUT: Triggered by the NF_IP_LOCAL_IN hook.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;FORWARD: Triggered by the NF_IP_FORWARD hook.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;OUTPUT: Triggered by the NF_IP_LOCAL_OUT hook.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;POSTROUTING: Triggered by the NF_IP_POST_ROUTING hook.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x800C;iptables&amp;#x53C8;&amp;#x662F;&amp;#x600E;&amp;#x4E48;&amp;#x904D;&amp;#x5386;&amp;#x8FD9;&amp;#x4E9B;table&amp;#x548C;chain&amp;#x7684;&amp;#x5462;&amp;#xFF1F;&lt;br&gt;
iptable&amp;#x5728;&amp;#x5404;&amp;#x4E2A;NetFilter&amp;#x7684;hook&amp;#x70B9;&amp;#x4E0A;&amp;#xFF0C;&amp;#x4F9D;&amp;#x6B21;&amp;#x904D;&amp;#x5386;&amp;#x5404;&amp;#x4E2A;table&amp;#x7684;&amp;#x5404;&amp;#x4E2A;chain&amp;#x3002;&amp;#x5176;&amp;#x987A;&amp;#x5E8F;&amp;#x6309;&amp;#x7167;&amp;#x5982;&amp;#x4E0B;&amp;#x8868;&amp;#x683C;&amp;#xFF1A;&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;chain&amp;#x4ECE;&amp;#x5DE6;&amp;#x5230;&amp;#x53F3;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;table&amp;#x4ECE;&amp;#x4E0A;&amp;#x5230;&amp;#x4E0B;&lt;/li&gt;
&lt;/ul&gt;
&lt;table style=&#34;margin: 2px 0 14px; color: #333; width: auto; border-collapse: collapse; box-sizing: border-box;&#34;&gt;&lt;thead style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;th style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;&#34;&gt;Tables&amp;#x2193;/Chains&amp;#x2192;&lt;/th&gt;&lt;th style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;&#34;&gt;PREROUTING&lt;/th&gt;&lt;th style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;&#34;&gt;INPUT&lt;/th&gt;&lt;th style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;&#34;&gt;FORWARD&lt;/th&gt;&lt;th style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;&#34;&gt;OUTPUT&lt;/th&gt;&lt;th style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #72777b; border-top: 0; background-color: #7b8184; font-weight: 300; color: #fff; padding-top: 6px;&#34;&gt;POSTROUTING&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;(routing decision)&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;raw&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;(connection tracking enabled)&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;mangle&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;nat (DNAT)&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;(routing decision)&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;filter&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;security&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;nat (SNAT)&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&lt;/td&gt;&lt;td style=&#34;line-height: 160%; box-sizing: content-box;  padding: 5px 14px 5px 12px; border: 1px solid #eaeaea;&#34;&gt;&amp;#x2713;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x6BCF;&amp;#x4E2A;chain&amp;#x548C;table&amp;#x5728;&amp;#x6574;&amp;#x4E2A;&amp;#x534F;&amp;#x8BAE;&amp;#x6808;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#x3002;&lt;/p&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;
        &lt;img class=&#34;enMedia&#34; src=&#34;/images/iptables + SELinux&amp;#x63A7;&amp;#x5236;socket packet/1610627406664&#34; hash=&#34;fcbd15b235c892be235e74cb0e2f537f&#34; align alt longdesc width=&#34;1627&#34; height=&#34;483&#34; border hspace vspace usemap style title lang xml:lang dir&gt;
      &lt;/p&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x7528;&amp;#x6237;&amp;#x8FD8;&amp;#x53EF;&amp;#x4EE5;&amp;#x521B;&amp;#x5EFA;&amp;#x81EA;&amp;#x5DF1;&amp;#x7684;chain&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x547D;&amp;#x4EE4;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;iptables -N &amp;lt;chain name&amp;gt;&lt;/code&gt;&amp;#x3002;&amp;#x7136;&amp;#x540E;&amp;#x4F7F;&amp;#x7528;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;-j&lt;/code&gt;&amp;#x53C2;&amp;#x6570;&amp;#x8DF3;&amp;#x8F6C;&amp;#xFF0C;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;iptables -A INPUT -p tcp -j tcp_packets&lt;/code&gt;&lt;/p&gt;
&lt;blockquote style=&#34;line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;&#34;&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;&#34;&gt;When/If we reach the end of that chain, we get dropped back to the INPUT chain and the packet starts traversing from the rule one step below where it jumped to the other chain (tcp_packets in this case). If a packet is ACCEPTed within one of the sub chains, it will be ACCEPT&amp;#x2019;ed in the superset chain also and it will not traverse any of the superset chains any further. However, do note that the packet will traverse all other chains in the other tables in a normal fashion.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x603B;&amp;#x7ED3;&amp;#x4E00;&amp;#x4E0B;&amp;#xFF1A;&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x5982;&amp;#x679C;&amp;#x81EA;&amp;#x5B9A;&amp;#x4E49;chain&amp;#x904D;&amp;#x5386;&amp;#x7ED3;&amp;#x675F;&amp;#xFF0C;&amp;#x5219;&amp;#x56DE;&amp;#x5230;&amp;#x539F;&amp;#x5148;&amp;#x8DF3;&amp;#x51FA;&amp;#x7684;chain&amp;#xFF08;super chain&amp;#xFF09;&amp;#xFF0C;&amp;#x7EE7;&amp;#x7EED;&amp;#x904D;&amp;#x5386;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x5982;&amp;#x679C;&amp;#x5B50;&amp;#x94FE;&amp;#xFF08;sub chain&amp;#xFF09;&amp;#x4E2D;&amp;#x6709;ACCEPT&amp;#xFF0C;&amp;#x5219;&amp;#x7236;&amp;#x94FE;&amp;#x4E2D;&amp;#x7684;&amp;#x89C4;&amp;#x5219;&amp;#x4E0D;&amp;#x4F1A;&amp;#x518D;&amp;#x88AB;&amp;#x7EE7;&amp;#x7EED;&amp;#x904D;&amp;#x5386;&amp;#xFF0C;&amp;#x4F46;&amp;#x4ECD;&amp;#x7136;&amp;#x4F1A;&amp;#x7EE7;&amp;#x7EED;&amp;#x904D;&amp;#x5386;&amp;#x5176;&amp;#x4ED6;chain&amp;#x4E2D;&amp;#x7684;&amp;#x89C4;&amp;#x5219;&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x5176;&amp;#x4ED6;table&amp;#x4E2D;&amp;#x7684;&amp;#x89C4;&amp;#x5219;&amp;#x3002;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x5982;&amp;#x679C;&amp;#x5728;&amp;#x4EFB;&amp;#x610F;&amp;#x4F4D;&amp;#x7F6E;&amp;#xFF0C;packet&amp;#x88AB;DROP&amp;#xFF0C;&amp;#x5219;&amp;#x540E;&amp;#x7EED;&amp;#x7684;chain&amp;#x548C;table&amp;#x90FD;&amp;#x4E0D;&amp;#x4F1A;&amp;#x88AB;&amp;#x6267;&amp;#x884C;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;&#34;&gt;target&lt;/h2&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;-j&lt;/code&gt;&amp;#x9664;&amp;#x4E86;&amp;#x6307;&amp;#x5B9A;&amp;#x81EA;&amp;#x5B9A;&amp;#x4E49;chain&amp;#x5916;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x66F4;&amp;#x91CD;&amp;#x8981;&amp;#x7684;&amp;#x7528;&amp;#x9014;&amp;#x5C31;&amp;#x662F;&amp;#x6307;&amp;#x5B9A;packet&amp;#x7684;&amp;#x76EE;&amp;#x7684;&amp;#x5730;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;target&amp;#x3002;&lt;/p&gt;
&lt;blockquote style=&#34;line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;&#34;&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;&#34;&gt;Targets on the other hand specify an action to take on the packet in question. We could for example, DROP or ACCEPT the packet depending on what we want to do. There are also a number of other actions we may want to take.&lt;br&gt;
For example: ACCEPT, DROP, CONNMARK, CLASSIFY, LOG ...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;Some targets will cause the packet to stop traversing that speci&amp;#xFB01;c chain and superior chains as described above. ex. ACCEPT, DROP&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;Other targets, may take an action on the packet, after which the packet will continue passing through the rest of the rules. ex. LOG, ULOG, TOS&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;Some targets will accept extra options (What TOS value to use etc), while others don&amp;#x2019;t necessarily need any options.&lt;/li&gt;
&lt;/ul&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&lt;strong style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700;&#34;&gt;&amp;#x6CE8;&lt;/strong&gt;&amp;#xFF1A;&amp;#x4EE5;&amp;#x4E0A;&amp;#x6458;&amp;#x81EA;[5],&amp;#x65F6;&amp;#x95F4;&amp;#x6709;&amp;#x70B9;&amp;#x4E45;&amp;#xFF0C;&amp;#x53EF;&amp;#x80FD;&amp;#x6709;&amp;#x4E9B;&amp;#x5DF2;&amp;#x7ECF;&amp;#x4E0D;&amp;#x6210;&amp;#x7ACB;&amp;#x4E86;&amp;#xFF08;&amp;#x4F8B;&amp;#x5982;[5]&amp;#x4E2D;&amp;#x901A;&amp;#x7BC7;&amp;#x672A;&amp;#x63D0;&amp;#x5230;security table)&amp;#xFF0C;&amp;#x4F46;&amp;#x57FA;&amp;#x672C;&amp;#x601D;&amp;#x8DEF;&amp;#x5E94;&amp;#x8BE5;&amp;#x662F;&amp;#x4FDD;&amp;#x6301;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
&lt;h1 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000;&#34;&gt;SECMARK&lt;/h1&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x4E0A;&amp;#x4E00;&amp;#x7AE0;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;iptables&amp;#x7684;&amp;#x57FA;&amp;#x672C;&amp;#x5DE5;&amp;#x4F5C;&amp;#x539F;&amp;#x7406;&amp;#xFF0C;&amp;#x548C;table/chain&amp;#x7684;&amp;#x904D;&amp;#x5386;&amp;#x65B9;&amp;#x6CD5;&amp;#x3002;&amp;#x800C;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E0E;SELinux&amp;#x8054;&amp;#x52A8;&amp;#xFF0C;&amp;#x5E76;&amp;#x63D0;&amp;#x4F9B;&amp;#x57FA;&amp;#x4E8E;socket packet&amp;#x7684;MAC&amp;#x673A;&amp;#x5236;&amp;#x7684;&amp;#x662F;iptables&amp;#x7684;security&amp;#x8868;&amp;#x683C;&amp;#x3002;&amp;#x4ECE;&amp;#x4E0A;&amp;#x9762;&amp;#x8868;&amp;#x683C;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;&amp;#xFF0C;security table&amp;#x53EA;&amp;#x6709;3&amp;#x4E2A;chain&amp;#xFF0C;&amp;#x5373;&amp;#xFF1A;INPUT&amp;#xFF0C;FORWARD&amp;#xFF0C;OUTPUT&amp;#x3002;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E86;&amp;#x8F93;&amp;#x5165;&amp;#xFF0C;&amp;#x8F93;&amp;#x51FA;&amp;#x4EE5;&amp;#x53CA;&amp;#x8F6C;&amp;#x53D1;3&amp;#x79CD;&amp;#x6570;&amp;#x636E;&amp;#x6D41;&amp;#x3002;&amp;#x53EF;&amp;#x4EE5;&amp;#x6EE1;&amp;#x8DB3;&amp;#x57FA;&amp;#x672C;&amp;#x7684;packet&amp;#x5F3A;&amp;#x5236;&amp;#x8BBF;&amp;#x95EE;&amp;#x63A7;&amp;#x5236;&amp;#x9700;&amp;#x6C42;&amp;#x3002;&lt;br&gt;
&amp;#x4E00;&amp;#x6761;SECMARK&amp;#x76F8;&amp;#x5173;&amp;#x7684;iptables&amp;#x8BED;&amp;#x53E5;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;/p&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;iptables -t security -A INPUT -i lo -p tcp --dport 9999 -j SECMARK --selctx system_u:object_r:ext_gateway_packet_t:s0
&lt;/code&gt;&lt;/pre&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x5176;&amp;#x4E2D;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;iptables -t security -A INPUT&lt;/code&gt;&amp;#x8868;&amp;#x793A;&amp;#x5F80;security table&amp;#x7684;INPUT chain&amp;#x63D2;&amp;#x5165;&amp;#x4E00;&amp;#x6761;&amp;#x89C4;&amp;#x5219;&amp;#xFF0C;match&amp;#x90E8;&amp;#x5206;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;-i lo -p tcp --dport 9999&lt;/code&gt;&amp;#x8868;&amp;#x793A;&amp;#x5339;&amp;#x914D;&amp;#x6765;&amp;#x81EA;lo&amp;#x7F51;&amp;#x5361;&amp;#xFF0C;&amp;#x534F;&amp;#x8BAE;&amp;#x4E3A;tcp&amp;#x7684;&amp;#x62A5;&amp;#x6587;&amp;#xFF0C;&amp;#x76EE;&amp;#x6807;&amp;#x7AEF;&amp;#x53E3;&amp;#x4E3A;9999&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x88AB;SECMARK&amp;#x76EE;&amp;#x6807;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#x3002;SECMARK&amp;#x76EE;&amp;#x6807;&amp;#x4F7F;&amp;#x7528;--selctx&amp;#x53C2;&amp;#x6570;&amp;#x4E3A;&amp;#x8BE5;&amp;#x7C7B;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x6253;&amp;#x4E0A;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;system_u:object_r:ext_gateway_packet_t:s0&lt;/code&gt;&amp;#x7684;&amp;#x5B89;&amp;#x5168;&amp;#x4E0A;&amp;#x4E0B;&amp;#x6587;&amp;#x3002;&amp;#x5219;SELinux&amp;#x7684;&amp;#x7B56;&amp;#x7565;&amp;#x8BED;&amp;#x6CD5;&amp;#x5373;&amp;#x53EF;&amp;#x4EE5;&amp;#x9488;&amp;#x5BF9;&amp;#x8BE5;&amp;#x7C7B;packet&amp;#x8FDB;&amp;#x884C;&amp;#x6743;&amp;#x9650;&amp;#x5224;&amp;#x65AD;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;:&lt;/p&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;allow ext_gateway_t ext_gateway_packet_t : packet &amp;#123; send recv &amp;#125;;
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000;&#34;&gt;CONNSECMARK&lt;/h1&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;CONNSECMARK&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x662F;SECMARK&amp;#x7684;&amp;#x6269;&amp;#x5C55;&amp;#x3002;&amp;#x4ECE;&amp;#x540D;&amp;#x5B57;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x51FA;CONNSECMARK&amp;#x662F;&amp;#x9488;&amp;#x5BF9;&amp;#x8FDE;&amp;#x63A5;&amp;#xFF08;connection&amp;#xFF09;&amp;#x8FDB;&amp;#x884C;mark&amp;#x52A8;&amp;#x4F5C;&amp;#x3002;iptables&amp;#x7684;&amp;#x8FDE;&amp;#x63A5;&amp;#x7BA1;&amp;#x7406;&amp;#x57FA;&amp;#x4E8E;NetFilter&amp;#x7684;conntrack&amp;#x3002;conntrack&amp;#x662F;&amp;#x5185;&amp;#x6838;&amp;#x6A21;&amp;#x5757;&amp;#xFF0C;&amp;#x9488;&amp;#x5BF9;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x534F;&amp;#x8BAE;&amp;#x7C7B;&amp;#x578B;&amp;#xFF0C;&amp;#x5177;&amp;#x6709;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x8FDE;&amp;#x63A5;&amp;#x63A7;&amp;#x5236;&amp;#x7BA1;&amp;#x7406;&amp;#x3002;&amp;#x8FD9;&amp;#x5DF2;&amp;#x7ECF;&amp;#x8D85;&amp;#x51FA;&amp;#x672C;&amp;#x6587;&amp;#x7684;&amp;#x8303;&amp;#x56F4;&amp;#x4E86;&amp;#x3002;&amp;#x4F46;&amp;#x4E0D;&amp;#x7BA1;conntrack&amp;#x591A;&amp;#x4E48;&amp;#x590D;&amp;#x6742;&amp;#xFF0C;&amp;#x529F;&amp;#x80FD;&amp;#x591A;&amp;#x4E48;&amp;#x5F3A;&amp;#x5927;&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x5230;iptables&amp;#x7684;&amp;#x72B6;&amp;#x6001;&amp;#x53EA;&amp;#x6709;4&amp;#x4E2A;&amp;#xFF0C;&amp;#x5373;NEW, EATABLISHED, RELATED, INVALID&amp;#x3002;&amp;#x6240;&amp;#x6709;&amp;#x7684;socket packet&amp;#x90FD;&amp;#x88AB;&amp;#x6620;&amp;#x5C04;&amp;#x5230;&amp;#x8FD9;4&amp;#x6B4C;&amp;#x72B6;&amp;#x6001;&amp;#x3002;&amp;#x5177;&amp;#x4F53;&amp;#x53EF;&amp;#x4EE5;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;[5]&amp;#x7684;Chapter 7. The state machine&amp;#x7684;User-land states&amp;#x3002;&lt;/p&gt;
&lt;blockquote style=&#34;line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;&#34;&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;NEW: tells us that the packet is the &amp;#xFB01;rst packet that we see.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;ESTABLISHED: The only requirement to get into an ESTABLISHED state is that one host sends a packet, and that it later on gets a reply from the other host.&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;RELATED: The ESTABLISHED connection will then spawn a connection outside of the main connection. The newly spawned connection will then be considered RELATED, if the conntrack module is able to understand that it is RELATED.&lt;br&gt;
INVALID: The INVALID state means that the packet can&amp;#x2019;t be identi&amp;#xFB01;ed or that it does not have any state.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x6709;&amp;#x4E86;&amp;#x8FD9;&amp;#x72B6;&amp;#x6001;&amp;#x5B9A;&amp;#x4E49;&amp;#xFF0C;iptables&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;--state maches&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT&lt;/code&gt;&amp;#x5B9A;&amp;#x4E49;&amp;#x4E86;&amp;#x89C4;&amp;#x5219;&amp;#xFF0C;&amp;#x5904;&amp;#x4E8E;ESTABLISHED, RELATED&amp;#x72B6;&amp;#x6001;&amp;#x7684;packet&amp;#x624D;&amp;#x88AB;ACCEPT&amp;#x3002;&lt;br&gt;
iptables&amp;#x4E0E;SELinux&amp;#x914D;&amp;#x5408;&amp;#x5B8C;&amp;#x5168;&amp;#x57FA;&amp;#x4E8E;&amp;#x5BF9;socket packet&amp;#x8FDB;&amp;#x884C;&amp;#x8FC7;&amp;#x6EE4;&amp;#x3002;&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;allow&amp;#x89C4;&amp;#x5219;&amp;#xFF0C;&amp;#x6216;SELinux object&amp;#x662F;&amp;#x9488;&amp;#x5BF9;&amp;#x7F51;&amp;#x7EDC;&amp;#x8FDE;&amp;#x63A5;&amp;#x7684;&amp;#x3002;&amp;#x6240;&amp;#x4EE5;&amp;#xFF0C;iptables&amp;#x53EF;&amp;#x4EE5;&amp;#x901A;&amp;#x8FC7;&amp;#x914D;&amp;#x5408;state match&amp;#x4EE5;&amp;#x53CA;CONNSECMARK&amp;#x4E3A;&amp;#x6765;&amp;#x81EA;&amp;#x4E8E;&amp;#x67D0;&amp;#x4E2A;&amp;#x8FDE;&amp;#x63A5;&amp;#x7684;packet&amp;#x8FDB;&amp;#x884C;&amp;#x6253;&amp;#x6807;&amp;#x7B7E;&amp;#x3002;&amp;#x65B9;&amp;#x6CD5;&amp;#x5C31;&amp;#x662F;--save&amp;#x548C;--restore&amp;#x53C2;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; color: #333; margin: 0;&#34;&gt;--save&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;Example: &lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;iptables -t mangle -A PREROUTING -p tcp --dport 80 -j CONNSECMARK --save&lt;/code&gt;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;Explanation: Save the security context mark from the packet to the connection if the connection is not marked since before.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; color: #333; margin: 0;&#34;&gt;--restore&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;Example: &lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;iptables -t mangle -A PREROUTING -p tcp --dport 80 -j CONNSECMARK --restore&lt;/code&gt;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;Explanation: If the packet has no security context mark set on it, the --restore option will set the security context mark associated with the connection on the packet.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x603B;&amp;#x7ED3;&amp;#x4E00;&amp;#x4E0B;&amp;#x5C31;&amp;#x662F;&amp;#xFF1A;&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;--save&amp;#x5C06;packet&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x7684;context&amp;#x8D4B;&amp;#x4E88;&amp;#x8FDE;&amp;#x63A5;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;--restore&amp;#x5C06;&amp;#x8FDE;&amp;#x63A5;&amp;#x7684;context&amp;#x8D4B;&amp;#x4E88;packet&lt;br&gt;
&amp;#x6B64;&amp;#x65F6;SELinux&amp;#x5177;&amp;#x5907;&amp;#x66F4;&amp;#x4E30;&amp;#x5BCC;&amp;#x7684;&amp;#x4E0A;&amp;#x4E0B;&amp;#x6587;&amp;#xFF0C;&amp;#x6765;&amp;#x5BF9;socket packet&amp;#x8FDB;&amp;#x884C;&amp;#x5F3A;&amp;#x5236;&amp;#x8BBF;&amp;#x95EE;&amp;#x63A7;&amp;#x5236;&amp;#x3002;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000;&#34;&gt;Gateway&amp;#x5B9E;&amp;#x9A8C;&lt;/h1&gt;
&lt;h2 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;&#34;&gt;&amp;#x7B80;&amp;#x4ECB;&lt;/h2&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x6587;&amp;#x732E;[2]&amp;#x7684;2.2&amp;#x7AE0;&amp;#x8282;&amp;#x4E2D;&amp;#x63D0;&amp;#x4F9B;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x5F88;&amp;#x597D;&amp;#x7684;&amp;#x7EC3;&amp;#x4E60;&amp;#xFF0C;&amp;#x5E26;&amp;#x6211;&amp;#x4EEC;&amp;#x8BA4;&amp;#x8BC6;iptables&amp;#x4E0E;SELinux&amp;#x914D;&amp;#x5408;&amp;#x505A;socket packet&amp;#x5F3A;&amp;#x5236;&amp;#x8BBF;&amp;#x95EE;&amp;#x63A7;&amp;#x5236;&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x3002;&amp;#x8BE5;&amp;#x65B9;&amp;#x6CD5;&amp;#x901A;&amp;#x8FC7;iptables&amp;#x548C;SELinux&amp;#x5B9E;&amp;#x73B0;&amp;#x5BA2;&amp;#x6237;&amp;#x7AEF;&amp;#x548C;&amp;#x670D;&amp;#x52A1;&amp;#x7AEF;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x8FC7;&amp;#x6EE4;&amp;#x3002;&amp;#x6574;&amp;#x4E2A;&amp;#x6D4B;&amp;#x8BD5;&amp;#x6846;&amp;#x67B6;&amp;#x793A;&amp;#x610F;&amp;#x56FE;&amp;#x5982;&amp;#x4E0B;&amp;#x6240;&amp;#x793A;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;client&amp;#x548C;secure_client&amp;#x4F7F;&amp;#x7528;&amp;#x540C;&amp;#x4E00;&amp;#x4EFD;&amp;#x6E90;&amp;#x7801;&amp;#x7F16;&amp;#x8BD1;&amp;#xFF0C;&amp;#x53EA;&amp;#x662F;file context&amp;#x6709;&amp;#x6240;&amp;#x4E0D;&amp;#x540C;&amp;#xFF0C;server&amp;#x548C;secure_server&amp;#x540C;&amp;#x7406;&amp;#x3002;&lt;br&gt;

        &lt;img class=&#34;enMedia&#34; src=&#34;/images/iptables + SELinux&amp;#x63A7;&amp;#x5236;socket packet/1610627406668&#34; hash=&#34;afd271fe524baadc38c595d0b74f9fae&#34; align alt longdesc width=&#34;1264&#34; height=&#34;760&#34; border hspace vspace usemap style title lang xml:lang dir&gt;
      &lt;/p&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x793A;&amp;#x4F8B;&amp;#x4EE3;&amp;#x7801;&amp;#x901A;&amp;#x8FC7;&amp;#x5B9A;&amp;#x4E49;&amp;#x53EF;&amp;#x6267;&amp;#x884C;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x5B89;&amp;#x5168;&amp;#x4E0A;&amp;#x4E0B;&amp;#x6587;&amp;#xFF08;&amp;#x5982;&amp;#x4E0B;&amp;#x6240;&amp;#x793A;&amp;#xFF09;&amp;#xFF0C;&amp;#x548C;type_transition&amp;#x89C4;&amp;#x5219;&amp;#xFF0C;&amp;#x4F7F;&amp;#x5F97;secure_*&amp;#x8FDB;&amp;#x7A0B;&amp;#x5DE5;&amp;#x4F5C;&amp;#x5728;ext_gateway_t domain&amp;#xFF0C;&amp;#x800C;&amp;#x975E;secure&amp;#x8FDB;&amp;#x7A0B;&amp;#x5DE5;&amp;#x4F5C;&amp;#x5728;unconfined_t domain&amp;#x3002;&amp;#x5404;&amp;#x53EF;&amp;#x6267;&amp;#x884C;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x5B89;&amp;#x5168;&amp;#x4E0A;&amp;#x4E0B;&amp;#x6587;&amp;#x5982;&amp;#x4E0B;&amp;#x6240;&amp;#x793A;&amp;#xFF1A;&lt;/p&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;/usr/local/bin/secure_client system_u:object_r:secure_services_exec_t:s0
/usr/local/bin/secure_server system_u:object_r:secure_services_exec_t:s0
/usr/local/bin/client system_u:object_r:unconfined_t:s0
/usr/local/bin/server system_u:object_r:unconfined_t:s0
&lt;/code&gt;&lt;/pre&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x793A;&amp;#x4F8B;&amp;#x4EE3;&amp;#x7801;&amp;#x4E2D;&amp;#x7684;&amp;#x7B56;&amp;#x7565;&amp;#x96C6;&amp;#xFF08;.conf)&amp;#x6587;&amp;#x4EF6;&amp;#x5B9A;&amp;#x4E49;&amp;#x4E86;&amp;#x793A;&amp;#x610F;&amp;#x56FE;&amp;#x4E2D;4&amp;#x4E2A;&amp;#x65B9;&amp;#x5411;&amp;#x6570;&amp;#x636E;&amp;#x6D41;&amp;#x7684;&amp;#x6743;&amp;#x9650;&amp;#xFF0C;&amp;#x5305;&amp;#x62EC;&amp;#xFF1A;&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x5141;&amp;#x8BB8;&amp;#x8BBF;&amp;#x95EE;&amp;#x672A;&amp;#x6807;&amp;#x8BB0;&amp;#x7AEF;&amp;#x53E3;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x6D41;(default_secmark_packet_t)&amp;#xFF1A;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;auditallow unconfined_t default_secmark_packet_t : packet &amp;#123; send recv &amp;#125;;&lt;/code&gt;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x5141;&amp;#x8BB8;secure_*&amp;#x8FDB;&amp;#x7A0B;&amp;#x8BBF;&amp;#x95EE;&amp;#x6807;&amp;#x8BB0;&amp;#x4E86;&amp;#x7AEF;&amp;#x53E3;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x6D41;&amp;#xFF08;ext_gateway_packet_t&amp;#xFF09;&amp;#xFF1A;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;allow ext_gateway_t ext_gateway_packet_t : packet &amp;#123; send recv &amp;#125;;&lt;/code&gt;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x5141;&amp;#x8BB8;secure_*&amp;#x8FDB;&amp;#x7A0B;&amp;#x8BBF;&amp;#x95EE;&amp;#x65E0;SECMARK&amp;#x6807;&amp;#x8BB0;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x6D41;&amp;#xFF08;unconfined_t&amp;#xFF09;&amp;#xFF1A;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;allow ext_gateway_t unconfined_t : packet &amp;#123; recv send &amp;#125;;&lt;/code&gt;&lt;br&gt;
iptables_secmark&amp;#x4F7F;&amp;#x7528;&amp;#x82E5;&amp;#x5E72;iptables&amp;#x547D;&amp;#x4EE4;&amp;#xFF0C;&amp;#x5B9A;&amp;#x4E49;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x7684;&amp;#x6807;&amp;#x7B7E;&amp;#x89C4;&amp;#x5219;&amp;#xFF0C;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&lt;/li&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x6765;&amp;#x81EA;&amp;#x4E8E;lo&amp;#x7F51;&amp;#x5361;&amp;#x7684;&amp;#xFF0C;&amp;#x534F;&amp;#x8BAE;&amp;#x4E3A;tcp&amp;#xFF0C;&amp;#x76EE;&amp;#x6807;IP&amp;#x4E3A;127.0.0.0&amp;#xFF0C;&amp;#x63A9;&amp;#x7801;&amp;#x4E3A;255.0.0.0&amp;#x8F93;&amp;#x5165;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x88AB;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;default_secmark_packet_t&lt;/li&gt;
&lt;/ul&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;&lt;span style=&#34;color: #9b9b9b; line-height: 160%; box-sizing: content-box;&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt; This OUTPUT rule sets all packets to default_secmark_packet_t: as it is&lt;/span&gt;
iptables -t security -A INPUT -i lo -p tcp -d 127.0.0.0/8 -j SECMARK --selctx system_u:object_r:default_secmark_packet_t:s0
&lt;/code&gt;&lt;/pre&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x6765;&amp;#x81EA;&amp;#x4E8E;lo&amp;#x7F51;&amp;#x5361;&amp;#x7684;&amp;#xFF0C;&amp;#x534F;&amp;#x8BAE;&amp;#x4E3A;tcp&amp;#xFF0C;&amp;#x76EE;&amp;#x6807;/&amp;#x6E90;&amp;#x7AEF;&amp;#x53E3;&amp;#x4E3A;9999&amp;#x7684;&amp;#x8F93;&amp;#x5165;/&amp;#x8F93;&amp;#x51FA;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x88AB;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;ext_gateway_packet_t&amp;#xFF08;&amp;#x8282;&amp;#x9009;&amp;#xFF09;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;&lt;span style=&#34;color: #9b9b9b; line-height: 160%; box-sizing: content-box;&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;line-height: 160%; box-sizing: content-box;&#34;&gt; These rules will replace the above context with the internal or&lt;/span&gt;
iptables -t security -A INPUT -i lo -p tcp --dport 9999 -j SECMARK --selctx system_u:object_r:ext_gateway_packet_t:s0
iptables -t security -A OUTPUT -o lo -p tcp --sport 9999 -j SECMARK --selctx system_u:object_r:ext_gateway_packet_t:s0
&lt;/code&gt;&lt;/pre&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x4E24;&amp;#x7C7B;&amp;#x89C4;&amp;#x5219;&amp;#x5B9A;&amp;#x4E49;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x8303;&amp;#x56F4;&amp;#x5B9E;&amp;#x9645;&amp;#x662F;&amp;#x6709;&amp;#x91CD;&amp;#x53E0;&amp;#x7684;&amp;#xFF0C;&amp;#x6839;&amp;#x636E;&amp;#x6CE8;&amp;#x91CA;&amp;#x53EF;&amp;#x77E5;&amp;#xFF0C;&amp;#x5B9E;&amp;#x9645;&amp;#x4E24;&amp;#x8005;&amp;#x7684;&amp;#x5173;&amp;#x7CFB;&amp;#x662F;&amp;#xFF0C;general&amp;#x548C;&amp;#x7279;&amp;#x4F8B;&amp;#x7684;&amp;#x5173;&amp;#x7CFB;&amp;#x3002;&amp;#x5373;&amp;#x524D;&amp;#x8005;&amp;#x5C06;&amp;#x6240;&amp;#x6709;&amp;#x7279;&amp;#x5B9A;&amp;#x76EE;&amp;#x6807;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;default_secmark_packet_t&amp;#xFF0C;&amp;#x800C;&amp;#x540E;&amp;#x8005;&amp;#x5C06;&amp;#x6765;&amp;#x81EA;&amp;#x7279;&amp;#x5B9A;&amp;#x7AEF;&amp;#x53E3;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x6307;&amp;#x5B9A;&amp;#x4E3A;ext_gateway_packet_t&amp;#x3002;&lt;br&gt;
&amp;#x7ECF;&amp;#x8FC7;&amp;#x6B64;&amp;#x7C7B;&amp;#x7B56;&amp;#x7565;&amp;#x8BBE;&amp;#x7F6E;&amp;#xFF0C;client&amp;#x5728;&amp;#x8BBF;&amp;#x95EE;secure_server&amp;#x65F6;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x5305;&amp;#x5C31;&amp;#x4F1A;&amp;#x88AB;&amp;#x62E6;&amp;#x622A;&amp;#x3002;&amp;#x67E5;&amp;#x770B;/var/log/audit/audit.log:&lt;/p&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;type=AVC msg=audit(1602641071.967:3475): avc:  granted  &amp;#123; send &amp;#125; for  pid=0 comm=&amp;quot;swapper/0&amp;quot; saddr=127.0.0.1 src=9999 daddr=127.0.0.1 dest=47076 netif=lo scontext=unconfined_u:message_filter_r:ext_gateway_t:s0-s0:c0.c1023 tcontext=system_u:object_r:ext_gateway_packet_t:s0 tclass=packet

type=AVC msg=audit(1602641071.967:3476): avc:  denied  &amp;#123; recv &amp;#125; for  pid=10 comm=&amp;quot;ksoftirqd/0&amp;quot; saddr=127.0.0.1 src=9999 daddr=127.0.0.1 dest=47076 netif=lo scontext=unconfined_u:
unconfined_r:unconfined_t:s0-s0:c0.c1023 tcontext=system_u:object_r:ext_gateway_packet_t:s0 tclass=packet permissive=0
&lt;/code&gt;&lt;/pre&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;client&amp;#x8FDE;&amp;#x63A5;secure_server&amp;#x76D1;&amp;#x542C;&amp;#x7684;9999&amp;#x7AEF;&amp;#x53E3;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x6D41;&amp;#x4E3A;&amp;#xFF1A;tcp&amp;#xFF0C;127.0.0.1:9999 =&amp;gt; 127.0.0.1:47076&amp;#x3002;secure_server&amp;#x5411;client&amp;#x53D1;&amp;#x9001;&amp;#x6210;&amp;#x529F;&amp;#xFF0C;&amp;#x4F46;client&amp;#x63A5;&amp;#x6536;&amp;#x5931;&amp;#x8D25;&amp;#x3002;&amp;#x56E0;&amp;#x4E3A;client&amp;#x8FD0;&amp;#x884C;&amp;#x4E8E;unconfined_t&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;&amp;#x5BF9;&amp;#x5E94;ext_gateway_packet_t&amp;#x7684;recv&amp;#x6743;&amp;#x9650;&amp;#x3002;&lt;/p&gt;
&lt;h2 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;&#34;&gt;&amp;#x52D8;&amp;#x8BEF;&lt;/h2&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;[2]&amp;#x56E0;&amp;#x4E3A;&amp;#x6210;&amp;#x4E66;&amp;#x8FC7;&amp;#x4E45;&amp;#xFF08;&amp;#x5199;&amp;#x4E8E;2014&amp;#x5E74;&amp;#xFF0C;&amp;#x73B0;&amp;#x5728;2020&amp;#x5E74;&amp;#xFF09;&amp;#xFF0C;&amp;#x4E14;&amp;#x7EC3;&amp;#x4E60;&amp;#x57FA;&amp;#x4E8E;&amp;#x4E66;&amp;#x4E2D;&amp;#x524D;&amp;#x5BFC;&amp;#x7AE0;&amp;#x8282;&amp;#x4E2D;&amp;#x7684;modular-test&amp;#x7AE0;&amp;#x8282;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x76F4;&amp;#x63A5;&amp;#x8FD0;&amp;#x884C;&amp;#x4F1A;&amp;#x4EA7;&amp;#x751F;&amp;#x9519;&amp;#x8BEF;&amp;#x3002;&amp;#x9519;&amp;#x8BEF;&amp;#x4E3B;&amp;#x8981;&amp;#x5305;&amp;#x542B;&amp;#xFF1A;&lt;/p&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x57FA;&amp;#x4E8E;modular-test&amp;#x6784;&amp;#x5EFA;ext_gateway&amp;#x7B56;&amp;#x7565;&amp;#x3002;&amp;#x56E0;&amp;#x4E3A;&amp;#x53EF;&amp;#x80FD;&amp;#x662F;&amp;#x53D1;&amp;#x884C;&amp;#x7248;&amp;#x53D8;&amp;#x5316;&amp;#xFF08;&amp;#x7B14;&amp;#x8005;&amp;#x7528;&amp;#x7684;CentOS8&amp;#xFF09;&amp;#x6216;&amp;#x8005;&amp;#x65F6;&amp;#x95F4;&amp;#x8FC7;&amp;#x4E45;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x7528;&amp;#x4E66;&amp;#x4E2D;&amp;#x7684;&amp;#x57FA;&amp;#x7840;&amp;#x7B56;&amp;#x7565;&amp;#x4F1A;&amp;#x9020;&amp;#x6210;&amp;#x65E0;&amp;#x6CD5;&amp;#x5F00;&amp;#x673A;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;modular-test&amp;#x7EC3;&amp;#x4E60;&amp;#x4E2D;&amp;#x7684;&amp;#x7B56;&amp;#x7565;&amp;#x4E0D;&amp;#x53EF;&amp;#x7528;&amp;#x3002;&amp;#x89E3;&amp;#x51B3;&amp;#x65B9;&amp;#x6CD5;&amp;#x662F;&amp;#xFF0C;&amp;#x7F16;&amp;#x8BD1;ext_gateway module&amp;#xFF0C;&amp;#x5E76;&amp;#x7528;semodule&amp;#x63D2;&amp;#x5165;&amp;#x53D1;&amp;#x884C;&amp;#x7248;&amp;#x81EA;&amp;#x5E26;&amp;#x7684;&amp;#x7B56;&amp;#x7565;&amp;#x4E2D;&amp;#x3002;&amp;#x6B64;&amp;#x65F6;&amp;#x9700;&amp;#x8981;&amp;#x9488;&amp;#x5BF9;&amp;#x539F;&amp;#x751F;&amp;#x7B56;&amp;#x7565;&amp;#x8FDB;&amp;#x884C;&amp;#x9002;&amp;#x914D;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&amp;#x8FDB;&amp;#x7A0B;&amp;#x62C9;&amp;#x8D77;&amp;#x65F6;&amp;#x62A5;&amp;#x9519;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x589E;&amp;#x52A0;&amp;#x76F8;&amp;#x5E94;allow&amp;#x89C4;&amp;#x5219;&amp;#xFF0C;&amp;#x8282;&amp;#x9009;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;allow ext_gateway_t null_device_t : chr_file &amp;#123; read write open &amp;#125;;
allow ext_gateway_t ld_so_t : file &amp;#123; map read execute &amp;#125;;
allow ext_gateway_t ld_so_cache_t : file &amp;#123; open map read execute getattr &amp;#125;;
allow ext_gateway_t lib_t : file &amp;#123; open map read execute getattr &amp;#125;;
...
&lt;/code&gt;&lt;/pre&gt;
&lt;ul style=&#34;line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;&#34;&gt;
&lt;li style=&#34;line-height: 160%; box-sizing: content-box; position: relative;&#34;&gt;&amp;#x672C;&amp;#x4E66;&amp;#x7ED9;&amp;#x51FA;&amp;#x7684;&amp;#x793A;&amp;#x4F8B;&amp;#x4EE3;&amp;#x7801;&amp;#x7684;&amp;#x5B89;&amp;#x5168;&amp;#x4E0A;&amp;#x4E0B;&amp;#x6587;&amp;#x672A;&amp;#x7ED9;&amp;#x51FA;mls&amp;#x63CF;&amp;#x8FF0;&amp;#xFF0C;&amp;#x5728;&amp;#x7F16;&amp;#x8BD1;&amp;#x65F6;&amp;#x4F1A;&amp;#x62A5;&amp;#x9519;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;&#34;&gt;&lt;code style=&#34;display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;&#34;&gt;iptables -t security -A INPUT -i lo -p tcp --dport 9999 -j SECMARK --selctx system_u:object_r:ext_gateway_packet_t:s0
iptables -t security -A INPUT -i lo -p tcp --sport 9999 -j SECMARK --selctx system_u:object_r:ext_gateway_packet_t:s0
/usr/local/bin/secure_client system_u:object_r:secure_services_exec_t:s0
&lt;/code&gt;&lt;/pre&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;&amp;#x6240;&amp;#x6709;&amp;#x7684;context&amp;#x90FD;&amp;#x52A0;&amp;#x4E0A;&amp;#x4E86;&lt;code style=&#34;line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;&#34;&gt;:s0&lt;/code&gt;&amp;#x3002;&lt;br&gt;
&amp;#x7ECF;&amp;#x8FC7;&amp;#x9002;&amp;#x914D;&amp;#x540E;&amp;#xFF0C;&amp;#x4E66;&amp;#x4E2D;&amp;#x63D0;&amp;#x4F9B;&amp;#x7684;&amp;#x793A;&amp;#x4F8B;&amp;#x53EF;&amp;#x4EE5;&amp;#x987A;&amp;#x5229;&amp;#x8DD1;&amp;#x901A;&amp;#xFF0C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;
server&lt;br&gt;

        &lt;img class=&#34;enMedia&#34; src=&#34;/images/iptables + SELinux&amp;#x63A7;&amp;#x5236;socket packet/1610627406667&#34; hash=&#34;e19e063bd6c8c6ea612eab6441924451&#34; align alt longdesc width=&#34;1440&#34; height=&#34;526&#34; border hspace vspace usemap style title lang xml:lang dir&gt;
      &lt;/p&gt;
&lt;h1 style=&#34;line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000;&#34;&gt;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&lt;/h1&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;[1] &lt;a href=&#34;https://selinuxproject.org/page/NB_Networking&#34; style=&#34;line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;&#34;&gt;SELinux Networking Support&lt;/a&gt;&lt;/p&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;[2] &lt;a href=&#34;https://app.yinxiang.com/shard/s10/nl/161681/b51d0a9e-c5fc-48aa-8eb9-0b9bee14f832/&#34; style=&#34;line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;&#34;&gt;The SELinux Notebook - Building The Sample Policy&lt;/a&gt;&lt;/p&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;[3] &lt;a href=&#34;https://en.wikipedia.org/wiki/Iptables&#34; style=&#34;line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;&#34;&gt;iptables wiki page&lt;/a&gt;&lt;/p&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;[4] &lt;a href=&#34;https://www.digitalocean.com/community/tutorials/a-deep-dive-into-iptables-and-netfilter-architecture&#34; style=&#34;line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;&#34;&gt;A Deep Dive into Iptables and Netfilter Architecture&lt;/a&gt;&lt;/p&gt;
&lt;p style=&#34;line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;&#34;&gt;[5] Oskar Andreasson, 2001-2006, Iptables Tutorial 1.2.2&lt;/p&gt;
&lt;/div&gt;&lt;center style=&#34;display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden&#34;&gt;SELinux%E5%AF%B9socket%E7%9A%84%E6%8E%A7%E5%88%B6%E5%8C%85%E5%90%AB%E8%BF%99%E5%87%A0%E4%B8%AA%E6%96%B9%E9%9D%A2%EF%BC%9A%0A-%20context%E8%AF%AD%E6%B3%95%E4%B8%AD%E7%9A%84nodecon%2C%20portcon%2C%20netifcon%EF%BC%9A%E8%BF%99%E4%B8%80%E7%B1%BB%E6%8E%A7%E5%88%B6%E6%9C%AC%E7%AB%AF%E7%B3%BB%E7%BB%9F%E8%B5%84%E6%BA%90%EF%BC%8C%E7%A1%AE%E4%BF%9D%E5%90%88%E6%B3%95%E8%BF%9B%E7%A8%8B%E6%89%8D%E8%83%BD%E8%AE%BF%E9%97%AE%E6%9C%AC%E7%AB%AF%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90%0A-%20%E9%80%9A%E8%BF%87iptables%E5%B7%A5%E5%85%B7%E7%9A%84SECMARK%2FCONNSECMARK%E6%89%A9%E5%B1%95%E4%B8%BAsocket%20packet%E6%89%93%E4%B8%8A%E7%9A%84%E6%A0%87%E7%AD%BE%EF%BC%9A%E8%BF%99%E4%B8%80%E7%B1%BB%E6%8E%A7%E5%88%B6socket%E5%8C%85%E7%9A%84%E6%B5%81%E5%90%91%EF%BC%8C%E7%A1%AE%E4%BF%9D%E5%8F%AA%E6%9C%89%E5%90%88%E6%B3%95%E8%BF%9B%E7%A8%8B%E6%89%8D%E8%83%BD%E8%AE%BF%E9%97%AE%E6%9F%90%E4%BA%9B%E7%BD%91%E7%BB%9C%E6%8A%A5%E6%96%87%0A-%20NetLable%2FLabeled%20IPSec%EF%BC%9A%E8%BF%99%E4%B8%80%E7%B1%BB%E8%BF%98%E6%B2%A1%E7%9C%8B%EF%BC%8C%E7%95%99%E5%BE%85%E5%90%8E%E9%9D%A2%E7%BB%A7%E7%BB%AD%E5%AD%A6%E4%B9%A0%0A%E6%9C%AC%E6%96%87%E5%85%B3%E6%B3%A8%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95%EF%BC%8C%E5%B9%B6%E7%BB%93%E5%90%88iptables%EF%BC%8C%E7%AE%80%E8%A6%81%E9%98%90%E8%BF%B0%E5%85%B6%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E3%80%82%0A%23%20iptables%E7%AE%80%E4%BB%8B%0A%3E%20**from%20wiki**%0A%3E%20iptables%20is%20a%20user-space%20utility%20program%20that%20allows%20a%20system%20administrator%20to%20configure%20the%20IP%20packet%20filter%20rules%20of%20the%20Linux%20kernel%20firewall%2C%20implemented%20as%20different%20Netfilter%20modules.%20The%20filters%20are%20organized%20**in%20different%20tables%2C%20which%20contain%20chains%20of%20rules**%20for%20how%20to%20treat%20network%20traffic%20packets.%20Different%20kernel%20modules%20and%20programs%20are%20currently%20used%20for%20different%20protocols%3B%20iptables%20applies%20to%20IPv4%2C%20ip6tables%20to%20IPv6%2C%20arptables%20to%20ARP%2C%20and%20ebtables%20to%20Ethernet%20frames.%0A%0Aiptables%E5%85%B6%E5%AE%9E%E5%B0%B1%E6%98%AFLinux%E7%9A%84%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%8C%E7%94%A8%E6%88%B7%E9%80%9A%E8%BF%87%E9%85%8D%E7%BD%AE%E5%90%84%E7%A7%8D%E8%A7%84%E5%88%99%E6%9D%A5%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84%E8%BF%87%E6%BB%A4%E3%80%82%E4%BB%96%E5%88%A9%E7%94%A8%E4%BA%86Linux%E7%9A%84Netfilter%E6%A1%86%E6%9E%B6%E7%9A%84hook%E7%82%B9%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%9B%E8%A1%8C%E5%88%A4%E6%96%AD%EF%BC%8C%E5%B9%B6%E6%89%A7%E8%A1%8Caction%E3%80%82%E4%BE%8B%E5%A6%82%EF%BC%9A%0A%60%60%60shell%0Aiptables%20-A%20INPUT%20-s%2010.10.10.10%20-j%20DROP%20%23%20%E6%9D%A5%E8%87%AA10.10.10.10%E7%9A%84packet%E5%85%A8%E9%83%A8%E8%A2%AB%E4%B8%A2%E5%BC%83%0Aiptables%20-A%20INPUT%20-s%2010.10.10.0%2F24%20-j%20DROP%20%23%20%E6%9D%A5%E8%87%AA10.10.10.0%2F255.255.255.0%EF%BC%8824%E8%A1%A8%E7%A4%BA%E6%8E%A9%E7%A0%81%E4%BD%8D%E6%95%B0%EF%BC%89%E7%9A%84packet%E5%85%A8%E9%83%A8%E8%A2%AB%E4%B8%A2%E5%BC%83%0A%60%60%60%0Aiptables%E6%94%AF%E6%8C%81%E7%9A%84%E8%A7%84%E5%88%99%E5%BE%88%E5%A4%9A%EF%BC%8C%E5%85%B7%E4%BD%93%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%80%83%5Biptables(8)%20-%20Linux%20man%20page%5D(https%3A%2F%2Flinux.die.net%2Fman%2F8%2Fiptables)%E3%80%82%0A%0A%23%23%20table%20%26%20chain%0A%E5%A6%82wiki%20page%E6%89%80%E8%BF%B0%EF%BC%8Ciptables%E9%80%9A%E8%BF%87%E5%90%84%E7%A7%8Dtables%E5%92%8Cchains%E6%9D%A5%E7%AE%A1%E7%90%86%E6%89%80%E6%9C%89rules%E3%80%82%E5%85%B6%E5%AE%9Echain%E5%B0%B1%E6%98%AF%E5%AF%B9%E5%BA%94%E4%BA%86netfilter%E7%9A%84hook%E7%82%B9%E3%80%82netfilter%E7%9A%84hook%E7%82%B9%E6%9C%89%EF%BC%9A%0A%3E%20The%20following%20hooks%20represent%20various%20well-defined%20points%20in%20the%20networking%20stack%3A%0A%3E%0A%3E-%20NF_IP_PRE_ROUTING%3A%20This%20hook%20will%20be%20triggered%20by%20any%20incoming%20traffic%20very%20soon%20after%20entering%20the%20network%20stack.%20This%20hook%20is%20processed%20before%20any%20routing%20decisions%20have%20been%20made%20regarding%20where%20to%20send%20the%20packet.%0A%3E-%20NF_IP_LOCAL_IN%3A%20This%20hook%20is%20triggered%20after%20an%20incoming%20packet%20has%20been%20routed%20if%20the%20packet%20is%20destined%20for%20the%20local%20system.%0A%3E-%20NF_IP_FORWARD%3A%20This%20hook%20is%20triggered%20after%20an%20incoming%20packet%20has%20been%20routed%20if%20the%20packet%20is%20to%20be%20forwarded%20to%20another%20host.%0A%3E-%20NF_IP_LOCAL_OUT%3A%20This%20hook%20is%20triggered%20by%20any%20locally%20created%20outbound%20traffic%20as%20soon%20it%20hits%20the%20network%20stack.%0A%3E-%20NF_IP_POST_ROUTING%3A%20This%20hook%20is%20triggered%20by%20any%20outgoing%20or%20forwarded%20traffic%20after%20routing%20has%20taken%20place%20and%20just%20before%20being%20put%20out%20on%20the%20wire.%0A%0A%E8%80%8Cchain%E5%B0%B1%E6%98%AF%E5%92%8C%E8%BF%99%E4%BA%9Bhook%E7%82%B9%E4%B8%80%E4%B8%80%E5%AF%B9%E5%BA%94%E7%9A%84%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%0A%3E%20-%20PREROUTING%3A%20Triggered%20by%20the%20NF_IP_PRE_ROUTING%20hook.%0A%3E-%20INPUT%3A%20Triggered%20by%20the%20NF_IP_LOCAL_IN%20hook.%0A%3E-%20FORWARD%3A%20Triggered%20by%20the%20NF_IP_FORWARD%20hook.%0A%3E-%20OUTPUT%3A%20Triggered%20by%20the%20NF_IP_LOCAL_OUT%20hook.%0A%3E-%20POSTROUTING%3A%20Triggered%20by%20the%20NF_IP_POST_ROUTING%20hook.%0A%0A%E8%80%8Ciptables%E5%8F%88%E6%98%AF%E6%80%8E%E4%B9%88%E9%81%8D%E5%8E%86%E8%BF%99%E4%BA%9Btable%E5%92%8Cchain%E7%9A%84%E5%91%A2%EF%BC%9F%0Aiptable%E5%9C%A8%E5%90%84%E4%B8%AANetFilter%E7%9A%84hook%E7%82%B9%E4%B8%8A%EF%BC%8C%E4%BE%9D%E6%AC%A1%E9%81%8D%E5%8E%86%E5%90%84%E4%B8%AAtable%E7%9A%84%E5%90%84%E4%B8%AAchain%E3%80%82%E5%85%B6%E9%A1%BA%E5%BA%8F%E6%8C%89%E7%85%A7%E5%A6%82%E4%B8%8B%E8%A1%A8%E6%A0%BC%EF%BC%9A%0A-%20chain%E4%BB%8E%E5%B7%A6%E5%88%B0%E5%8F%B3%0A-%20table%E4%BB%8E%E4%B8%8A%E5%88%B0%E4%B8%8B%0A%0A%7C%20Tables%E2%86%93%2FChains%E2%86%92%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20PREROUTING%20%7C%20INPUT%20%7C%20FORWARD%20%7C%20OUTPUT%20%7C%20POSTROUTING%20%7C%0A%7C-------------------------------%7C------------%7C-------%7C---------%7C--------%7C-------------%7C%0A%7C%20(routing%20decision)%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20raw%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20(connection%20tracking%20enabled)%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20mangle%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20nat%20(DNAT)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20(routing%20decision)%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20filter%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20security%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%7C%20nat%20(SNAT)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%7C%20%E2%9C%93%20%20%20%20%20%20%20%20%20%20%20%7C%0A%E6%AF%8F%E4%B8%AAchain%E5%92%8Ctable%E5%9C%A8%E6%95%B4%E4%B8%AA%E5%8D%8F%E8%AE%AE%E6%A0%88%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%A6%82%E4%B8%8B%E5%9B%BE%E3%80%82%0A%0A!%5Bfcbd15b235c892be235e74cb0e2f537f.png%5D(evernotecid%3A%2F%2FACEAA21A-C764-4256-94C6-40CA536E96D7%2Fappyinxiangcom%2F161681%2FENResource%2Fp6309)%0A%0A%E7%94%A8%E6%88%B7%E8%BF%98%E5%8F%AF%E4%BB%A5%E5%88%9B%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84chain%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%60iptables%20-N%20%3Cchain%20name%3E%60%E3%80%82%E7%84%B6%E5%90%8E%E4%BD%BF%E7%94%A8%60-j%60%E5%8F%82%E6%95%B0%E8%B7%B3%E8%BD%AC%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%60iptables%20-A%20INPUT%20-p%20tcp%20-j%20tcp_packets%60%0A%3E%20When%2FIf%20we%20reach%20the%20end%20of%20that%20chain%2C%20we%20get%20dropped%20back%20to%20the%20INPUT%20chain%20and%20the%20packet%20starts%20traversing%20from%20the%20rule%20one%20step%20below%20where%20it%20jumped%20to%20the%20other%20chain%20(tcp_packets%20in%20this%20case).%20If%20a%20packet%20is%20ACCEPTed%20within%20one%20of%20the%20sub%20chains%2C%20it%20will%20be%20ACCEPT%E2%80%99ed%20in%20the%20superset%20chain%20also%20and%20it%20will%20not%20traverse%20any%20of%20the%20superset%20chains%20any%20further.%20However%2C%20do%20note%20that%20the%20packet%20will%20traverse%20all%20other%20chains%20in%20the%20other%20tables%20in%20a%20normal%20fashion.%0A%0A%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B%EF%BC%9A%0A-%20%E5%A6%82%E6%9E%9C%E8%87%AA%E5%AE%9A%E4%B9%89chain%E9%81%8D%E5%8E%86%E7%BB%93%E6%9D%9F%EF%BC%8C%E5%88%99%E5%9B%9E%E5%88%B0%E5%8E%9F%E5%85%88%E8%B7%B3%E5%87%BA%E7%9A%84chain%EF%BC%88super%20chain%EF%BC%89%EF%BC%8C%E7%BB%A7%E7%BB%AD%E9%81%8D%E5%8E%86%0A-%20%E5%A6%82%E6%9E%9C%E5%AD%90%E9%93%BE%EF%BC%88sub%20chain%EF%BC%89%E4%B8%AD%E6%9C%89ACCEPT%EF%BC%8C%E5%88%99%E7%88%B6%E9%93%BE%E4%B8%AD%E7%9A%84%E8%A7%84%E5%88%99%E4%B8%8D%E4%BC%9A%E5%86%8D%E8%A2%AB%E7%BB%A7%E7%BB%AD%E9%81%8D%E5%8E%86%EF%BC%8C%E4%BD%86%E4%BB%8D%E7%84%B6%E4%BC%9A%E7%BB%A7%E7%BB%AD%E9%81%8D%E5%8E%86%E5%85%B6%E4%BB%96chain%E4%B8%AD%E7%9A%84%E8%A7%84%E5%88%99%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%85%B6%E4%BB%96table%E4%B8%AD%E7%9A%84%E8%A7%84%E5%88%99%E3%80%82%0A-%20%E5%A6%82%E6%9E%9C%E5%9C%A8%E4%BB%BB%E6%84%8F%E4%BD%8D%E7%BD%AE%EF%BC%8Cpacket%E8%A2%ABDROP%EF%BC%8C%E5%88%99%E5%90%8E%E7%BB%AD%E7%9A%84chain%E5%92%8Ctable%E9%83%BD%E4%B8%8D%E4%BC%9A%E8%A2%AB%E6%89%A7%E8%A1%8C%0A%23%23%20target%0A%60-j%60%E9%99%A4%E4%BA%86%E6%8C%87%E5%AE%9A%E8%87%AA%E5%AE%9A%E4%B9%89chain%E5%A4%96%EF%BC%8C%E4%B8%80%E4%B8%AA%E6%9B%B4%E9%87%8D%E8%A6%81%E7%9A%84%E7%94%A8%E9%80%94%E5%B0%B1%E6%98%AF%E6%8C%87%E5%AE%9Apacket%E7%9A%84%E7%9B%AE%E7%9A%84%E5%9C%B0%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AFtarget%E3%80%82%0A%0A%3ETargets%20on%20the%20other%20hand%20specify%20an%20action%20to%20take%20on%20the%20packet%20in%20question.%20We%20could%20for%20example%2C%20DROP%20or%20ACCEPT%20the%20packet%20depending%20on%20what%20we%20want%20to%20do.%20There%20are%20also%20a%20number%20of%20other%20actions%20we%20may%20want%20to%20take.%0A%3EFor%20example%3A%20ACCEPT%2C%20DROP%2C%20CONNMARK%2C%20CLASSIFY%2C%20LOG%20...%0A%0A-%20Some%20targets%20will%20cause%20the%20packet%20to%20stop%20traversing%20that%20speci%EF%AC%81c%20chain%20and%20superior%20chains%20as%20described%20above.%20ex.%20ACCEPT%2C%20DROP%0A-%20Other%20targets%2C%20may%20take%20an%20action%20on%20the%20packet%2C%20after%20which%20the%20packet%20will%20continue%20passing%20through%20the%20rest%20of%20the%20rules.%20ex.%20LOG%2C%20ULOG%2C%20TOS%0A-%20Some%20targets%20will%20accept%20extra%20options%20(What%20TOS%20value%20to%20use%20etc)%2C%20while%20others%20don%E2%80%99t%20necessarily%20need%20any%20options.%0A%0A**%E6%B3%A8**%EF%BC%9A%E4%BB%A5%E4%B8%8A%E6%91%98%E8%87%AA%5B5%5D%2C%E6%97%B6%E9%97%B4%E6%9C%89%E7%82%B9%E4%B9%85%EF%BC%8C%E5%8F%AF%E8%83%BD%E6%9C%89%E4%BA%9B%E5%B7%B2%E7%BB%8F%E4%B8%8D%E6%88%90%E7%AB%8B%E4%BA%86%EF%BC%88%E4%BE%8B%E5%A6%82%5B5%5D%E4%B8%AD%E9%80%9A%E7%AF%87%E6%9C%AA%E6%8F%90%E5%88%B0security%20table)%EF%BC%8C%E4%BD%86%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF%E5%BA%94%E8%AF%A5%E6%98%AF%E4%BF%9D%E6%8C%81%E7%9A%84%E3%80%82%0A%23%20SECMARK%0A%E4%B8%8A%E4%B8%80%E7%AB%A0%E4%BB%8B%E7%BB%8D%E4%BA%86iptables%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%EF%BC%8C%E5%92%8Ctable%2Fchain%E7%9A%84%E9%81%8D%E5%8E%86%E6%96%B9%E6%B3%95%E3%80%82%E8%80%8C%E5%8F%AF%E4%BB%A5%E4%B8%8ESELinux%E8%81%94%E5%8A%A8%EF%BC%8C%E5%B9%B6%E6%8F%90%E4%BE%9B%E5%9F%BA%E4%BA%8Esocket%20packet%E7%9A%84MAC%E6%9C%BA%E5%88%B6%E7%9A%84%E6%98%AFiptables%E7%9A%84security%E8%A1%A8%E6%A0%BC%E3%80%82%E4%BB%8E%E4%B8%8A%E9%9D%A2%E8%A1%A8%E6%A0%BC%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%EF%BC%8Csecurity%20table%E5%8F%AA%E6%9C%893%E4%B8%AAchain%EF%BC%8C%E5%8D%B3%EF%BC%9AINPUT%EF%BC%8CFORWARD%EF%BC%8COUTPUT%E3%80%82%E5%AF%B9%E5%BA%94%E4%BA%86%E8%BE%93%E5%85%A5%EF%BC%8C%E8%BE%93%E5%87%BA%E4%BB%A5%E5%8F%8A%E8%BD%AC%E5%8F%913%E7%A7%8D%E6%95%B0%E6%8D%AE%E6%B5%81%E3%80%82%E5%8F%AF%E4%BB%A5%E6%BB%A1%E8%B6%B3%E5%9F%BA%E6%9C%AC%E7%9A%84packet%E5%BC%BA%E5%88%B6%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E9%9C%80%E6%B1%82%E3%80%82%0A%E4%B8%80%E6%9D%A1SECMARK%E7%9B%B8%E5%85%B3%E7%9A%84iptables%E8%AF%AD%E5%8F%A5%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%60%60%60shell%0Aiptables%20-t%20security%20-A%20INPUT%20-i%20lo%20-p%20tcp%20--dport%209999%20-j%20SECMARK%20--selctx%20system_u%3Aobject_r%3Aext_gateway_packet_t%3As0%0A%60%60%60%0A%E5%85%B6%E4%B8%AD%60iptables%20-t%20security%20-A%20INPUT%60%E8%A1%A8%E7%A4%BA%E5%BE%80security%20table%E7%9A%84INPUT%20chain%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E8%A7%84%E5%88%99%EF%BC%8Cmatch%E9%83%A8%E5%88%86%60-i%20lo%20-p%20tcp%20--dport%209999%60%E8%A1%A8%E7%A4%BA%E5%8C%B9%E9%85%8D%E6%9D%A5%E8%87%AAlo%E7%BD%91%E5%8D%A1%EF%BC%8C%E5%8D%8F%E8%AE%AE%E4%B8%BAtcp%E7%9A%84%E6%8A%A5%E6%96%87%EF%BC%8C%E7%9B%AE%E6%A0%87%E7%AB%AF%E5%8F%A3%E4%B8%BA9999%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8C%85%E8%A2%ABSECMARK%E7%9B%AE%E6%A0%87%E8%BF%9B%E8%A1%8C%E5%A4%84%E7%90%86%E3%80%82SECMARK%E7%9B%AE%E6%A0%87%E4%BD%BF%E7%94%A8--selctx%E5%8F%82%E6%95%B0%E4%B8%BA%E8%AF%A5%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%8C%85%E6%89%93%E4%B8%8A%60system_u%3Aobject_r%3Aext_gateway_packet_t%3As0%60%E7%9A%84%E5%AE%89%E5%85%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E3%80%82%E5%88%99SELinux%E7%9A%84%E7%AD%96%E7%95%A5%E8%AF%AD%E6%B3%95%E5%8D%B3%E5%8F%AF%E4%BB%A5%E9%92%88%E5%AF%B9%E8%AF%A5%E7%B1%BBpacket%E8%BF%9B%E8%A1%8C%E6%9D%83%E9%99%90%E5%88%A4%E6%96%AD%E3%80%82%E4%BE%8B%E5%A6%82%3A%0A%60%60%60%0Aallow%20ext_gateway_t%20ext_gateway_packet_t%20%3A%20packet%20%7B%20send%20recv%20%7D%3B%0A%60%60%60%0A%23%20CONNSECMARK%0ACONNSECMARK%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AFSECMARK%E7%9A%84%E6%89%A9%E5%B1%95%E3%80%82%E4%BB%8E%E5%90%8D%E5%AD%97%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%87%BACONNSECMARK%E6%98%AF%E9%92%88%E5%AF%B9%E8%BF%9E%E6%8E%A5%EF%BC%88connection%EF%BC%89%E8%BF%9B%E8%A1%8Cmark%E5%8A%A8%E4%BD%9C%E3%80%82iptables%E7%9A%84%E8%BF%9E%E6%8E%A5%E7%AE%A1%E7%90%86%E5%9F%BA%E4%BA%8ENetFilter%E7%9A%84conntrack%E3%80%82conntrack%E6%98%AF%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97%EF%BC%8C%E9%92%88%E5%AF%B9%E4%B8%8D%E5%90%8C%E7%9A%84%E5%8D%8F%E8%AE%AE%E7%B1%BB%E5%9E%8B%EF%BC%8C%E5%85%B7%E6%9C%89%E7%9B%B8%E5%BA%94%E7%9A%84%E8%BF%9E%E6%8E%A5%E6%8E%A7%E5%88%B6%E7%AE%A1%E7%90%86%E3%80%82%E8%BF%99%E5%B7%B2%E7%BB%8F%E8%B6%85%E5%87%BA%E6%9C%AC%E6%96%87%E7%9A%84%E8%8C%83%E5%9B%B4%E4%BA%86%E3%80%82%E4%BD%86%E4%B8%8D%E7%AE%A1conntrack%E5%A4%9A%E4%B9%88%E5%A4%8D%E6%9D%82%EF%BC%8C%E5%8A%9F%E8%83%BD%E5%A4%9A%E4%B9%88%E5%BC%BA%E5%A4%A7%EF%BC%8C%E5%AF%B9%E5%BA%94%E5%88%B0iptables%E7%9A%84%E7%8A%B6%E6%80%81%E5%8F%AA%E6%9C%894%E4%B8%AA%EF%BC%8C%E5%8D%B3NEW%2C%20EATABLISHED%2C%20RELATED%2C%20INVALID%E3%80%82%E6%89%80%E6%9C%89%E7%9A%84socket%20packet%E9%83%BD%E8%A2%AB%E6%98%A0%E5%B0%84%E5%88%B0%E8%BF%994%E6%AD%8C%E7%8A%B6%E6%80%81%E3%80%82%E5%85%B7%E4%BD%93%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%5B5%5D%E7%9A%84Chapter%207.%20The%20state%20machine%E7%9A%84User-land%20states%E3%80%82%0A%3E%20-%20NEW%3A%20tells%20us%20that%20the%20packet%20is%20the%20%EF%AC%81rst%20packet%20that%20we%20see.%0A%3E%20-%20ESTABLISHED%3A%20The%20only%20requirement%20to%20get%20into%20an%20ESTABLISHED%20state%20is%20that%20one%20host%20sends%20a%20packet%2C%20and%20that%20it%20later%20on%20gets%20a%20reply%20from%20the%20other%20host.%0A%3E%20-%20RELATED%3A%20The%20ESTABLISHED%20connection%20will%20then%20spawn%20a%20connection%20outside%20of%20the%20main%20connection.%20The%20newly%20spawned%20connection%20will%20then%20be%20considered%20RELATED%2C%20if%20the%20conntrack%20module%20is%20able%20to%20understand%20that%20it%20is%20RELATED.%0A%3E%20INVALID%3A%20The%20INVALID%20state%20means%20that%20the%20packet%20can%E2%80%99t%20be%20identi%EF%AC%81ed%20or%20that%20it%20does%20not%20have%20any%20state.%0A%0A%E6%9C%89%E4%BA%86%E8%BF%99%E7%8A%B6%E6%80%81%E5%AE%9A%E4%B9%89%EF%BC%8Ciptables%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8--state%20maches%E3%80%82%E4%BE%8B%E5%A6%82%EF%BC%9A%60iptables%20-A%20INPUT%20-m%20state%20--state%20ESTABLISHED%2CRELATED%20-j%20ACCEPT%60%E5%AE%9A%E4%B9%89%E4%BA%86%E8%A7%84%E5%88%99%EF%BC%8C%E5%A4%84%E4%BA%8EESTABLISHED%2C%20RELATED%E7%8A%B6%E6%80%81%E7%9A%84packet%E6%89%8D%E8%A2%ABACCEPT%E3%80%82%0Aiptables%E4%B8%8ESELinux%E9%85%8D%E5%90%88%E5%AE%8C%E5%85%A8%E5%9F%BA%E4%BA%8E%E5%AF%B9socket%20packet%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4%E3%80%82%E5%B9%B6%E6%B2%A1%E6%9C%89allow%E8%A7%84%E5%88%99%EF%BC%8C%E6%88%96SELinux%20object%E6%98%AF%E9%92%88%E5%AF%B9%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E7%9A%84%E3%80%82%E6%89%80%E4%BB%A5%EF%BC%8Ciptables%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E9%85%8D%E5%90%88state%20match%E4%BB%A5%E5%8F%8ACONNSECMARK%E4%B8%BA%E6%9D%A5%E8%87%AA%E4%BA%8E%E6%9F%90%E4%B8%AA%E8%BF%9E%E6%8E%A5%E7%9A%84packet%E8%BF%9B%E8%A1%8C%E6%89%93%E6%A0%87%E7%AD%BE%E3%80%82%E6%96%B9%E6%B3%95%E5%B0%B1%E6%98%AF--save%E5%92%8C--restore%E5%8F%82%E6%95%B0%E3%80%82%0A%0A-%20--save%20%0A%20%20%20%20-%20Example%3A%20%60iptables%20-t%20mangle%20-A%20PREROUTING%20-p%20tcp%20--dport%2080%20-j%20CONNSECMARK%20--save%60%0A%20%20%20%20-%20Explanation%3A%20Save%20the%20security%20context%20mark%20from%20the%20packet%20to%20the%20connection%20if%20the%20connection%20is%20not%20marked%20since%20before.%0A%0A-%20--restore%0A%20%20%20%20-%20Example%3A%20%60iptables%20-t%20mangle%20-A%20PREROUTING%20-p%20tcp%20--dport%2080%20-j%20CONNSECMARK%20--restore%60%0A%20%20%20%20-%20Explanation%3A%20If%20the%20packet%20has%20no%20security%20context%20mark%20set%20on%20it%2C%20the%20--restore%20option%20will%20set%20the%20security%20context%20mark%20associated%20with%20the%20connection%20on%20the%20packet.%0A%0A%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B%E5%B0%B1%E6%98%AF%EF%BC%9A%0A-%20--save%E5%B0%86packet%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84context%E8%B5%8B%E4%BA%88%E8%BF%9E%E6%8E%A5%0A-%20--restore%E5%B0%86%E8%BF%9E%E6%8E%A5%E7%9A%84context%E8%B5%8B%E4%BA%88packet%0A%E6%AD%A4%E6%97%B6SELinux%E5%85%B7%E5%A4%87%E6%9B%B4%E4%B8%B0%E5%AF%8C%E7%9A%84%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%8C%E6%9D%A5%E5%AF%B9socket%20packet%E8%BF%9B%E8%A1%8C%E5%BC%BA%E5%88%B6%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E3%80%82%0A%23%20Gateway%E5%AE%9E%E9%AA%8C%0A%23%23%20%E7%AE%80%E4%BB%8B%0A%E6%96%87%E7%8C%AE%5B2%5D%E7%9A%842.2%E7%AB%A0%E8%8A%82%E4%B8%AD%E6%8F%90%E4%BE%9B%E4%BA%86%E4%B8%80%E4%B8%AA%E5%BE%88%E5%A5%BD%E7%9A%84%E7%BB%83%E4%B9%A0%EF%BC%8C%E5%B8%A6%E6%88%91%E4%BB%AC%E8%AE%A4%E8%AF%86iptables%E4%B8%8ESELinux%E9%85%8D%E5%90%88%E5%81%9Asocket%20packet%E5%BC%BA%E5%88%B6%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E7%9A%84%E6%96%B9%E6%B3%95%E3%80%82%E8%AF%A5%E6%96%B9%E6%B3%95%E9%80%9A%E8%BF%87iptables%E5%92%8CSELinux%E5%AE%9E%E7%8E%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%B9%8B%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BF%87%E6%BB%A4%E3%80%82%E6%95%B4%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E7%A4%BA%E6%84%8F%E5%9B%BE%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA%EF%BC%8C%E5%85%B6%E4%B8%ADclient%E5%92%8Csecure_client%E4%BD%BF%E7%94%A8%E5%90%8C%E4%B8%80%E4%BB%BD%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91%EF%BC%8C%E5%8F%AA%E6%98%AFfile%20context%E6%9C%89%E6%89%80%E4%B8%8D%E5%90%8C%EF%BC%8Cserver%E5%92%8Csecure_server%E5%90%8C%E7%90%86%E3%80%82%0A!%5Bafd271fe524baadc38c595d0b74f9fae.png%5D(evernotecid%3A%2F%2FACEAA21A-C764-4256-94C6-40CA536E96D7%2Fappyinxiangcom%2F161681%2FENResource%2Fp6313)%0A%0A%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%E9%80%9A%E8%BF%87%E5%AE%9A%E4%B9%89%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%89%E5%85%A8%E4%B8%8A%E4%B8%8B%E6%96%87%EF%BC%88%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA%EF%BC%89%EF%BC%8C%E5%92%8Ctype_transition%E8%A7%84%E5%88%99%EF%BC%8C%E4%BD%BF%E5%BE%97secure_%5C*%E8%BF%9B%E7%A8%8B%E5%B7%A5%E4%BD%9C%E5%9C%A8ext_gateway_t%20domain%EF%BC%8C%E8%80%8C%E9%9D%9Esecure%E8%BF%9B%E7%A8%8B%E5%B7%A5%E4%BD%9C%E5%9C%A8unconfined_t%20domain%E3%80%82%E5%90%84%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%89%E5%85%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E5%A6%82%E4%B8%8B%E6%89%80%E7%A4%BA%EF%BC%9A%0A%60%60%60%0A%2Fusr%2Flocal%2Fbin%2Fsecure_client%20system_u%3Aobject_r%3Asecure_services_exec_t%3As0%0A%2Fusr%2Flocal%2Fbin%2Fsecure_server%20system_u%3Aobject_r%3Asecure_services_exec_t%3As0%0A%2Fusr%2Flocal%2Fbin%2Fclient%20system_u%3Aobject_r%3Aunconfined_t%3As0%0A%2Fusr%2Flocal%2Fbin%2Fserver%20system_u%3Aobject_r%3Aunconfined_t%3As0%0A%60%60%60%0A%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%E4%B8%AD%E7%9A%84%E7%AD%96%E7%95%A5%E9%9B%86%EF%BC%88.conf)%E6%96%87%E4%BB%B6%E5%AE%9A%E4%B9%89%E4%BA%86%E7%A4%BA%E6%84%8F%E5%9B%BE%E4%B8%AD4%E4%B8%AA%E6%96%B9%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E6%9D%83%E9%99%90%EF%BC%8C%E5%8C%85%E6%8B%AC%EF%BC%9A%0A-%20%E5%85%81%E8%AE%B8%E8%AE%BF%E9%97%AE%E6%9C%AA%E6%A0%87%E8%AE%B0%E7%AB%AF%E5%8F%A3%E7%9A%84%E6%95%B0%E6%8D%AE%E6%B5%81(default_secmark_packet_t)%EF%BC%9A%60auditallow%20unconfined_t%20default_secmark_packet_t%20%3A%20packet%20%7B%20send%20recv%20%7D%3B%60%0A-%20%E5%85%81%E8%AE%B8secure_%5C*%E8%BF%9B%E7%A8%8B%E8%AE%BF%E9%97%AE%E6%A0%87%E8%AE%B0%E4%BA%86%E7%AB%AF%E5%8F%A3%E7%9A%84%E6%95%B0%E6%8D%AE%E6%B5%81%EF%BC%88ext_gateway_packet_t%EF%BC%89%EF%BC%9A%60allow%20ext_gateway_t%20ext_gateway_packet_t%20%3A%20packet%20%7B%20send%20recv%20%7D%3B%60%0A-%20%E5%85%81%E8%AE%B8secure_%5C*%E8%BF%9B%E7%A8%8B%E8%AE%BF%E9%97%AE%E6%97%A0SECMARK%E6%A0%87%E8%AE%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E6%B5%81%EF%BC%88unconfined_t%EF%BC%89%EF%BC%9A%60allow%20ext_gateway_t%20unconfined_t%20%3A%20packet%20%7B%20recv%20send%20%7D%3B%60%0Aiptables_secmark%E4%BD%BF%E7%94%A8%E8%8B%A5%E5%B9%B2iptables%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84%E6%A0%87%E7%AD%BE%E8%A7%84%E5%88%99%EF%BC%8C%E4%BE%8B%E5%A6%82%EF%BC%9A%0A-%20%E6%9D%A5%E8%87%AA%E4%BA%8Elo%E7%BD%91%E5%8D%A1%E7%9A%84%EF%BC%8C%E5%8D%8F%E8%AE%AE%E4%B8%BAtcp%EF%BC%8C%E7%9B%AE%E6%A0%87IP%E4%B8%BA127.0.0.0%EF%BC%8C%E6%8E%A9%E7%A0%81%E4%B8%BA255.0.0.0%E8%BE%93%E5%85%A5%E6%95%B0%E6%8D%AE%E5%8C%85%E8%A2%AB%E8%AE%BE%E7%BD%AE%E6%88%90default_secmark_packet_t%0A%60%60%60shell%0A%23%20This%20OUTPUT%20rule%20sets%20all%20packets%20to%20default_secmark_packet_t%3A%20as%20it%20is%0Aiptables%20-t%20security%20-A%20INPUT%20-i%20lo%20-p%20tcp%20-d%20127.0.0.0%2F8%20-j%20SECMARK%20--selctx%20system_u%3Aobject_r%3Adefault_secmark_packet_t%3As0%0A%60%60%60%0A-%20%E6%9D%A5%E8%87%AA%E4%BA%8Elo%E7%BD%91%E5%8D%A1%E7%9A%84%EF%BC%8C%E5%8D%8F%E8%AE%AE%E4%B8%BAtcp%EF%BC%8C%E7%9B%AE%E6%A0%87%2F%E6%BA%90%E7%AB%AF%E5%8F%A3%E4%B8%BA9999%E7%9A%84%E8%BE%93%E5%85%A5%2F%E8%BE%93%E5%87%BA%E6%95%B0%E6%8D%AE%E5%8C%85%E8%A2%AB%E8%AE%BE%E7%BD%AE%E6%88%90ext_gateway_packet_t%EF%BC%88%E8%8A%82%E9%80%89%EF%BC%89%0A%60%60%60shell%0A%23%20These%20rules%20will%20replace%20the%20above%20context%20with%20the%20internal%20or%0Aiptables%20-t%20security%20-A%20INPUT%20-i%20lo%20-p%20tcp%20--dport%209999%20-j%20SECMARK%20--selctx%20system_u%3Aobject_r%3Aext_gateway_packet_t%3As0%0Aiptables%20-t%20security%20-A%20OUTPUT%20-o%20lo%20-p%20tcp%20--sport%209999%20-j%20SECMARK%20--selctx%20system_u%3Aobject_r%3Aext_gateway_packet_t%3As0%0A%60%60%60%0A%E4%B8%A4%E7%B1%BB%E8%A7%84%E5%88%99%E5%AE%9A%E4%B9%89%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8C%85%E8%8C%83%E5%9B%B4%E5%AE%9E%E9%99%85%E6%98%AF%E6%9C%89%E9%87%8D%E5%8F%A0%E7%9A%84%EF%BC%8C%E6%A0%B9%E6%8D%AE%E6%B3%A8%E9%87%8A%E5%8F%AF%E7%9F%A5%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%A4%E8%80%85%E7%9A%84%E5%85%B3%E7%B3%BB%E6%98%AF%EF%BC%8Cgeneral%E5%92%8C%E7%89%B9%E4%BE%8B%E7%9A%84%E5%85%B3%E7%B3%BB%E3%80%82%E5%8D%B3%E5%89%8D%E8%80%85%E5%B0%86%E6%89%80%E6%9C%89%E7%89%B9%E5%AE%9A%E7%9B%AE%E6%A0%87%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8C%85%E8%AE%BE%E7%BD%AE%E4%B8%BAdefault_secmark_packet_t%EF%BC%8C%E8%80%8C%E5%90%8E%E8%80%85%E5%B0%86%E6%9D%A5%E8%87%AA%E7%89%B9%E5%AE%9A%E7%AB%AF%E5%8F%A3%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8C%85%E6%8C%87%E5%AE%9A%E4%B8%BAext_gateway_packet_t%E3%80%82%0A%E7%BB%8F%E8%BF%87%E6%AD%A4%E7%B1%BB%E7%AD%96%E7%95%A5%E8%AE%BE%E7%BD%AE%EF%BC%8Cclient%E5%9C%A8%E8%AE%BF%E9%97%AEsecure_server%E6%97%B6%EF%BC%8C%E6%95%B0%E6%8D%AE%E5%8C%85%E5%B0%B1%E4%BC%9A%E8%A2%AB%E6%8B%A6%E6%88%AA%E3%80%82%E6%9F%A5%E7%9C%8B%2Fvar%2Flog%2Faudit%2Faudit.log%3A%0A%60%60%60%0Atype%3DAVC%20msg%3Daudit(1602641071.967%3A3475)%3A%20avc%3A%20%20granted%20%20%7B%20send%20%7D%20for%20%20pid%3D0%20comm%3D%22swapper%2F0%22%20saddr%3D127.0.0.1%20src%3D9999%20daddr%3D127.0.0.1%20dest%3D47076%20netif%3Dlo%20scontext%3Dunconfined_u%3Amessage_filter_r%3Aext_gateway_t%3As0-s0%3Ac0.c1023%20tcontext%3Dsystem_u%3Aobject_r%3Aext_gateway_packet_t%3As0%20tclass%3Dpacket%0A%0Atype%3DAVC%20msg%3Daudit(1602641071.967%3A3476)%3A%20avc%3A%20%20denied%20%20%7B%20recv%20%7D%20for%20%20pid%3D10%20comm%3D%22ksoftirqd%2F0%22%20saddr%3D127.0.0.1%20src%3D9999%20daddr%3D127.0.0.1%20dest%3D47076%20netif%3Dlo%20scontext%3Dunconfined_u%3A%0Aunconfined_r%3Aunconfined_t%3As0-s0%3Ac0.c1023%20tcontext%3Dsystem_u%3Aobject_r%3Aext_gateway_packet_t%3As0%20tclass%3Dpacket%20permissive%3D0%0A%60%60%60%0Aclient%E8%BF%9E%E6%8E%A5secure_server%E7%9B%91%E5%90%AC%E7%9A%849999%E7%AB%AF%E5%8F%A3%EF%BC%8C%E6%95%B0%E6%8D%AE%E6%B5%81%E4%B8%BA%EF%BC%9Atcp%EF%BC%8C127.0.0.1%3A9999%20%3D%3E%20127.0.0.1%3A47076%E3%80%82secure_server%E5%90%91client%E5%8F%91%E9%80%81%E6%88%90%E5%8A%9F%EF%BC%8C%E4%BD%86client%E6%8E%A5%E6%94%B6%E5%A4%B1%E8%B4%A5%E3%80%82%E5%9B%A0%E4%B8%BAclient%E8%BF%90%E8%A1%8C%E4%BA%8Eunconfined_t%EF%BC%8C%E6%B2%A1%E6%9C%89%E5%AF%B9%E5%BA%94ext_gateway_packet_t%E7%9A%84recv%E6%9D%83%E9%99%90%E3%80%82%0A%0A%23%23%20%E5%8B%98%E8%AF%AF%0A%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%5B2%5D%E5%9B%A0%E4%B8%BA%E6%88%90%E4%B9%A6%E8%BF%87%E4%B9%85%EF%BC%88%E5%86%99%E4%BA%8E2014%E5%B9%B4%EF%BC%8C%E7%8E%B0%E5%9C%A82020%E5%B9%B4%EF%BC%89%EF%BC%8C%E4%B8%94%E7%BB%83%E4%B9%A0%E5%9F%BA%E4%BA%8E%E4%B9%A6%E4%B8%AD%E5%89%8D%E5%AF%BC%E7%AB%A0%E8%8A%82%E4%B8%AD%E7%9A%84modular-test%E7%AB%A0%E8%8A%82%EF%BC%8C%E6%89%80%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8C%E4%BC%9A%E4%BA%A7%E7%94%9F%E9%94%99%E8%AF%AF%E3%80%82%E9%94%99%E8%AF%AF%E4%B8%BB%E8%A6%81%E5%8C%85%E5%90%AB%EF%BC%9A%0A-%20%E5%9F%BA%E4%BA%8Emodular-test%E6%9E%84%E5%BB%BAext_gateway%E7%AD%96%E7%95%A5%E3%80%82%E5%9B%A0%E4%B8%BA%E5%8F%AF%E8%83%BD%E6%98%AF%E5%8F%91%E8%A1%8C%E7%89%88%E5%8F%98%E5%8C%96%EF%BC%88%E7%AC%94%E8%80%85%E7%94%A8%E7%9A%84CentOS8%EF%BC%89%E6%88%96%E8%80%85%E6%97%B6%E9%97%B4%E8%BF%87%E4%B9%85%E7%9A%84%E5%8E%9F%E5%9B%A0%EF%BC%8C%E7%9B%B4%E6%8E%A5%E7%94%A8%E4%B9%A6%E4%B8%AD%E7%9A%84%E5%9F%BA%E7%A1%80%E7%AD%96%E7%95%A5%E4%BC%9A%E9%80%A0%E6%88%90%E6%97%A0%E6%B3%95%E5%BC%80%E6%9C%BA%EF%BC%8C%E6%89%80%E4%BB%A5modular-test%E7%BB%83%E4%B9%A0%E4%B8%AD%E7%9A%84%E7%AD%96%E7%95%A5%E4%B8%8D%E5%8F%AF%E7%94%A8%E3%80%82%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%98%AF%EF%BC%8C%E7%BC%96%E8%AF%91ext_gateway%20module%EF%BC%8C%E5%B9%B6%E7%94%A8semodule%E6%8F%92%E5%85%A5%E5%8F%91%E8%A1%8C%E7%89%88%E8%87%AA%E5%B8%A6%E7%9A%84%E7%AD%96%E7%95%A5%E4%B8%AD%E3%80%82%E6%AD%A4%E6%97%B6%E9%9C%80%E8%A6%81%E9%92%88%E5%AF%B9%E5%8E%9F%E7%94%9F%E7%AD%96%E7%95%A5%E8%BF%9B%E8%A1%8C%E9%80%82%E9%85%8D%E3%80%82%E4%BE%8B%E5%A6%82%EF%BC%9A%E8%BF%9B%E7%A8%8B%E6%8B%89%E8%B5%B7%E6%97%B6%E6%8A%A5%E9%94%99%EF%BC%8C%E9%9C%80%E8%A6%81%E5%A2%9E%E5%8A%A0%E7%9B%B8%E5%BA%94allow%E8%A7%84%E5%88%99%EF%BC%8C%E8%8A%82%E9%80%89%E5%A6%82%E4%B8%8B%EF%BC%9A%0A%60%60%60%0Aallow%20ext_gateway_t%20null_device_t%20%3A%20chr_file%20%7B%20read%20write%20open%20%7D%3B%0Aallow%20ext_gateway_t%20ld_so_t%20%3A%20file%20%7B%20map%20read%20execute%20%7D%3B%0Aallow%20ext_gateway_t%20ld_so_cache_t%20%3A%20file%20%7B%20open%20map%20read%20execute%20getattr%20%7D%3B%0Aallow%20ext_gateway_t%20lib_t%20%3A%20file%20%7B%20open%20map%20read%20execute%20getattr%20%7D%3B%0A...%0A%60%60%60%0A-%20%E6%9C%AC%E4%B9%A6%E7%BB%99%E5%87%BA%E7%9A%84%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%E7%9A%84%E5%AE%89%E5%85%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E6%9C%AA%E7%BB%99%E5%87%BAmls%E6%8F%8F%E8%BF%B0%EF%BC%8C%E5%9C%A8%E7%BC%96%E8%AF%91%E6%97%B6%E4%BC%9A%E6%8A%A5%E9%94%99%E3%80%82%E4%BE%8B%E5%A6%82%EF%BC%9A%0A%60%60%60%0Aiptables%20-t%20security%20-A%20INPUT%20-i%20lo%20-p%20tcp%20--dport%209999%20-j%20SECMARK%20--selctx%20system_u%3Aobject_r%3Aext_gateway_packet_t%3As0%0Aiptables%20-t%20security%20-A%20INPUT%20-i%20lo%20-p%20tcp%20--sport%209999%20-j%20SECMARK%20--selctx%20system_u%3Aobject_r%3Aext_gateway_packet_t%3As0%0A%2Fusr%2Flocal%2Fbin%2Fsecure_client%20system_u%3Aobject_r%3Asecure_services_exec_t%3As0%0A%60%60%60%0A%E6%89%80%E6%9C%89%E7%9A%84context%E9%83%BD%E5%8A%A0%E4%B8%8A%E4%BA%86%60%3As0%60%E3%80%82%0A%E7%BB%8F%E8%BF%87%E9%80%82%E9%85%8D%E5%90%8E%EF%BC%8C%E4%B9%A6%E4%B8%AD%E6%8F%90%E4%BE%9B%E7%9A%84%E7%A4%BA%E4%BE%8B%E5%8F%AF%E4%BB%A5%E9%A1%BA%E5%88%A9%E8%B7%91%E9%80%9A%EF%BC%8C%E5%A6%82%E4%B8%8B%EF%BC%9A%0Aserver%0A!%5Be19e063bd6c8c6ea612eab6441924451.png%5D(evernotecid%3A%2F%2FACEAA21A-C764-4256-94C6-40CA536E96D7%2Fappyinxiangcom%2F161681%2FENResource%2Fp6311)%0Aclient%E7%AB%AF%0A!%5B2cf32398daa366c050fa0a9cbebd4dae.png%5D(evernotecid%3A%2F%2FACEAA21A-C764-4256-94C6-40CA536E96D7%2Fappyinxiangcom%2F161681%2FENResource%2Fp6312)%0A%0A%23%20%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%0A%5B1%5D%20%5BSELinux%20Networking%20Support%5D(https%3A%2F%2Fselinuxproject.org%2Fpage%2FNB_Networking)%0A%5B2%5D%20%5BThe%20SELinux%20Notebook%20-%20Building%20The%20Sample%20Policy%5D(https%3A%2F%2Fapp.yinxiang.com%2Fshard%2Fs10%2Fnl%2F161681%2Fb51d0a9e-c5fc-48aa-8eb9-0b9bee14f832%2F)%0A%5B3%5D%20%5Biptables%20wiki%20page%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FIptables)%0A%5B4%5D%20%5BA%20Deep%20Dive%20into%20Iptables%20and%20Netfilter%20Architecture%5D(https%3A%2F%2Fwww.digitalocean.com%2Fcommunity%2Ftutorials%2Fa-deep-dive-into-iptables-and-netfilter-architecture)%0A%5B5%5D%20Oskar%20Andreasson%2C%202001-2006%2C%20Iptables%20Tutorial%201.2.2&lt;/center&gt; ]]></description>
        </item>
    </channel>
</rss>
