<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zhougy0717.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="Edit &amp;#x524D;&amp;#x7AEF;&amp;#x4EE3;&amp;#x7801;&amp;#x4E00;&amp;#x76F4;&amp;#x6CA1;&amp;#x6709;&amp;#x505A;unit testing&amp;#xFF0C;&amp;#x4E5F;&amp;#x4E0D;&amp;#x77E5;&amp;#x9053;&amp;#x600E;&amp;#x4E48;&amp;#x505A;&amp;#x3002;&amp;#x5728;Yaakov Chaikin&amp;#x7684;Coursera&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="Angular JS - unit test">
<meta property="og:url" content="https://zhougy0717.github.io/2017/10/27/Angular_JS_-_unit_test/index.html">
<meta property="og:site_name" content="Big Ben">
<meta property="og:description" content="Edit &amp;#x524D;&amp;#x7AEF;&amp;#x4EE3;&amp;#x7801;&amp;#x4E00;&amp;#x76F4;&amp;#x6CA1;&amp;#x6709;&amp;#x505A;unit testing&amp;#xFF0C;&amp;#x4E5F;&amp;#x4E0D;&amp;#x77E5;&amp;#x9053;&amp;#x600E;&amp;#x4E48;&amp;#x505A;&amp;#x3002;&amp;#x5728;Yaakov Chaikin&amp;#x7684;Coursera&amp;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-10-26T22:33:17.000Z">
<meta property="article:modified_time" content="2018-06-13T06:18:51.000Z">
<meta property="article:author" content="Ben Zhou">
<meta property="article:tag" content="angular">
<meta property="article:tag" content="unittest">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://zhougy0717.github.io/2017/10/27/Angular_JS_-_unit_test/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://zhougy0717.github.io/2017/10/27/Angular_JS_-_unit_test/","path":"2017/10/27/Angular_JS_-_unit_test/","title":"Angular JS - unit test"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Angular JS - unit test | Big Ben</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Big Ben</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">一个半吊子的编码爱好者</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">karma setup</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.1.</span> <span class="nav-text">karma with ES6</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.2.</span> <span class="nav-text">Debug karma test using Chrome</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">ngMock</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.1.</span> <span class="nav-text">angular.mock.module</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.2.</span> <span class="nav-text">angular.mock.inject</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.3.</span> <span class="nav-text">Test controllers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.4.</span> <span class="nav-text">Test services</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.4.1.</span> <span class="nav-text">使用$injector</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.4.2.</span> <span class="nav-text">mock $http</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.4.3.</span> <span class="nav-text">如何mock $location &amp; $locationProvider</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.4.4.</span> <span class="nav-text">测试.config&#x2F;.run块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.4.5.</span> <span class="nav-text">如何mock $interval</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.4.6.</span> <span class="nav-text">Promise not resolve</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.4.7.</span> <span class="nav-text">“Unexpected request: GET …&#x2F;.html” on Karma tests</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ben Zhou</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">194</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">85</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zhougy0717" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhougy0717" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:benzhou.guangyu@gmail.com" title="E-Mail → mailto:benzhou.guangyu@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://zhougy0717.github.io/2017/10/27/Angular_JS_-_unit_test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ben Zhou">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Big Ben">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Angular JS - unit test
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-10-27 06:33:17" itemprop="dateCreated datePublished" datetime="2017-10-27T06:33:17+08:00">2017-10-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2018-06-13 14:18:51" itemprop="dateModified" datetime="2018-06-13T14:18:51+08:00">2018-06-13</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <!DOCTYPE en-note SYSTEM 'http://xml.evernote.com/pub/enml2.dtd'><div class="enNote" style="color: #2c3f51; line-height: 1.6; background: none;" title lang="v2" xml:lang dir><del style="position:relative;display:block;z-index:10;"><a style="position: absolute;color: #FFF;text-decoration: none;font-size: 12px;height: 25px;border-radius: 0;margin-top: -20px;right: 15px;background: rgba(0, 0, 0, 0);border-left: 10px solid #BB3A34;border-right: 10px solid #BB3A34;border-bottom: 5px solid rgba(0, 0, 0, 0);width: 0;text-indent:-100000px;" target="_blank" rel="noopener" href="http://maxiang.io/#/?provider=evernote&amp;guid=699f9e35-a583-4840-9b52-844d2fe42a40&amp;notebook=myblog">Edit</a></del><div style="color: #2c3f51; line-height: 1.6;"><p style="margin: 0 0 1.1em; line-height: 1.6;"> <br>&#x524D;&#x7AEF;&#x4EE3;&#x7801;&#x4E00;&#x76F4;&#x6CA1;&#x6709;&#x505A;unit testing&#xFF0C;&#x4E5F;&#x4E0D;&#x77E5;&#x9053;&#x600E;&#x4E48;&#x505A;&#x3002;&#x5728;Yaakov Chaikin&#x7684;<a href="https://www.coursera.org/learn/single-page-web-apps-with-angularjs/home/week/5" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Coursera&#x8BFE;&#x7A0B;</a>&#x4E2D;&#xFF0C;&#x7B2C;&#x4E94;&#x7AE0;&#x6B63;&#x597D;&#x4ECB;&#x7ECD;&#x4E86;&#x76F8;&#x5173;&#x5185;&#x5BB9;&#x3002;&#x6240;&#x4EE5;&#x5C31;&#x987A;&#x4FBF;&#x5728;&#x81EA;&#x5DF1;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#x5B9E;&#x8DF5;&#x4E86;&#x4E00;&#x628A;&#x3002;&#x65E0;&#x6570;&#x6B21;&#x7684;&#x5B9E;&#x8DF5;&#x8BC1;&#x660E;&#xFF0C;&#x770B;&#x5F97;&#x5934;&#x5934;&#x662F;&#x9053;&#xFF0C;&#x5199;&#x8D77;&#x6765;&#x5C31;&#x5230;&#x5904;&#x662F;&#x5751;&#x3002;&#x5C0F;&#x5C0F;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x7740;&#x5B9E;&#x82B1;&#x4E86;&#x4E0D;&#x5C11;&#x65F6;&#x95F4;&#x3002;</p><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x9488;&#x5BF9;&#x524D;&#x7AEF;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x7F51;&#x4E0A;&#x91C7;&#x7528;&#x7684;&#x6D4B;&#x8BD5;&#x6846;&#x67B6;&#x5927;&#x591A;&#x662F;karma + jasmine + chai&#x3002;&#x56E0;&#x4E3A;&#x6211;&#x4E4B;&#x524D;&#x5728;&#x540E;&#x7AEF;&#x4EE3;&#x7801;&#x7684;&#x6D4B;&#x8BD5;&#x4E2D;&#x591A;&#x91C7;&#x7528;mocha + should + sinon&#x3002;&#x6240;&#x4EE5;&#x672C;&#x6B21;&#x5B9E;&#x8DF5;&#xFF0C;&#x4ECD;&#x7136;&#x7231;&#x91C7;&#x7528;mocha&#x6846;&#x67B6;&#xFF0C;&#x6765;&#x642D;&#x914D;karma&#x4F7F;&#x7528;&#x3002;</p><p style="margin: 0 0 1.1em; line-height: 1.6;">karma&#x662F;&#x4E00;&#x4E2A;&#x81EA;&#x52A8;&#x5316;&#x6D4B;&#x8BD5;&#x6846;&#x67B6;&#x3002;&#x56E0;&#x5176;&#x4E30;&#x5BCC;&#x7684;&#x914D;&#x7F6E;&#x9009;&#x9879;&#xFF0C;&#x826F;&#x597D;&#x7684;&#x6269;&#x5C55;&#x6027;&#x80FD;&#xFF0C;&#x88AB;&#x5E7F;&#x6CDB;&#x5E94;&#x7528;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;&#x524D;&#x7AEF;&#x3002;&#x56E0;&#x4E3A;&#x524D;&#x7AEF;&#x8981;&#x9488;&#x5BF9;&#x5404;&#x79CD;&#x7248;&#x672C;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#xFF0C;&#x5404;&#x79CD;&#x6846;&#x67B6;&#xFF0C;&#x5982;&#x679C;&#x5168;&#x90E8;&#x9760;&#x624B;&#x52A8;&#x53BB;&#x9002;&#x914D;&#xFF0C;&#x57FA;&#x672C;&#x4E0D;&#x592A;&#x53EF;&#x80FD;&#x3002;&#x6240;&#x4EE5;&#x5927;&#x5BB6;&#x90FD;&#x7528;karma&#x4E86;&#x3002;</p><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 34.4px; margin: 1.2em 0 .6em 0; text-align: start;">karma setup</h2><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x57FA;&#x672C;&#x914D;&#x7F6E;&#x53C2;&#x8003;<a href="https://segmentfault.com/a/1190000006895064" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">&#x524D;&#x7AEF;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x4E4B;Karma&#x73AF;&#x5883;&#x642D;&#x5EFA;</a></p><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7B80;&#x5355;&#x5982;&#x4E0B;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">module</span>.exports = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">config</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  config.set(&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// base path that will be used to resolve all patterns (eg. files, exclude)</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    basePath: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// frameworks to use</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// available frameworks: https://npmjs.org/browse/keyword/karma-adapter</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    frameworks: [...],</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// list of files / patterns to load in the browser</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    files: [</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;...&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      &#123;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">pattern</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;...&apos;</span>&#125;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    ],</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// list of files to exclude</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    exclude: [</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    ],</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// preprocess matching files before serving them to the browser</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    preprocessors: &#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// test results reporter to use</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// possible values: &apos;dots&apos;, &apos;progress&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// available reporters: https://npmjs.org/browse/keyword/karma-reporter</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    reporters: [<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;progress&apos;</span>],</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// web server port</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    port: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">9876</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// enable / disable colors in the output (reporters and logs)</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    colors: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">true</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// level of logging</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    logLevel: config.LOG_INFO,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// enable / disable watching file and executing tests whenever any file changes</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    autoWatch: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">true</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// start these browsers</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// available browser launchers: https://npmjs.org/browse/keyword/karma-launcher</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    browsers: [<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;...&apos;</span>],</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// Continuous Integration mode</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// if true, Karma captures browsers, runs the tests and exits</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    singleRun: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">false</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// Concurrency level</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// how many browser should be started simultaneous</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    concurrency: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">Infinity</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// Which plugins to enable</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    plugins: []</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x7B80;&#x5355;&#x7684;&#x89E3;&#x91CA;&#x76EE;&#x524D;&#x7528;&#x5230;&#x7684;&#x9009;&#x9879;&#xFF1A;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">frameworks: &#x4F7F;&#x7528;&#x5230;&#x7684;&#x6846;&#x67B6;&#xFF0C;&#x6240;&#x6709;&#x4F7F;&#x7528;&#x5230;&#x7684;&#xFF0C;&#x8981;&#x5728;&#x4E0B;&#x9762;plugins&#x4E2D;&#x5217;&#x660E;&#x3002;&#x6BD4;&#x5982;&#xFF1A;frameworks&#x4E2D;&#x5305;&#x542B;mocha&#xFF0C;&#x5219;plugins&#x4E0B;&#x5C31;&#x8981;&#x5305;&#x542B;karma-mocha</li><li style="line-height: 1.6;">basePath, files, exclude: &#x8FD9;&#x4E09;&#x4E2A;&#x6307;&#x660E;&#x4E86;karma&#x8981;&#x52A0;&#x8F7D;&#x7684;JS&#x6587;&#x4EF6; <br><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">basePath&#xFF1A;&#x57FA;&#x7840;&#x76EE;&#x5F55;&#xFF0C;&#x4F1A;&#x76F4;&#x63A5;&#x63D2;&#x5165;&#x5230;files&#xFF0C;exclude&#x6307;&#x5B9A;&#x7684;&#x8DEF;&#x5F84;&#x524D;&#x9762;</li><li style="line-height: 1.6;">files&#xFF1A;&#x52A0;&#x8F7D;&#x6587;&#x4EF6;&#xFF0C;&#x652F;&#x6301;&#x901A;&#x914D;&#x7B26;&#x548C;&#x6B63;&#x5219;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;&#x5927;&#x62EC;&#x53F7;&#x8FD8;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x914D;&#x7F6E;&#x9009;&#x9879;&#x3002;&#x901A;&#x914D;&#x7B26;&#x2019;**&#x2019;&#x8868;&#x793A;&#x6240;&#x6709;&#x76EE;&#x5F55;&#xFF0C;&#x2019;*&#x2019;&#x8868;&#x793A;&#x6240;&#x6709;&#x6587;&#x4EF6;&#xFF0C;&#x2019;**/*&#x2019;&#x8868;&#x793A;&#x5176;&#x4E0B;&#x6240;&#x6709;&#x76EE;&#x5F55;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x3002;</li><li style="line-height: 1.6;">exclude: &#x53EF;&#x4EE5;&#x5254;&#x9664;files&#x4E2D;&#x4E0D;&#x60F3;&#x8981;&#x7684;&#x6587;&#x4EF6;</li></ul></li><li style="line-height: 1.6;">browsers&#xFF1A;&#x4F7F;&#x7528;&#x7684;&#x6D4F;&#x89C8;&#x5668;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;headless&#x6D4B;&#x8BD5;&#x5219;&#x53EF;&#x7528;PhantomJS</li></ul><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">karma with ES6</h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x56E0;&#x4E3A;PhantomJS&#x4E0D;&#x652F;&#x6301;ES6&#x8BED;&#x6CD5;(&#x7F51;&#x4E0A;&#x8BF4;&#xFF0C;PhantomJS&#x751A;&#x81F3;&#x5BF9;ES5&#x7684;&#x652F;&#x6301;&#x90FD;&#x4E0D;&#x662F;&#x5F88;&#x597D;)&#xFF0C;&#x6240;&#x4EE5;karma&#x8981;&#x6D4B;&#x8BD5;&#x5305;&#x542B;ES6&#x8BED;&#x6CD5;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x4E00;&#x756A;&#x914D;&#x7F6E;&#x3002;&#x7F51;&#x4E0A;&#x76F8;&#x5173;&#x7684;&#x5E16;&#x5B50;&#x5F88;&#x591A;&#xFF0C;&#x5217;&#x4E3E;&#x5982;&#x4E0B;&#xFF1A;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;"><a href="http://radify.io/blog/announcing-karma-es6-shim/" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Testing ES6 with Karma, RequireJS, and Angular</a>  - karma-es6-shim </li><li style="line-height: 1.6;"><a href="https://www.barbarianmeetscoding.com/blog/2015/11/16/how-to-start-writing-your-angular-js-tests-in-es6/" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">How to Start Writing Your AngularJS Tests in ES6</a> - karma-babel-preprocessor</li><li style="line-height: 1.6;"><a href="http://www.syntaxsuccess.com/viewarticle/writing-jasmine-unit-tests-in-es6" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Writing Jasmine Unit Tests In ES6</a> - webpack</li></ul><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x603B;&#x7684;&#x6765;&#x8BF4;&#xFF0C;&#x6709;&#x8FD9;&#x4E48;&#x51E0;&#x79CD;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">karma-es6-shim</li><li style="line-height: 1.6;">karma-babel-preprocessor</li><li style="line-height: 1.6;">webpack</li><li style="line-height: 1.6;">SlimerJS <br>&#x524D;&#x4E09;&#x79CD;&#x6709;&#x70B9;&#x590D;&#x6742;&#xFF0C;&#x76EE;&#x524D;&#x7684;&#x6211;&#x7684;&#x6280;&#x672F;&#x6808;&#x8FD8;&#x65E0;&#x6CD5;&#x7406;&#x89E3;&#x3002;&#x6700;&#x7EC8;&#x9009;&#x62E9;&#x6700;&#x7B80;&#x5355;&#x7684;SlimerJS&#x3002;&#x5728;Linux&#x4E0A;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;Xvfb&#x505A;&#x5230;headless&#x6D4B;&#x8BD5;&#xFF0C;Windows&#x4E0A;&#x5C31;&#x8FD9;&#x6837;&#x5427;&#xFF0C;&#x8DF3;&#x4E2A;&#x7A97;&#x53E3;&#x4E5F;&#x4E0D;&#x662F;&#x4EC0;&#x4E48;&#x5927;&#x4E8B;&#x3002;</li></ul><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">Debug karma test using Chrome</h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x4E2A;&#x5728;&#x521D;&#x5B66;&#x7684;&#x65F6;&#x5019;&#x8FD8;&#x662F;&#x5F88;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#xFF0C;&#x6050;&#x6015;&#x6211;&#x4E5F;&#x8DF3;&#x4E0D;&#x51FA;&#x81EA;&#x5DF1;&#x7ED9;&#x81EA;&#x5DF1;&#x6316;&#x7684;&#x5927;&#x5751;&#x3002; <br>&#x53C2;&#x8003;&#x94FE;&#x63A5;&#xFF1A;<a href="https://glebbahmutov.com/blog/debugging-karma-unit-tests/index.html" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Debugging Karma Unit Tests</a> <br>&#x6309;&#x7167;&#x4E0A;&#x9762;&#x7684;&#x6B65;&#x9AA4;&#x6253;&#x5F00;&#x8C03;&#x8BD5;&#x9875;&#x9762;&#x548C;Chrome Dev Tool&#x9875;&#x9762;&#xFF0C;&#x5237;&#x65B0;&#x9875;&#x9762;&#x5373;&#x53EF;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x4EE3;&#x7801;&#x5E76;&#x89E6;&#x53D1;&#x65AD;&#x70B9;&#x3002; <br>&#x5C06;&#x547D;&#x4EE4;&#x884C;&#x5199;&#x5165;package.json&#xFF0C;&#x4EE5;&#x540E;&#x8C03;&#x7528;npm&#x5C31;&#x53EF;&#x4EE5;&#x65B9;&#x4FBF;&#x7684;&#x6253;&#x5F00;&#x8BE5;&#x8C03;&#x8BD5;&#x5DE5;&#x5177;&#x3002;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">...</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;scripts&quot;</span>: &#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;start&quot;</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;node ./bin/www&quot;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;karma-debug&quot;</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cd public/js &amp;&amp; karma start --browsers=Chrome --single-run=false --debug&quot;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  ...</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;</div></code></pre><h2 style="font-family: inherit; font-weight: bold; line-height: 1.1; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 34.4px; margin: 1.2em 0 .6em 0; text-align: start;">ngMock</h2><p style="margin: 0 0 1.1em; line-height: 1.6;">ngMock&#x4E2D;&#x4E24;&#x4E2A;&#x6700;&#x91CD;&#x8981;&#x7684;&#x5173;&#x952E;&#x8BCD;&#x5C31;&#x662F;&#xFF1A;module, inject&#x3002;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x8FD9;&#x4E2A;&#x4EBA;&#x7684;&#x535A;&#x5BA2;&#xFF1A;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;"><a href="http://www.bradoncode.com/blog/2015/05/27/ngmock-fundamentals-angularjs-testing-inject/" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">ngMock Fundamentals for AngularJS - Understanding Inject</a></li><li style="line-height: 1.6;"><a href="http://www.bradoncode.com/blog/2015/05/24/ngmock-fundamentals-angularjs-unit-testing/" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">ngMock Fundamentals for AngularJS Unit Testing - Understanding Module</a></li></ul><p style="margin: 0 0 1.1em; line-height: 1.6;">ngMock&#x901A;&#x8FC7;module&#x52A0;&#x8F7D;&#x5DF2;&#x7ECF;&#x5B9A;&#x4E49;&#x4E86;&#x7684;&#x6A21;&#x5757;&#xFF0C;&#x6216;&#x8005;&#x5B9A;&#x4E49;&#x533F;&#x540D;module&#x5E76;&#x63D0;&#x4F9B;&#x65B0;&#x7684;service&#xFF0C;&#x6216;&#x8005;&#x590D;&#x5199;&#x5DF2;&#x5B58;&#x5728;&#x7684;service&#x3002;module&#x53EA;&#x662F;&#x5C06;&#x540D;&#x5B57;&#xFF0C;&#x4EE5;&#x53CA;&#x5BF9;&#x5E94;&#x4F4D;&#x7F6E;&#x5B58;&#x5165;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x3002;inject&#x5C06;&#x771F;&#x6B63;&#x7684;&#x52A0;&#x8F7D;&#x6240;&#x6709;module&#x63D0;&#x4F9B;&#x7684;service&#xFF0C;&#x5E76;&#x89E3;&#x51B3;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x5C06;&#x76F8;&#x5E94;&#x7684;service&#x5BFC;&#x51FA;&#x5230;test case&#x4E2D;&#x4F7F;&#x7528;&#x3002;&#x5176;&#x5B9E;ngMock&#x4E5F;&#x5C31;&#x662F;&#x505A;&#x4E86;&#x8FD9;&#x4E24;&#x4EF6;&#x4E8B;&#x60C5;&#x3002; <br>&#x4E0B;&#x9762;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x4E00;&#x4E9B;&#x6709;&#x52A9;&#x4E8E;&#x7406;&#x89E3;&#x7684;&#x77E5;&#x8BC6;&#x70B9;&#x3002;</p><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">angular.mock.module</h3><p style="margin: 0 0 1.1em; line-height: 1.6;">module&#x51FD;&#x6570;&#x7684;&#x539F;&#x578B;&#x662F;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">angular.mock.module(alias, obj, func)</code> <br>module&#x63A5;&#x53D7;&#x4E09;&#x79CD;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#xFF0C;&#x6BCF;&#x4E00;&#x79CD;&#x90FD;&#x53EF;&#x4EE5;&#x5355;&#x72EC;&#x4F7F;&#x7528;&#xFF0C;&#x7528;&#x6765;&#x5B9A;&#x4E49;&#x6216;&#x52A0;&#x8F7D;&#x5BF9;&#x5E94;&#x6A21;&#x5757;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">alias: &#x662F;module&#x540D;&#x5B57;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x5728;&#x5F85;&#x6D4B;&#x4EE3;&#x7801;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x5728;&#x6D4B;&#x8BD5;&#x6587;&#x4EF6;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;</li><li style="line-height: 1.6;">obj: &#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x5B57;&#x5178;&#x7ED3;&#x6784;&#xFF0C;&#x4ED6;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x533F;&#x540D;module&#xFF0C;&#x5176;&#x4E2D;&#x7684;&#x6210;&#x5458;&#x4F1A;&#x88AB;&#x5B9A;&#x4E49;&#x6210;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">$provide.value()</code></li><li style="line-height: 1.6;">function: &#x540C;&#x6837;&#x662F;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x533F;&#x540D;module&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;function&#x53EF;&#x4EE5;&#x7528;$provide&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x6765;&#x5B9A;&#x4E49;&#x5404;&#x79CD;&#x5404;&#x6837;&#x7684;service&#x3002;</li></ul><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">function() vs Object</strong></p><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">The examples we used were similar, so what&#x2019;s the key difference between the function() and Object form? As the Object type gets added as a $provider.value, it is therefore restricted to the capabilities of the value service, most importantly that a value service cannot be injected with other services.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5173;&#x4E8E;$provide&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;<a href="https://docs.angularjs.org/api/auto/service/\%24provide" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Angular&#x5B98;&#x65B9;&#x6587;&#x6863;</a></p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">The <strong style="font-weight: bold; line-height: 1.6;"><span style="line-height: 1.6;">$</span>provide</strong> service has a number of methods for registering components with the <strong style="font-weight: bold; line-height: 1.6;"><span style="line-height: 1.6;">$</span>injector</strong>. Many of these functions are also exposed on angular.Module.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E0B;&#x9762;&#x7684;&#x8FD9;&#x4E9B;service</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">provider</strong>(name, provider) - registers a service provider with the <span style="line-height: 1.6;">$</span>injector <br><strong style="font-weight: bold; line-height: 1.6;">constant</strong>(name, obj) - registers a value/object that can be accessed by providers and services. <br><strong style="font-weight: bold; line-height: 1.6;">value</strong>(name, obj) - registers a value/object that can only be accessed by services, not providers. <br><strong style="font-weight: bold; line-height: 1.6;">factory</strong>(name, fn) - registers a service factory function that will be wrapped in a service provider object, whose <span style="line-height: 1.6;">$</span>get property will contain the given factory function. <br><strong style="font-weight: bold; line-height: 1.6;">service</strong>(name, Fn) - registers a constructor function that will be wrapped in a service provider object, whose <span style="line-height: 1.6;">$</span>get property will instantiate a new object using the given constructor function. <br><strong style="font-weight: bold; line-height: 1.6;">decorator</strong>(name, decorFn) - registers a decorator function that will be able to modify or replace the implementation of another service.</p></blockquote><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">angular.mock.inject</h3><p style="margin: 0 0 1.1em; line-height: 1.6;"><span style="line-height: 1.6;">$</span>inject&#x662F;ngMock&#x7684;&#x6838;&#x5FC3;&#xFF0C;&#x770B;&#x770B;&#x5B98;&#x65B9;&#x7684;&#x5B9A;&#x4E49;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">The inject function wraps a function into an injectable function. The inject() creates new instance of $injector per test, which is then used for resolving references.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">inject&#x5C31;&#x662F;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;injector&#xFF0C;&#x90A3;injector&#x53C8;&#x662F;&#x4EC0;&#x4E48;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;"><span style="line-height: 1.6;">$</span>injector is used to retrieve object instances as defined by provider, instantiate types, invoke methods, and load modules.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;"><span style="line-height: 1.6;">$</span>injector&#x4E5F;&#x5C31;&#x662F;AngularJS&#x7684;&#x6838;&#x5FC3;&#x3002;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x6240;&#x8C13;&#x7684;&#x201C;DI&#x201D; (Dependency Injection)&#x6A21;&#x5F0F;&#x3002;Angular&#x7684;&#x6838;&#x5FC3;&#x4EE3;&#x7801;&#x901A;&#x8FC7;<span style="line-height: 1.6;">$</span>injector&#x6765;&#x83B7;&#x53D6;&#x5BF9;&#x5E94;service&#x7684;reference&#x3002; <br>&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x5C06;inject&#x653E;&#x5728;beforeEach&#x91CC;&#xFF0C;&#x8FD9;&#x6837;inject&#x5C31;&#x4E3A;&#x6BCF;&#x4E2A;&#x6D4B;&#x8BD5;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;injector&#xFF0C;&#x4E3A;&#x8FD9;&#x4E2A;injector&#x51C6;&#x5907;&#x597D;&#x6240;&#x6709;&#x7684;service&#xFF0C;&#x5E76;&#x80FD;&#x901A;&#x8FC7;&#x53C2;&#x6570;&#x5C06;&#x4EFB;&#x610F;&#x5DF2;&#x6709;&#x7684;service&#x5BFC;&#x51FA;&#x3002;</p><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">Test controllers</h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E86;&#x89E3;&#x4E86;&#x4E0A;&#x9762;&#x7684;&#x4E24;&#x4E2A;&#x91CD;&#x8981;&#x7EC4;&#x4EF6;&#x4E4B;&#x540E;&#xFF0C;&#x9488;&#x5BF9;&#x4E0D;&#x540C;&#x7684;&#x6D4B;&#x8BD5;&#x7EC4;&#x4EF6;&#x5C31;&#x5BB9;&#x6613;&#x7406;&#x89E3;&#x4E86;&#x3002; <br>&#x76F4;&#x63A5;&#x4E0A;&#x4EE3;&#x7801;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">describe(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;main controller&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> $controller</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> mainCtrl</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  beforeEach(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;set up module&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">module</span>(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$provide</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      $provide.service(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;MockDataService&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">const</span> service = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        service.data = <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;test data&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">module</span>(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;MainModule&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;);</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  beforeEach(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;set up controller&apos;</span>, inject(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">_$controller_, MockDataService</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    $controller = _$controller_</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    mainCtrl = $controller(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;MainController&apos;</span>, &#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">          <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">DataService</span>: MockDataService</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;))</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  it(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;should assemble print page URL correctly&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    mainCtrl.getData().should.equal(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;test data&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;);</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;);</div></div></div></div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x91CC;&#x53EA;&#x6709;&#x4E24;&#x4E2A;&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x5176;&#x5B9E;&#x524D;&#x6587;&#x4E5F;&#x90FD;&#x6709;&#x63D0;&#x53CA;&#x3002;</p><ol style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">&#x7B2C;&#x4E00;&#x4E2A;module&#x4E2D;&#x901A;&#x8FC7;<span style="line-height: 1.6;">$</span>provide&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5047;&#x7684;service&#xFF0C;&#x8FD9;&#x4E2A;service&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5176;&#x540D;&#x5B57;&#x88AB;inject&#x3002;</li><li style="line-height: 1.6;">inject&#x4E2D;&#x901A;&#x8FC7;_<span style="line-height: 1.6;">$</span>controller_&#x6765;&#x5BFC;&#x51FA;controller&#x7684;&#x6784;&#x9020;&#x51FD;&#x6570;&#x3002;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x6784;&#x9020;&#x51FD;&#x6570;&#x6765;&#x6784;&#x9020;&#x76F8;&#x5E94;&#x7684;&#x5F85;&#x6D4B;controller&#xFF0C;&#x5E76;&#x4F20;&#x5165;&#x5047;&#x7684;service&#x8FBE;&#x5230;mock&#x7684;&#x76EE;&#x7684;&#x3002;</li></ol><h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">Test services</h3><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4ECD;&#x7136;&#x76F4;&#x63A5;&#x4E0A;&#x4EE3;&#x7801;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">angular.module(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;PrinterData&apos;</span>, [])</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.config([<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$locationProvider&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$locationProvider</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  $locationProvider.html5Mode(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">true</span>);</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;]);</div></code></pre><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">describe(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;printer data service&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> $httpBackend</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> PrinterDataService</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  beforeEach(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">)</span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">module</span>(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$provide</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      $provide.provider(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$location&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">const</span> provider = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">const</span> location = &#123;&#125;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        location.search = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">)</span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">          <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> &#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">id</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;test id&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">          &#125;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        &#125;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        provider.html5Mode = sinon.stub()</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        provider.$get = sinon.stub().returns(location)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;);</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  beforeEach(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">module</span>(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;Data&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    inject(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$injector</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      $httpBackend = $injector.get(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$httpBackend&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      DataService = $injector.get(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;DataService&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;);</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  it(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;should update if succeeds&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">done</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    $httpBackend.whenGET(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">/.*/</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .respond(&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">status</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;ready&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    DataService.getStatus().then(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">data</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      data.should.deepEqual(&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">status</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;ready&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      done()</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;).catch(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">err</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      should.not.exist(err)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    $httpBackend.flush();</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;);</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;)</div></div></div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E0B;&#x9762;&#x7F57;&#x5217;&#x4E00;&#x4E9B;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x4E2D;&#x78B0;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x4EE5;&#x53CA;&#x81EA;&#x5DF1;&#x7684;&#x4E00;&#x4E9B;&#x7406;&#x89E3;&#x3002;</p><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">&#x4F7F;&#x7528;<span style="line-height: 1.6;">$</span>injector</h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x6211;&#x4EEC;&#x8BF4;&#x8FC7;inject&#x51FD;&#x6570;&#x5C31;&#x662F;&#x7528;&#x6765;&#x521B;&#x5EFA;<span style="line-height: 1.6;">$</span>injector&#xFF0C;&#x6240;&#x4EE5;<span style="line-height: 1.6;">$</span>injector&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x88AB;&#x5BFC;&#x51FA;&#x4F7F;&#x7528;&#x7684;&#x3002;&#x8FD9;&#x65F6;&#x9700;&#x8981;&#x4EC0;&#x4E48;service&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8C03;&#x7528;<span style="line-height: 1.6;">$</span>injector.get&#x3002;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x76F4;&#x63A5;&#x901A;&#x8FC7;&#x53C2;&#x6570;&#x6765;inject&#x5462;&#xFF1F;&#x5F53;&#x7136;&#x662F;&#x56E0;&#x4E3A;&#x53C2;&#x6570;&#x592A;&#x957F;&#x4E86;&#xFF0C;&#x4E0D;&#x597D;&#x770B;&#x3002;&#x3002;&#x3002;</p><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">mock <span style="line-height: 1.6;">$</span>http</h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4E3A;&#x4E86;&#x6D4B;&#x8BD5;&#x7A33;&#x5B9A;&#x6027;&#xFF0C;&#x6211;&#x4EEC;&#x5728;unit test&#x4E2D;&#x5E76;&#x4E0D;&#x771F;&#x6B63;&#x7684;&#x8BBF;&#x95EE;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x800C;&#x901A;&#x5E38;&#x91C7;&#x7528;&#x5047;&#x7684;&#x670D;&#x52A1;&#x5668;&#x54CD;&#x5E94;&#x6765;mock&#x3002;&#x8FD9;&#x5C31;&#x9700;&#x8981;&#x7528;&#x5230;<span style="line-height: 1.6;">$</span>httpBackend service&#x3002;&#x90A3;&#x4E48;<span style="line-height: 1.6;">$</span>http&#x548C;<span style="line-height: 1.6;">$</span>httpBackend&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;</p><blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;"><p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">HTTP backend used by the service that delegates to XMLHttpRequest object or JSONP and deals with browser incompatibilities. <br>You should never need to use this service directly, instead use the higher-level abstractions: <span style="line-height: 1.6;">$</span>http or <span style="line-height: 1.6;">$</span>resource. <br>During testing this implementation is swapped with mock $httpBackend which can be trained with responses.</p></blockquote><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5177;&#x4F53;&#x505A;&#x6CD5;&#xFF0C;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x5DF2;&#x6709;&#xFF0C;&#x8282;&#x5F55;&#x5982;&#x4E0B;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">beforeEach(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">module</span>(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;Data&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    inject(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$injector</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      $httpBackend = $injector.get(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$httpBackend&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      DataService = $injector.get(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;DataService&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;);</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  it(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;should update if succeeds&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">done</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    $httpBackend.whenGET(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">/.*/</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .respond(&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">status</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;ready&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    DataService.getStatus().then(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">data</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      data.should.deepEqual(&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">status</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;ready&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      done()</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;).catch(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">err</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      should.not.exist(err)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    $httpBackend.flush();</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;);</div></div></div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x901A;&#x8FC7;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">$httpBackend.wheGET(...).respond(...)</code>&#x6765;&#x8BBE;&#x7F6E;mock response&#x3002;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">whenGET</code>&#x8FD8;&#x652F;&#x6301;&#x6B63;&#x5219;&#x5F0F;&#x3002; <br>&#x8C03;&#x7528;&#x5B8C;&#x8BF7;&#x6C42;&#x51FD;&#x6570;&#x540E;&#x8981;&#x8BB0;&#x5F97;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">$httpBackend.flush()</code>&#x5C06;&#x8BF7;&#x6C42;&#x771F;&#x6B63;&#x7684;&#x53D1;&#x51FA;&#x3002;&#x5426;&#x5219;&#x8BF7;&#x6C42;&#x5E76;&#x4E0D;&#x4F1A;&#x53D1;&#x51FA;&#xFF0C;&#x76F4;&#x5230;&#x8C03;&#x7528;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">flush()</code>&#x51FD;&#x6570;&#xFF0C;&#x6216;&#x8005;&#x6D4B;&#x8BD5;&#x8D85;&#x65F6;&#x5931;&#x8D25;&#x3002;</p><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">&#x5982;&#x4F55;mock <span style="line-height: 1.6;">$</span>location &amp; <span style="line-height: 1.6;">$</span>locationProvider</h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5F88;&#x60ED;&#x6127;&#x7684;&#x8BF4;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x4E0A;&#x6211;&#x82B1;&#x4E86;&#x5F88;&#x4E45;&#x5F88;&#x4E45;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x641C;&#x7D22;&#x4E86;&#x5927;&#x91CF;&#x7684;google&#x7F51;&#x9875;&#xFF0C;&#x6700;&#x540E;&#x8FD8;&#x662F;&#x4F9D;&#x9760;chrome&#x8FFD;&#x8E2A;angular&#x6838;&#x5FC3;&#x4EE3;&#x7801;&#x624D;&#x53D1;&#x73B0;&#x539F;&#x6765;&#x662F;&#x81EA;&#x5DF1;&#x7ED9;&#x81EA;&#x5DF1;&#x6316;&#x7684;&#x5751;&#xFF0C;&#x5BF9;service, factory&#x548C;provider&#x7406;&#x89E3;&#x4E0D;&#x900F;&#x5F7B;&#x3002; <br>&#x9996;&#x5148;&#x6765;&#x5C31;&#x4E8B;&#x8BBA;&#x4E8B;&#xFF0C;&#x8BF4;&#x4E00;&#x4E0B;&#x5230;&#x5E95;&#x600E;&#x4E48;&#x5B8C;&#x6210;&#x6211;&#x7684;&#x8FD9;&#x4E2A;&#x6D4B;&#x8BD5;&#x3002;</p><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x56E0;&#x4E3A;&#x6211;&#x8981;&#x6D4B;&#x8BD5;DataService&#xFF0C;&#x800C;DataService&#x5B9A;&#x4E49;&#x5728;Data moduleDataService&#x8C03;&#x7528;&#x4E86;<span style="line-height: 1.6;">$</span>location service&#x3002;&#x9700;&#x8981;&#x5C06;&#x4E4B;mock&#x6389;&#x3002;&#x6700;&#x7B80;&#x5355;&#x7684;&#x60F3;&#x6CD5;&#x5C31;&#x662F;&#x901A;&#x8FC7;inject&#x6765;&#x83B7;&#x5F97;<span style="line-height: 1.6;">$</span>location service reference&#x3002;&#x5E76;&#x901A;&#x8FC7;sinon.stub&#x6765;&#x8BBE;&#x7F6E;&#x9700;&#x8981;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">inject(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">($injector, $location)</span> </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  sinon.stub($location, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;search&apos;</span>).returns(&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    id: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;test id&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  DataService = $injector.get(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;DataService&apos;</span>)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;)</div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x4F46;&#x662F;&#x6211;&#x5012;&#x9709;&#x50AC;&#x7684;&#xFF0C;&#x7ADF;&#x7136;&#x662F;&#x7528;<span style="line-height: 1.6;">$</span>provide&#x505A;&#x4E86;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">module</span>(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$provide</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  $provide.service(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$location&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">const</span> location = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    location.search = sinon.stub().returns(&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">device_id</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;test id&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;)</div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x6837;&#x5C31;&#x4F1A;&#x6709;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x5F53;ngMock&#x52A0;&#x8F7D;&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5148;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;<span style="line-height: 1.6;">$</span>locationProvider&#xFF0C;&#x8FD9;&#x5C31;&#x4F1A;&#x8986;&#x76D6;&#x5176;&#x81EA;&#x5E26;&#x7684;<span style="line-height: 1.6;">$</span>locationProvider&#x3002;&#x800C;&#x5982;&#x4E0B;&#x7684;module.config&#x65B9;&#x6CD5;&#x4E2D;&#x5BF9;<span style="line-height: 1.6;">$</span>locationProvider&#x7684;&#x64CD;&#x4F5C;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">angular.module(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;PrinterData&apos;</span>, [])</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.config([<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$locationProvider&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">($locationProvider)</span> </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  $locationProvider.html5Mode(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">true</span>);</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;]);</div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x56E0;&#x4E3A;&#x65B0;&#x5B9A;&#x4E49;&#x7684;<span style="line-height: 1.6;">$</span>locationProvider&#x4E2D;&#x6CA1;&#x6709;html5Mode&#x6210;&#x5458;&#x3002;&#x4E8E;&#x662F;&#x60F3;&#x4E86;&#x5404;&#x79CD;&#x529E;&#x6CD5;&#x6765;mock <span style="line-height: 1.6;">$</span>locationProvider&#x3002;&#x7ED3;&#x679C;&#x56E0;&#x4E3A;&#x5BF9;service&#xFF0C;factory&#xFF0C;provider&#x7684;&#x7406;&#x89E3;&#x4E0D;&#x6B63;&#x786E;&#xFF0C;&#x90FD;&#x5931;&#x8D25;&#x4E86;&#x3002;&#x653E;&#x4E00;&#x6BB5;&#x9519;&#x8BEF;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">beforeEach(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">)</span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">module</span>(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$provide</span>) </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    $provide.service(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$locationProvider&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">const</span> location = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      location.html5Mode = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">)</span>&#123;&#125;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    $provide.factory(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$location&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">) </span>&#123;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">const</span> locationProvider = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      locationProvider.html5Mode = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">)</span>&#123;&#125;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;)</div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x7B2C;&#x4E00;&#x4E2A;&#x7528;<span style="line-height: 1.6;">$</span>provide.service&#x4F1A;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;<span style="line-height: 1.6;">$</span>locationProviderProvider <br>&#x7B2C;&#x4E8C;&#x4E2A;&#x7528;<span style="line-height: 1.6;">$</span>provide.factory&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;<span style="line-height: 1.6;">$</span>locationProvider&#xFF0C;&#x4F46;&#x662F;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#xFF0C;&#x6240;&#x4EE5;<span style="line-height: 1.6;">$</span>location service&#x4E0D;&#x4F1A;&#x88AB;&#x5B9E;&#x4F8B;&#x5316;&#xFF0C;&#x4E5F;&#x5C31;&#x6CA1;&#x6709;<span style="line-height: 1.6;">$</span>location service&#x4E86;&#x3002; <br>&#x5982;&#x679C;&#x60F3;&#x901A;&#x8FC7;mock <span style="line-height: 1.6;">$</span>locationProvider&#x6765;mock <span style="line-height: 1.6;">$</span>location service&#x7684;&#x8BDD;&#xFF0C;&#x6B63;&#x786E;&#x7684;&#x505A;&#x6CD5;&#x5E94;&#x5F53;&#x662F;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">$provide.provider(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;$location&apos;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">()</span> </span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">const</span> provider = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">const</span> location = &#123;&#125;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  location.search = <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">()</span></span>&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> &#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">       device_id: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;test id&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    &#125;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  &#125;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  provider.html5Mode = sinon.stub()</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  provider.$<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">get</span> = sinon.stub().returns(location)</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;)</div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">mock&#x6389;provider.<span style="line-height: 1.6;">$</span>get&#x51FD;&#x6570;&#xFF0C;&#x63D0;&#x4F9B;&#x5047;&#x7684;location&#x670D;&#x52A1;&#x3002;&#x5176;&#x5B9E;&#x8FD8;&#x6709;&#x5F88;&#x591A;&#x529E;&#x6CD5;&#xFF0C;&#x4F8B;&#x5982;&#x83B7;&#x5F97;<span style="line-height: 1.6;">$</span>locationProvider&#x518D;&#x5BF9;<span style="line-height: 1.6;">$</span>get&#x51FD;&#x6570;&#x8FDB;&#x884C;stub&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x3002;&#x6CA1;&#x6709;&#x518D;&#x4E00;&#x4E00;&#x5C1D;&#x8BD5;&#x4E86;&#x3002;&#x7406;&#x89E3;&#x4E86;&#x9519;&#x8BEF;&#x548C;&#x6B63;&#x786E;&#x7684;&#x505A;&#x6CD5;&#xFF0C;&#x60F3;&#x518D;&#x53BB;&#x5B9E;&#x73B0;&#x5C31;&#x5F97;&#x5FC3;&#x5E94;&#x624B;&#x4E86;&#x3002;</p><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">&#x6D4B;&#x8BD5;.config/.run&#x5757;</h4><p style="margin: 0 0 1.1em; line-height: 1.6;">Data module&#x6709;&#x4E00;&#x4E2A;.config&#x5757;&#xFF0C;&#x56E0;&#x4E3A;&#x6A21;&#x5757;&#x52A0;&#x8F7D;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5148;&#x8FD0;&#x884C;&#x5176;.config&#x5757;&#xFF0C;&#x7136;&#x540E;&#x662F;.run&#x5757;&#x3002;&#x56E0;&#x5176;&#x7279;&#x6B8A;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x5BF9;&#x5176;&#x4E2D;&#x4F7F;&#x7528;&#x5230;&#x7684;&#x670D;&#x52A1;&#x8FDB;&#x884C;mock&#x8981;&#x6CE8;&#x610F;&#x987A;&#x5E8F;&#x3002;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x8FD9;&#x4E2A;&#x94FE;&#x63A5;&#xFF1A;<a href="https://medium.com/@a_eife/testing-config-and-run-blocks-in-angularjs-1809bd52977e" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Testing config and run blocks in AngularJS <br>How to easily test an often neglected part of your application</a></p><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">&#x5982;&#x4F55;mock $interval</h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5728;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x8981;&#x91C7;&#x7528;mock&#x7684;&#x624B;&#x6BB5;&#xFF0C;&#x800C;&#x4E0D;&#x771F;&#x6B63;&#x7684;&#x4F7F;&#x7528;&#x65F6;&#x95F4;&#x670D;&#x52A1;&#x3002;&#x5728;sinon&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;fake timer&#x6765;&#x53D6;&#x4EE3;JS&#x4E2D;&#x6807;&#x51C6;&#x7684;setTimeout&#x548C;setInterval&#x3002;&#x4E0D;&#x8FC7;&#x8FD9;&#x4E2A;&#x5728;Angular JS&#x4E2D;&#x5E76;&#x4E0D;&#x8D77;&#x4F5C;&#x7528;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<span style="line-height: 1.6;">$</span>interval&#x670D;&#x52A1;&#x7684;&#x8BDD;&#x3002; <br>&#x56E0;&#x4E3A;&#x5728;&#x5BF9;Angular JS&#x505A;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#xFF0C;<span style="line-height: 1.6;">$</span>interval&#x5E76;&#x4E0D;&#x4F1A;&#x8C03;&#x7528;setInterval&#x3002;&#x539F;&#x56E0;&#x662F;&#x8FD9;&#x91CC;&#x7684;<span style="line-height: 1.6;">$</span>interval&#x5176;&#x5B9E;&#x662F;ngMock&#x4E2D;&#x7684;<span style="line-height: 1.6;">$</span>interval&#x3002;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">$interval.flush(ms)</code>&#x6765;&#x5C06;&#x65F6;&#x949F;&#x63A8;&#x8FDB;&#x82E5;&#x5E72;&#x65F6;&#x95F4;&#x3002;&#x5F53;&#x7136;&#x5982;&#x679C;&#x613F;&#x610F;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;sinon&#x6765;mock&#x4ECE;<span style="line-height: 1.6;">$</span>injector&#x4E2D;get&#x51FA;&#x6765;&#x7684;<span style="line-height: 1.6;">$</span>interval service&#x3002;<span style="line-height: 1.6;">$</span>timeout service&#x4E5F;&#x7C7B;&#x4F3C;&#xFF0C;&#x6709;&#x540C;&#x6837;&#x7684;&#x65B9;&#x6CD5;&#x5BF9;&#x4ED8;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#x3002;</p><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">Promise not resolve</h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5728;Angular JS&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5F80;&#x5F80;&#x8C03;&#x7528;<span style="line-height: 1.6;">$</span>q service&#x6765;&#x4F7F;&#x7528;Promise&#xFF0C;&#x800C;<span style="line-height: 1.6;">$</span>q.defer().promise&#x53EA;&#x5728;<span style="line-height: 1.6;">$</span>scope&#x7684;digest cycle&#x624D;&#x4F1A;&#x5224;&#x5B9A;resolve&#x8FD8;&#x662F;reject&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x89E6;&#x53D1;<span style="line-height: 1.6;">$</span>q&#x4EA7;&#x751F;&#x7684;promise&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x7684;<span style="line-height: 1.6;">$</span>scope.<span style="line-height: 1.6;">$</span>apply()&#x6216;&#x8005;<span style="line-height: 1.6;">$</span>scope.<span style="line-height: 1.6;">$</span>digest()&#x3002;stack overflow&#x4E2D;&#x4E5F;&#x6709;&#x5927;&#x628A;&#x7C7B;&#x4F3C;&#x95EE;&#x9898;&#x7684;&#x89E3;&#x7B54;&#x3002;&#x5177;&#x4F53;&#x4E5F;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x8FD9;&#x7BC7;&#x535A;&#x5BA2;&#xFF0C;&#x8BB2;&#x5F97;&#x5F88;&#x900F;&#x5F7B;&#xFF1A;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;"><a href="http://www.bradoncode.com/blog/2015/07/13/unit-test-promises-angualrjs-q/" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Unit Testing with $q Promises in AngularJS</a></li></ul><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5728;Angular JS&#x4E2D;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;Promise&#xFF0C;&#x4F8B;&#x5982;: <code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">var promise = new Promise(resolve, reject)</code>&#x3002;&#x4F46;&#x662F;&#x8C8C;&#x4F3C;&#xFF0C;&#x6807;&#x51C6;&#x7684;Promise&#x548C;\q&#x517C;&#x5BB9;&#x7684;&#x5E76;&#x4E0D;&#x5F88;&#x597D;&#xFF0C;&#x4E0B;&#x9762;&#x7684;code&#x5E76;&#x4E0D;&#x4F1A;&#x5DE5;&#x4F5C;&#xFF1A;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> promise = <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$q</span>.all([promise1, promise2])</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$scope</span>.<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">$apply</span>()</div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">promise&#x5E76;&#x4E0D;&#x4F1A;&#x5728;promise1&#x548C;promise2&#x8FD4;&#x56DE;&#x4E4B;&#x540E;&#x8FD4;&#x56DE;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4ED6;&#x6839;&#x672C;&#x5C31;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#xFF0C;&#x76F4;&#x5230;&#x6D4B;&#x8BD5;&#x8D85;&#x65F6;&#x5931;&#x8D25;&#x3002;</p><h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">&#x201C;Unexpected request: GET &#x2026;/.html&#x201D; on Karma tests</h4><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x8FD9;&#x662F;Yaakov&#x5728;&#x89C6;&#x9891;&#x4E2D;&#x63D0;&#x5230;&#x7684;&#x9700;&#x8981;&#x4F7F;&#x7528;<span style="line-height: 1.6;">$</span>templateCache&#x7684;&#x60C5;&#x5F62;&#x3002;Yaakov&#x63D0;&#x5230;&#x7528;karma&#x662F;&#x89E3;&#x51B3;&#x8BE5;&#x95EE;&#x9898;&#x6700;&#x597D;&#x7684;&#x529E;&#x6CD5;&#xFF0C;&#x4F46;&#x662F;&#x56E0;&#x4E3A;&#x89C6;&#x9891;&#x5E76;&#x4E0D;&#x6D89;&#x53CA;&#x4ECB;&#x7ECD;karma&#xFF0C;&#x6240;&#x4EE5;&#x5E76;&#x6CA1;&#x6709;&#x8BF4;&#x5E94;&#x8BE5;&#x600E;&#x4E48;&#x505A;&#x3002; <br>&#x5F53;&#x6211;&#x4EEC;&#x7684;karma test&#x52A0;&#x8F7D;&#x4E86;route.js&#xFF0C;&#x5E76;&#x5728;&#x5176;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;component&#xFF0C;&#x5219;&#x6D4B;&#x8BD5;&#x5728;&#x5B9E;&#x4F8B;&#x5316;&#x8BE5;Angular component&#x7684;&#x65F6;&#x5019;&#x56DE;&#x53BB;&#x7528;<span style="line-height: 1.6;">$</span>http service&#x6765;GET&#x8BE5;template html&#x6587;&#x4EF6;&#xFF0C;&#x4E8E;&#x662F;&#x4EA7;&#x751F;&#x4E86;&#x8BE5;unexpected request&#x9519;&#x8BEF;&#x3002;Yaakov&#x5728;&#x6559;&#x7A0B;&#x4E2D;&#x7684;&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#x662F;&#xFF0C;&#x901A;&#x8FC7;&#x4E00;&#x6B21;&#x771F;&#x6B63;&#x7684;AJAX&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x8BF7;&#x6C42;&#x8BE5;html&#xFF0C;&#x5E76;&#x5C06;&#x4E4B;&#x5B58;&#x5165;<span style="line-height: 1.6;">$</span>templateCache&#x4E2D;&#xFF0C;&#x4E4B;&#x540E;&#x5C31;&#x4E0D;&#x4F1A;&#x518D;&#x6709;&#x771F;&#x6B63;&#x7684;GET AJAX&#x4EA7;&#x751F;&#x4E86;&#x3002;&#x5176;&#x5B9E;&#x8FD9;&#x4E00;&#x6BB5;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x914D;&#x7F6E;karma&#x6765;&#x5B9E;&#x73B0;&#x3002;&#x5177;&#x4F53;&#x505A;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">&#x5B89;&#x88C5;ng-html2js&#xFF0C;karma-ng-html2js-preprocessor</li><li style="line-height: 1.6;">&#x4F7F;&#x7528;ng-html2js&#x5C06;&#x5BF9;&#x5E94;&#x7684;template html&#x8F6C;&#x6210;js&#x6A21;&#x5757;&#xFF0C;&#x5E76;&#x5728;&#x6D4B;&#x8BD5;&#x4EE3;&#x7801;&#x4E2D;&#x5F15;&#x5165;&#x3002;</li></ul><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x770B;&#x4E0B;&#x9762;&#x5177;&#x4F53;&#x4EE3;&#x7801; <br>karma.conf.js</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// list of files / patterns to load in the browser</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">files</span>: [</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;../html/templates/*.html&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  ...</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">],</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// preprocess matching files before serving them to the browser</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">preprocessors</span>: &#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;../html/templates/home.template.html&apos;</span>: [<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;ng-html2js&apos;</span>]</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">ngHtml2JsPreprocessor</span>: &#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">moduleName</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;templates&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">stripPrefix</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;.*/&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">prependPrefix</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;/html/templates/&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;,</div></div></div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">test.js</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">describe(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">function</span>()&#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  beforeEach(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">module</span>(&apos;templates&apos;))</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;)</div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x7279;&#x522B;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x5BF9;ng-html2js&#x7684;&#x914D;&#x7F6E;</p><pre style="font-family: &apos;Source Code Pro&apos;,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">ngHtml2JsPreprocessor</span>: &#123;</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">moduleName</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;templates&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  stripPrefix: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;.*/&apos;</span>,</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  prependPrefix: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&apos;/html/templates/&apos;</span></div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&#125;,</div></code></pre><p style="margin: 0 0 1.1em; line-height: 1.6;">&#x5F53;&#x6CA1;&#x6709;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">stripPrefix</code>&#x9009;&#x9879;&#x65F6;&#xFF0C;&#x901A;&#x8FC7;Chrome debug&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6240;&#x6709;&#x7684;template&#x90FD;&#x88AB;&#x8F6C;&#x5316;&#x6210;&#x4E86;js&#x6A21;&#x5757;&#xFF0C;&#x4F46;&#x662F;&#x5176;&#x6A21;&#x5757;&#x540D;&#x662F;&#x7C7B;&#x4F3C;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">c:\path\to\template\template.html</code>&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x800C;&#x6211;&#x5728;route&#x4E2D;&#x7684;&#x6307;&#x5B9A;&#x8DEF;&#x5F84;&#x662F;web&#x8DEF;&#x5F84;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">templateUrl: &apos;/html/templates/home.template.html&apos;</code>&#x3002;&#x5C31;&#x5BF9;&#x4E0D;&#x4E0A;&#x53F7;&#x4E86;&#x3002;&#x505A;&#x6CD5;&#x662F;&#x901A;&#x8FC7;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">stripPrefix</code>&#x5C06;&#x6240;&#x6709;&#x7684;&#x524D;&#x7F00;&#x5168;&#x90E8;&#x5265;&#x53BB;&#xFF0C;&#x7136;&#x540E;&#x7528;<code style="font-family: &apos;Source Code Pro&apos;,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">prependPrefix</code>&#x52A0;&#x4E0A;&#x9700;&#x8981;&#x7684;&#x524D;&#x7F00;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5DE5;&#x4F5C;&#x4E86;&#x3002;&#x7F51;&#x4E0A;&#x6709;&#x5F88;&#x591A;&#x5E16;&#x5B50;&#x8BA8;&#x8BBA;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#x5217;&#x4E24;&#x4E2A;&#x6709;&#x542F;&#x53D1;&#x6027;&#x7684;&#xFF1A;</p><ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;"><a href="https://stackoverflow.com/questions/15214760/unit-testing-angularjs-directive-with-templateurl" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Unit Testing AngularJS directive with templateUrl</a></li><li style="line-height: 1.6;"><a href="https://stackoverflow.com/questions/22869668/karma-unexpected-request-when-testing-angular-directive-even-with-ng-html2js" target="_blank" style="background: transparent; color: #1980e6; text-decoration: none;">Karma &#x2018;Unexpected Request&#x2019; when testing angular directive, even with ng-html2js</a></li></ul></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%20Angular%20JS%20-%20unit%20test%0A@%28myblog%29%5Bangular%2C%20unittest%5D%0A%u524D%u7AEF%u4EE3%u7801%u4E00%u76F4%u6CA1%u6709%u505Aunit%20testing%uFF0C%u4E5F%u4E0D%u77E5%u9053%u600E%u4E48%u505A%u3002%u5728Yaakov%20Chaikin%u7684%5BCoursera%u8BFE%u7A0B%5D%28https%3A//www.coursera.org/learn/single-page-web-apps-with-angularjs/home/week/5%29%u4E2D%uFF0C%u7B2C%u4E94%u7AE0%u6B63%u597D%u4ECB%u7ECD%u4E86%u76F8%u5173%u5185%u5BB9%u3002%u6240%u4EE5%u5C31%u987A%u4FBF%u5728%u81EA%u5DF1%u7684%u9879%u76EE%u4E2D%u5B9E%u8DF5%u4E86%u4E00%u628A%u3002%u65E0%u6570%u6B21%u7684%u5B9E%u8DF5%u8BC1%u660E%uFF0C%u770B%u5F97%u5934%u5934%u662F%u9053%uFF0C%u5199%u8D77%u6765%u5C31%u5230%u5904%u662F%u5751%u3002%u5C0F%u5C0F%u7684%u5185%u5BB9%uFF0C%u7740%u5B9E%u82B1%u4E86%u4E0D%u5C11%u65F6%u95F4%u3002%0A%0A%u9488%u5BF9%u524D%u7AEF%u7684%u4EE3%u7801%uFF0C%u7F51%u4E0A%u91C7%u7528%u7684%u6D4B%u8BD5%u6846%u67B6%u5927%u591A%u662Fkarma%20+%20jasmine%20+%20chai%u3002%u56E0%u4E3A%u6211%u4E4B%u524D%u5728%u540E%u7AEF%u4EE3%u7801%u7684%u6D4B%u8BD5%u4E2D%u591A%u91C7%u7528mocha%20+%20should%20+%20sinon%u3002%u6240%u4EE5%u672C%u6B21%u5B9E%u8DF5%uFF0C%u4ECD%u7136%u7231%u91C7%u7528mocha%u6846%u67B6%uFF0C%u6765%u642D%u914Dkarma%u4F7F%u7528%u3002%0A%0Akarma%u662F%u4E00%u4E2A%u81EA%u52A8%u5316%u6D4B%u8BD5%u6846%u67B6%u3002%u56E0%u5176%u4E30%u5BCC%u7684%u914D%u7F6E%u9009%u9879%uFF0C%u826F%u597D%u7684%u6269%u5C55%u6027%u80FD%uFF0C%u88AB%u5E7F%u6CDB%u5E94%u7528%uFF0C%u5C24%u5176%u662F%u5728%u524D%u7AEF%u3002%u56E0%u4E3A%u524D%u7AEF%u8981%u9488%u5BF9%u5404%u79CD%u7248%u672C%u7684%u6D4F%u89C8%u5668%uFF0C%u5404%u79CD%u6846%u67B6%uFF0C%u5982%u679C%u5168%u90E8%u9760%u624B%u52A8%u53BB%u9002%u914D%uFF0C%u57FA%u672C%u4E0D%u592A%u53EF%u80FD%u3002%u6240%u4EE5%u5927%u5BB6%u90FD%u7528karma%u4E86%u3002%0A%23%23%20karma%20setup%0A%u57FA%u672C%u914D%u7F6E%u53C2%u8003%5B%u524D%u7AEF%u5355%u5143%u6D4B%u8BD5%u4E4BKarma%u73AF%u5883%u642D%u5EFA%5D%28https%3A//segmentfault.com/a/1190000006895064%29%0A%0A%u914D%u7F6E%u6587%u4EF6%u7B80%u5355%u5982%u4E0B%uFF1A%0A%60%60%60javascript%0Amodule.exports%20%3D%20function%28config%29%20%7B%0A%20%20config.set%28%7B%0A%0A%20%20%20%20//%20base%20path%20that%20will%20be%20used%20to%20resolve%20all%20patterns%20%28eg.%20files%2C%20exclude%29%0A%20%20%20%20basePath%3A%20%27%27%2C%0A%0A%0A%20%20%20%20//%20frameworks%20to%20use%0A%20%20%20%20//%20available%20frameworks%3A%20https%3A//npmjs.org/browse/keyword/karma-adapter%0A%20%20%20%20frameworks%3A%20%5B...%5D%2C%0A%0A%0A%20%20%20%20//%20list%20of%20files%20/%20patterns%20to%20load%20in%20the%20browser%0A%20%20%20%20files%3A%20%5B%0A%20%20%20%20%20%20%27...%27%2C%0A%20%20%20%20%20%20%7Bpattern%3A%20%27...%27%7D%0A%20%20%20%20%5D%2C%0A%0A%0A%20%20%20%20//%20list%20of%20files%20to%20exclude%0A%20%20%20%20exclude%3A%20%5B%0A%20%20%20%20%5D%2C%0A%0A%0A%20%20%20%20//%20preprocess%20matching%20files%20before%20serving%20them%20to%20the%20browser%0A%20%20%20%20//%20available%20preprocessors%3A%20https%3A//npmjs.org/browse/keyword/karma-preprocessor%0A%20%20%20%20preprocessors%3A%20%7B%0A%20%20%20%20%7D%2C%0A%0A%0A%20%20%20%20//%20test%20results%20reporter%20to%20use%0A%20%20%20%20//%20possible%20values%3A%20%27dots%27%2C%20%27progress%27%0A%20%20%20%20//%20available%20reporters%3A%20https%3A//npmjs.org/browse/keyword/karma-reporter%0A%20%20%20%20reporters%3A%20%5B%27progress%27%5D%2C%0A%0A%0A%20%20%20%20//%20web%20server%20port%0A%20%20%20%20port%3A%209876%2C%0A%0A%0A%20%20%20%20//%20enable%20/%20disable%20colors%20in%20the%20output%20%28reporters%20and%20logs%29%0A%20%20%20%20colors%3A%20true%2C%0A%0A%0A%20%20%20%20//%20level%20of%20logging%0A%20%20%20%20//%20possible%20values%3A%20config.LOG_DISABLE%20%7C%7C%20config.LOG_ERROR%20%7C%7C%20config.LOG_WARN%20%7C%7C%20config.LOG_INFO%20%7C%7C%20config.LOG_DEBUG%0A%20%20%20%20logLevel%3A%20config.LOG_INFO%2C%0A%0A%0A%20%20%20%20//%20enable%20/%20disable%20watching%20file%20and%20executing%20tests%20whenever%20any%20file%20changes%0A%20%20%20%20autoWatch%3A%20true%2C%0A%0A%0A%20%20%20%20//%20start%20these%20browsers%0A%20%20%20%20//%20available%20browser%20launchers%3A%20https%3A//npmjs.org/browse/keyword/karma-launcher%0A%20%20%20%20browsers%3A%20%5B%27...%27%5D%2C%0A%0A%0A%20%20%20%20//%20Continuous%20Integration%20mode%0A%20%20%20%20//%20if%20true%2C%20Karma%20captures%20browsers%2C%20runs%20the%20tests%20and%20exits%0A%20%20%20%20singleRun%3A%20false%2C%0A%0A%20%20%20%20//%20Concurrency%20level%0A%20%20%20%20//%20how%20many%20browser%20should%20be%20started%20simultaneous%0A%20%20%20%20concurrency%3A%20Infinity%2C%0A%0A%20%20%20%20//%20Which%20plugins%20to%20enable%0A%20%20%20%20plugins%3A%20%5B%5D%0A%20%20%7D%29%0A%7D%20%0A%60%60%60%0A%0A%u7B80%u5355%u7684%u89E3%u91CA%u76EE%u524D%u7528%u5230%u7684%u9009%u9879%uFF1A%0A-%20frameworks%3A%20%u4F7F%u7528%u5230%u7684%u6846%u67B6%uFF0C%u6240%u6709%u4F7F%u7528%u5230%u7684%uFF0C%u8981%u5728%u4E0B%u9762plugins%u4E2D%u5217%u660E%u3002%u6BD4%u5982%uFF1Aframeworks%u4E2D%u5305%u542Bmocha%uFF0C%u5219plugins%u4E0B%u5C31%u8981%u5305%u542Bkarma-mocha%0A-%20basePath%2C%20files%2C%20exclude%3A%20%u8FD9%u4E09%u4E2A%u6307%u660E%u4E86karma%u8981%u52A0%u8F7D%u7684JS%u6587%u4EF6%0A%09-%20basePath%uFF1A%u57FA%u7840%u76EE%u5F55%uFF0C%u4F1A%u76F4%u63A5%u63D2%u5165%u5230files%uFF0Cexclude%u6307%u5B9A%u7684%u8DEF%u5F84%u524D%u9762%0A%09-%20files%uFF1A%u52A0%u8F7D%u6587%u4EF6%uFF0C%u652F%u6301%u901A%u914D%u7B26%u548C%u6B63%u5219%u5F0F%uFF0C%u901A%u8FC7%u5927%u62EC%u53F7%u8FD8%u53EF%u4EE5%u6DFB%u52A0%u914D%u7F6E%u9009%u9879%u3002%u901A%u914D%u7B26%27%5C*%5C*%27%u8868%u793A%u6240%u6709%u76EE%u5F55%uFF0C%27%5C*%27%u8868%u793A%u6240%u6709%u6587%u4EF6%uFF0C%27%5C*%5C*/*%27%u8868%u793A%u5176%u4E0B%u6240%u6709%u76EE%u5F55%u6240%u6709%u6587%u4EF6%u3002%0A%09-%20exclude%3A%20%u53EF%u4EE5%u5254%u9664files%u4E2D%u4E0D%u60F3%u8981%u7684%u6587%u4EF6%0A-%20browsers%uFF1A%u4F7F%u7528%u7684%u6D4F%u89C8%u5668%uFF0C%u5982%u679C%u60F3%u8981headless%u6D4B%u8BD5%u5219%u53EF%u7528PhantomJS%0A%0A%23%23%23%20karma%20with%20ES6%0A%u56E0%u4E3APhantomJS%u4E0D%u652F%u6301ES6%u8BED%u6CD5%28%u7F51%u4E0A%u8BF4%uFF0CPhantomJS%u751A%u81F3%u5BF9ES5%u7684%u652F%u6301%u90FD%u4E0D%u662F%u5F88%u597D%29%uFF0C%u6240%u4EE5karma%u8981%u6D4B%u8BD5%u5305%u542BES6%u8BED%u6CD5%u7684%u4EE3%u7801%uFF0C%u8FD8%u9700%u8981%u4E00%u756A%u914D%u7F6E%u3002%u7F51%u4E0A%u76F8%u5173%u7684%u5E16%u5B50%u5F88%u591A%uFF0C%u5217%u4E3E%u5982%u4E0B%uFF1A%0A-%20%5BTesting%20ES6%20with%20Karma%2C%20RequireJS%2C%20and%20Angular%5D%28http%3A//radify.io/blog/announcing-karma-es6-shim/%29%20%20-%20karma-es6-shim%20%0A-%20%5BHow%20to%20Start%20Writing%20Your%20AngularJS%20Tests%20in%20ES6%5D%28https%3A//www.barbarianmeetscoding.com/blog/2015/11/16/how-to-start-writing-your-angular-js-tests-in-es6/%29%20-%20karma-babel-preprocessor%0A-%20%5BWriting%20Jasmine%20Unit%20Tests%20In%20ES6%5D%28http%3A//www.syntaxsuccess.com/viewarticle/writing-jasmine-unit-tests-in-es6%29%20-%20webpack%0A%0A%u603B%u7684%u6765%u8BF4%uFF0C%u6709%u8FD9%u4E48%u51E0%u79CD%u89E3%u51B3%u65B9%u6848%uFF1A%0A-%20karma-es6-shim%0A-%20karma-babel-preprocessor%0A-%20webpack%0A-%20SlimerJS%0A%u524D%u4E09%u79CD%u6709%u70B9%u590D%u6742%uFF0C%u76EE%u524D%u7684%u6211%u7684%u6280%u672F%u6808%u8FD8%u65E0%u6CD5%u7406%u89E3%u3002%u6700%u7EC8%u9009%u62E9%u6700%u7B80%u5355%u7684SlimerJS%u3002%u5728Linux%u4E0A%u53EF%u4EE5%u901A%u8FC7Xvfb%u505A%u5230headless%u6D4B%u8BD5%uFF0CWindows%u4E0A%u5C31%u8FD9%u6837%u5427%uFF0C%u8DF3%u4E2A%u7A97%u53E3%u4E5F%u4E0D%u662F%u4EC0%u4E48%u5927%u4E8B%u3002%0A%0A%23%23%23%20Debug%20karma%20test%20using%20Chrome%0A%u8FD9%u4E2A%u5728%u521D%u5B66%u7684%u65F6%u5019%u8FD8%u662F%u5F88%u91CD%u8981%u7684%uFF0C%u5982%u679C%u6CA1%u6709%u8FD9%u4E2A%u5DE5%u5177%uFF0C%u6050%u6015%u6211%u4E5F%u8DF3%u4E0D%u51FA%u81EA%u5DF1%u7ED9%u81EA%u5DF1%u6316%u7684%u5927%u5751%u3002%0A%u53C2%u8003%u94FE%u63A5%uFF1A%5BDebugging%20Karma%20Unit%20Tests%5D%28https%3A//glebbahmutov.com/blog/debugging-karma-unit-tests/index.html%29%0A%u6309%u7167%u4E0A%u9762%u7684%u6B65%u9AA4%u6253%u5F00%u8C03%u8BD5%u9875%u9762%u548CChrome%20Dev%20Tool%u9875%u9762%uFF0C%u5237%u65B0%u9875%u9762%u5373%u53EF%u91CD%u65B0%u52A0%u8F7D%u4EE3%u7801%u5E76%u89E6%u53D1%u65AD%u70B9%u3002%0A%u5C06%u547D%u4EE4%u884C%u5199%u5165package.json%uFF0C%u4EE5%u540E%u8C03%u7528npm%u5C31%u53EF%u4EE5%u65B9%u4FBF%u7684%u6253%u5F00%u8BE5%u8C03%u8BD5%u5DE5%u5177%u3002%0A%60%60%60%0A%7B%0A...%0A%20%20%22scripts%22%3A%20%7B%0A%20%20%20%20%22start%22%3A%20%22node%20./bin/www%22%2C%0A%20%20%20%20%22karma-debug%22%3A%20%22cd%20public/js%20%26%26%20karma%20start%20--browsers%3DChrome%20--single-run%3Dfalse%20--debug%22%0A%20%20%7D%2C%20%0A%20%20...%0A%7D%0A%60%60%60%0A%23%23%20ngMock%0AngMock%u4E2D%u4E24%u4E2A%u6700%u91CD%u8981%u7684%u5173%u952E%u8BCD%u5C31%u662F%uFF1Amodule%2C%20inject%u3002%u53EF%u4EE5%u53C2%u8003%u8FD9%u4E2A%u4EBA%u7684%u535A%u5BA2%uFF1A%0A-%20%5BngMock%20Fundamentals%20for%20AngularJS%20-%20Understanding%20Inject%5D%28http%3A//www.bradoncode.com/blog/2015/05/27/ngmock-fundamentals-angularjs-testing-inject/%29%0A-%20%5BngMock%20Fundamentals%20for%20AngularJS%20Unit%20Testing%20-%20Understanding%20Module%5D%28http%3A//www.bradoncode.com/blog/2015/05/24/ngmock-fundamentals-angularjs-unit-testing/%29%0A%0AngMock%u901A%u8FC7module%u52A0%u8F7D%u5DF2%u7ECF%u5B9A%u4E49%u4E86%u7684%u6A21%u5757%uFF0C%u6216%u8005%u5B9A%u4E49%u533F%u540Dmodule%u5E76%u63D0%u4F9B%u65B0%u7684service%uFF0C%u6216%u8005%u590D%u5199%u5DF2%u5B58%u5728%u7684service%u3002module%u53EA%u662F%u5C06%u540D%u5B57%uFF0C%u4EE5%u53CA%u5BF9%u5E94%u4F4D%u7F6E%u5B58%u5165%u4E00%u4E2A%u6570%u7EC4%u3002inject%u5C06%u771F%u6B63%u7684%u52A0%u8F7D%u6240%u6709module%u63D0%u4F9B%u7684service%uFF0C%u5E76%u89E3%u51B3%u4F9D%u8D56%u5173%u7CFB%uFF0C%u8FD8%u53EF%u4EE5%u5C06%u76F8%u5E94%u7684service%u5BFC%u51FA%u5230test%20case%u4E2D%u4F7F%u7528%u3002%u5176%u5B9EngMock%u4E5F%u5C31%u662F%u505A%u4E86%u8FD9%u4E24%u4EF6%u4E8B%u60C5%u3002%0A%u4E0B%u9762%u7B80%u5355%u4ECB%u7ECD%u4E00%u4E9B%u6709%u52A9%u4E8E%u7406%u89E3%u7684%u77E5%u8BC6%u70B9%u3002%0A%23%23%23%20angular.mock.module%0Amodule%u51FD%u6570%u7684%u539F%u578B%u662F%60angular.mock.module%28alias%2C%20obj%2C%20func%29%60%0Amodule%u63A5%u53D7%u4E09%u79CD%u53C2%u6570%u7C7B%u578B%uFF0C%u6BCF%u4E00%u79CD%u90FD%u53EF%u4EE5%u5355%u72EC%u4F7F%u7528%uFF0C%u7528%u6765%u5B9A%u4E49%u6216%u52A0%u8F7D%u5BF9%u5E94%u6A21%u5757%0A-%20alias%3A%20%u662Fmodule%u540D%u5B57%u5B57%u7B26%u4E32%uFF0C%u53EF%u4EE5%u662F%u5728%u5F85%u6D4B%u4EE3%u7801%u4E2D%u5B9A%u4E49%u7684%uFF0C%u4E5F%u53EF%u4EE5%u662F%u5728%u6D4B%u8BD5%u6587%u4EF6%u4E2D%u5B9A%u4E49%u7684%0A-%20obj%3A%20%u4E00%u4E2A%u666E%u901A%u7684%u5B57%u5178%u7ED3%u6784%uFF0C%u4ED6%u4F1A%u751F%u6210%u4E00%u4E2A%u533F%u540Dmodule%uFF0C%u5176%u4E2D%u7684%u6210%u5458%u4F1A%u88AB%u5B9A%u4E49%u6210%60%24provide.value%28%29%60%0A-%20function%3A%20%u540C%u6837%u662F%u5B9A%u4E49%u4E00%u4E2A%u533F%u540Dmodule%uFF0C%u4E0D%u540C%u7684%u662F%uFF0Cfunction%u53EF%u4EE5%u7528%24provide%u4F5C%u4E3A%u53C2%u6570%uFF0C%u6765%u5B9A%u4E49%u5404%u79CD%u5404%u6837%u7684service%u3002%0A%0A%3E**function%28%29%20vs%20Object**%0A%0A%3EThe%20examples%20we%20used%20were%20similar%2C%20so%20what%u2019s%20the%20key%20difference%20between%20the%20function%28%29%20and%20Object%20form%3F%20As%20the%20Object%20type%20gets%20added%20as%20a%20%24provider.value%2C%20it%20is%20therefore%20restricted%20to%20the%20capabilities%20of%20the%20value%20service%2C%20most%20importantly%20that%20a%20value%20service%20cannot%20be%20injected%20with%20other%20services.%0A%0A%u5173%u4E8E%24provide%uFF0C%u53EF%u4EE5%u53C2%u8003%5BAngular%u5B98%u65B9%u6587%u6863%5D%28https%3A//docs.angularjs.org/api/auto/service/%5C%24provide%29%0A%3EThe%20**%5C%24provide**%20service%20has%20a%20number%20of%20methods%20for%20registering%20components%20with%20the%20**%5C%24injector**.%20Many%20of%20these%20functions%20are%20also%20exposed%20on%20angular.Module.%0A%0A%u5B83%u63D0%u4F9B%u4E86%u4E0B%u9762%u7684%u8FD9%u4E9Bservice%0A%0A%3E**provider**%28name%2C%20provider%29%20-%20registers%20a%20service%20provider%20with%20the%20%5C%24injector%0A**constant**%28name%2C%20obj%29%20-%20registers%20a%20value/object%20that%20can%20be%20accessed%20by%20providers%20and%20services.%0A**value**%28name%2C%20obj%29%20-%20registers%20a%20value/object%20that%20can%20only%20be%20accessed%20by%20services%2C%20not%20providers.%0A**factory**%28name%2C%20fn%29%20-%20registers%20a%20service%20factory%20function%20that%20will%20be%20wrapped%20in%20a%20service%20provider%20object%2C%20whose%20%5C%24get%20property%20will%20contain%20the%20given%20factory%20function.%0A**service**%28name%2C%20Fn%29%20-%20registers%20a%20constructor%20function%20that%20will%20be%20wrapped%20in%20a%20service%20provider%20object%2C%20whose%20%5C%24get%20property%20will%20instantiate%20a%20new%20object%20using%20the%20given%20constructor%20function.%0A**decorator**%28name%2C%20decorFn%29%20-%20registers%20a%20decorator%20function%20that%20will%20be%20able%20to%20modify%20or%20replace%20the%20implementation%20of%20another%20service.%0A%0A%23%23%23%20angular.mock.inject%0A%5C%24inject%u662FngMock%u7684%u6838%u5FC3%uFF0C%u770B%u770B%u5B98%u65B9%u7684%u5B9A%u4E49%0A%3EThe%20inject%20function%20wraps%20a%20function%20into%20an%20injectable%20function.%20The%20inject%28%29%20creates%20new%20instance%20of%20%24injector%20per%20test%2C%20which%20is%20then%20used%20for%20resolving%20references.%0A%0Ainject%u5C31%u662F%u5B9A%u4E49%u4E86%u4E00%u4E2Ainjector%uFF0C%u90A3injector%u53C8%u662F%u4EC0%u4E48%0A%3E%5C%24injector%20is%20used%20to%20retrieve%20object%20instances%20as%20defined%20by%20provider%2C%20instantiate%20types%2C%20invoke%20methods%2C%20and%20load%20modules.%0A%0A%5C%24injector%u4E5F%u5C31%u662FAngularJS%u7684%u6838%u5FC3%u3002%u5B83%u63D0%u4F9B%u4E86%u6240%u8C13%u7684%u201CDI%22%20%28Dependency%20Injection%29%u6A21%u5F0F%u3002Angular%u7684%u6838%u5FC3%u4EE3%u7801%u901A%u8FC7%5C%24injector%u6765%u83B7%u53D6%u5BF9%u5E94service%u7684reference%u3002%0A%u6211%u4EEC%u901A%u5E38%u5C06inject%u653E%u5728beforeEach%u91CC%uFF0C%u8FD9%u6837inject%u5C31%u4E3A%u6BCF%u4E2A%u6D4B%u8BD5%u5B9A%u4E49%u4E00%u4E2Ainjector%uFF0C%u4E3A%u8FD9%u4E2Ainjector%u51C6%u5907%u597D%u6240%u6709%u7684service%uFF0C%u5E76%u80FD%u901A%u8FC7%u53C2%u6570%u5C06%u4EFB%u610F%u5DF2%u6709%u7684service%u5BFC%u51FA%u3002%0A%0A%23%23%23%20Test%20controllers%0A%u4E86%u89E3%u4E86%u4E0A%u9762%u7684%u4E24%u4E2A%u91CD%u8981%u7EC4%u4EF6%u4E4B%u540E%uFF0C%u9488%u5BF9%u4E0D%u540C%u7684%u6D4B%u8BD5%u7EC4%u4EF6%u5C31%u5BB9%u6613%u7406%u89E3%u4E86%u3002%0A%u76F4%u63A5%u4E0A%u4EE3%u7801%uFF1A%0A%60%60%60javascript%0Adescribe%28%27main%20controller%27%2C%20function%28%29%20%7B%0A%20%20var%20%24controller%0A%20%20var%20mainCtrl%0A%20%20beforeEach%28%27set%20up%20module%27%2C%20function%28%29%20%7B%0A%20%20%20%20module%28function%20%28%24provide%29%20%7B%0A%20%20%20%20%20%20%24provide.service%28%27MockDataService%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20const%20service%20%3D%20this%0A%20%20%20%20%20%20%20%20service.data%20%3D%20%27test%20data%27%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%7D%29%0A%0A%20%20%20%20module%28%27MainModule%27%29%0A%20%20%7D%29%3B%0A%0A%20%20beforeEach%28%27set%20up%20controller%27%2C%20inject%28function%20%28_%24controller_%2C%20MockDataService%29%20%7B%0A%20%20%20%20%24controller%20%3D%20_%24controller_%0A%20%20%20%20mainCtrl%20%3D%20%24controller%28%27MainController%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20DataService%3A%20MockDataService%0A%20%20%20%20%7D%29%0A%20%20%7D%29%29%20%0A%0A%20%20it%28%27should%20assemble%20print%20page%20URL%20correctly%27%2C%20function%28%29%20%7B%0A%20%20%20%20mainCtrl.getData%28%29.should.equal%28%27test%20data%27%29%0A%20%20%7D%29%3B%0A%7D%29%3B%0A%60%60%60%0A%u8FD9%u91CC%u53EA%u6709%u4E24%u4E2A%u503C%u5F97%u6CE8%u610F%u7684%u5730%u65B9%uFF0C%u5176%u5B9E%u524D%u6587%u4E5F%u90FD%u6709%u63D0%u53CA%u3002%0A1.%20%u7B2C%u4E00%u4E2Amodule%u4E2D%u901A%u8FC7%5C%24provide%u63D0%u4F9B%u4E86%u4E00%u4E2A%u5047%u7684service%uFF0C%u8FD9%u4E2Aservice%u53EF%u4EE5%u901A%u8FC7%u5176%u540D%u5B57%u88ABinject%u3002%0A2.%20inject%u4E2D%u901A%u8FC7%5C_%5C%24controller%5C_%u6765%u5BFC%u51FAcontroller%u7684%u6784%u9020%u51FD%u6570%u3002%u901A%u8FC7%u8FD9%u4E2A%u6784%u9020%u51FD%u6570%u6765%u6784%u9020%u76F8%u5E94%u7684%u5F85%u6D4Bcontroller%uFF0C%u5E76%u4F20%u5165%u5047%u7684service%u8FBE%u5230mock%u7684%u76EE%u7684%u3002%0A%0A%23%23%23%20Test%20services%0A%u4ECD%u7136%u76F4%u63A5%u4E0A%u4EE3%u7801%uFF1A%0A%60%60%60%20javascript%0Aangular.module%28%27PrinterData%27%2C%20%5B%5D%29%0A.config%28%5B%27%24locationProvider%27%2C%20function%28%24locationProvider%29%20%7B%0A%20%20%24locationProvider.html5Mode%28true%29%3B%0A%7D%5D%29%3B%0A%60%60%60%0A%60%60%60javascript%0Adescribe%28%27printer%20data%20service%27%2C%20function%28%29%20%7B%0A%20%20var%20%24httpBackend%0A%20%20var%20PrinterDataService%0A%20%20beforeEach%28function%28%29%7B%0A%20%20%20%20module%28function%20%28%24provide%29%20%7B%0A%20%20%20%20%20%20%24provide.provider%28%27%24location%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20const%20provider%20%3D%20this%0A%20%20%20%20%20%20%20%20const%20location%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20location.search%20%3D%20function%20%28%29%7B%0A%20%20%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20id%3A%20%27test%20id%27%2C%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20provider.html5Mode%20%3D%20sinon.stub%28%29%0A%20%20%20%20%20%20%20%20provider.%24get%20%3D%20sinon.stub%28%29.returns%28location%29%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%7D%29%0A%20%20%7D%29%3B%0A%20%20beforeEach%28function%28%29%20%7B%0A%20%20%20%20module%28%27Data%27%29%0A%20%20%20%20inject%28function%20%28%24injector%29%20%7B%0A%20%20%20%20%20%20%24httpBackend%20%3D%20%24injector.get%28%27%24httpBackend%27%29%0A%20%20%20%20%20%20DataService%20%3D%20%24injector.get%28%27DataService%27%29%0A%20%20%20%20%7D%29%0A%20%20%7D%29%3B%0A%0A%20%20it%28%27should%20update%20if%20succeeds%27%2C%20function%28done%29%20%7B%0A%20%20%20%20%24httpBackend.whenGET%28/.*/%29%0A%20%20%20%20%20%20.respond%28%7B%0A%20%20%20%20%20%20%20%20status%3A%20%27ready%27%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20DataService.getStatus%28%29.then%28function%20%28data%29%20%7B%0A%20%20%20%20%20%20data.should.deepEqual%28%7B%0A%20%20%20%20%20%20%20%20status%3A%20%27ready%27%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20done%28%29%0A%20%20%20%20%7D%29.catch%28function%20%28err%29%20%7B%0A%20%20%20%20%20%20should.not.exist%28err%29%0A%20%20%20%20%7D%29%0A%20%20%20%20%0A%20%20%20%20%24httpBackend.flush%28%29%3B%0A%20%20%7D%29%3B%0A%7D%29%0A%60%60%60%0A%u4E0B%u9762%u7F57%u5217%u4E00%u4E9B%u5B9E%u9645%u4F7F%u7528%u4E2D%u78B0%u5230%u7684%u4E00%u4E9B%u95EE%u9898%uFF0C%u4EE5%u53CA%u81EA%u5DF1%u7684%u4E00%u4E9B%u7406%u89E3%u3002%0A%0A%23%23%23%23%20%u4F7F%u7528%5C%24injector%0A%u6211%u4EEC%u8BF4%u8FC7inject%u51FD%u6570%u5C31%u662F%u7528%u6765%u521B%u5EFA%5C%24injector%uFF0C%u6240%u4EE5%5C%24injector%u4E5F%u662F%u53EF%u4EE5%u76F4%u63A5%u88AB%u5BFC%u51FA%u4F7F%u7528%u7684%u3002%u8FD9%u65F6%u9700%u8981%u4EC0%u4E48service%uFF0C%u5C31%u53EF%u4EE5%u76F4%u63A5%u8C03%u7528%5C%24injector.get%u3002%u4E3A%u4EC0%u4E48%u4E0D%u76F4%u63A5%u901A%u8FC7%u53C2%u6570%u6765inject%u5462%uFF1F%u5F53%u7136%u662F%u56E0%u4E3A%u53C2%u6570%u592A%u957F%u4E86%uFF0C%u4E0D%u597D%u770B%u3002%u3002%u3002%0A%23%23%23%23%20mock%20%5C%24http%0A%u4E3A%u4E86%u6D4B%u8BD5%u7A33%u5B9A%u6027%uFF0C%u6211%u4EEC%u5728unit%20test%u4E2D%u5E76%u4E0D%u771F%u6B63%u7684%u8BBF%u95EE%u670D%u52A1%u5668%uFF0C%u800C%u901A%u5E38%u91C7%u7528%u5047%u7684%u670D%u52A1%u5668%u54CD%u5E94%u6765mock%u3002%u8FD9%u5C31%u9700%u8981%u7528%u5230%5C%24httpBackend%20service%u3002%u90A3%u4E48%5C%24http%u548C%5C%24httpBackend%u4E4B%u95F4%u7684%u5173%u7CFB%u662F%u4EC0%u4E48%uFF1F%0A%3EHTTP%20backend%20used%20by%20the%20service%20that%20delegates%20to%20XMLHttpRequest%20object%20or%20JSONP%20and%20deals%20with%20browser%20incompatibilities.%0AYou%20should%20never%20need%20to%20use%20this%20service%20directly%2C%20instead%20use%20the%20higher-level%20abstractions%3A%20%5C%24http%20or%20%5C%24resource.%0ADuring%20testing%20this%20implementation%20is%20swapped%20with%20mock%20%24httpBackend%20which%20can%20be%20trained%20with%20responses.%0A%0A%u5177%u4F53%u505A%u6CD5%uFF0C%u4E0A%u9762%u7684%u4EE3%u7801%u4E2D%u5DF2%u6709%uFF0C%u8282%u5F55%u5982%u4E0B%uFF1A%0A%60%60%60javascript%0AbeforeEach%28function%28%29%20%7B%0A%20%20%20%20module%28%27Data%27%29%0A%20%20%20%20inject%28function%20%28%24injector%29%20%7B%0A%20%20%20%20%20%20%24httpBackend%20%3D%20%24injector.get%28%27%24httpBackend%27%29%0A%20%20%20%20%20%20DataService%20%3D%20%24injector.get%28%27DataService%27%29%0A%20%20%20%20%7D%29%0A%20%20%7D%29%3B%0A%0A%20%20it%28%27should%20update%20if%20succeeds%27%2C%20function%28done%29%20%7B%0A%20%20%20%20%24httpBackend.whenGET%28/.*/%29%0A%20%20%20%20%20%20.respond%28%7B%0A%20%20%20%20%20%20%20%20status%3A%20%27ready%27%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20DataService.getStatus%28%29.then%28function%20%28data%29%20%7B%0A%20%20%20%20%20%20data.should.deepEqual%28%7B%0A%20%20%20%20%20%20%20%20status%3A%20%27ready%27%0A%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20done%28%29%0A%20%20%20%20%7D%29.catch%28function%20%28err%29%20%7B%0A%20%20%20%20%20%20should.not.exist%28err%29%0A%20%20%20%20%7D%29%0A%20%20%20%20%0A%20%20%20%20%24httpBackend.flush%28%29%3B%0A%20%20%7D%29%3B%0A%60%60%60%0A%u901A%u8FC7%60%24httpBackend.wheGET%28...%29.respond%28...%29%60%u6765%u8BBE%u7F6Emock%20response%u3002%60whenGET%60%u8FD8%u652F%u6301%u6B63%u5219%u5F0F%u3002%0A%u8C03%u7528%u5B8C%u8BF7%u6C42%u51FD%u6570%u540E%u8981%u8BB0%u5F97%60%24httpBackend.flush%28%29%60%u5C06%u8BF7%u6C42%u771F%u6B63%u7684%u53D1%u51FA%u3002%u5426%u5219%u8BF7%u6C42%u5E76%u4E0D%u4F1A%u53D1%u51FA%uFF0C%u76F4%u5230%u8C03%u7528%60flush%28%29%60%u51FD%u6570%uFF0C%u6216%u8005%u6D4B%u8BD5%u8D85%u65F6%u5931%u8D25%u3002%0A%0A%23%23%23%23%20%u5982%u4F55mock%20%5C%24location%20%26%20%5C%24locationProvider%0A%u5F88%u60ED%u6127%u7684%u8BF4%uFF0C%u5728%u8FD9%u4E2A%u95EE%u9898%u4E0A%u6211%u82B1%u4E86%u5F88%u4E45%u5F88%u4E45%u7684%u65F6%u95F4%uFF0C%u641C%u7D22%u4E86%u5927%u91CF%u7684google%u7F51%u9875%uFF0C%u6700%u540E%u8FD8%u662F%u4F9D%u9760chrome%u8FFD%u8E2Aangular%u6838%u5FC3%u4EE3%u7801%u624D%u53D1%u73B0%u539F%u6765%u662F%u81EA%u5DF1%u7ED9%u81EA%u5DF1%u6316%u7684%u5751%uFF0C%u5BF9service%2C%20factory%u548Cprovider%u7406%u89E3%u4E0D%u900F%u5F7B%u3002%0A%u9996%u5148%u6765%u5C31%u4E8B%u8BBA%u4E8B%uFF0C%u8BF4%u4E00%u4E0B%u5230%u5E95%u600E%u4E48%u5B8C%u6210%u6211%u7684%u8FD9%u4E2A%u6D4B%u8BD5%u3002%0A%0A%u56E0%u4E3A%u6211%u8981%u6D4B%u8BD5DataService%uFF0C%u800CDataService%u5B9A%u4E49%u5728Data%20moduleDataService%u8C03%u7528%u4E86%5C%24location%20service%u3002%u9700%u8981%u5C06%u4E4Bmock%u6389%u3002%u6700%u7B80%u5355%u7684%u60F3%u6CD5%u5C31%u662F%u901A%u8FC7inject%u6765%u83B7%u5F97%5C%24location%20service%20reference%u3002%u5E76%u901A%u8FC7sinon.stub%u6765%u8BBE%u7F6E%u9700%u8981%u7684%u8FD4%u56DE%u503C%u3002%0A%0A%60%60%60%0Ainject%28function%20%28%24injector%2C%20%24location%29%20%7B%0A%20%20sinon.stub%28%24location%2C%20%27search%27%29.returns%28%7B%0A%20%20%20%20id%3A%20%27test%20id%27%0A%20%20%7D%29%0A%20%20DataService%20%3D%20%24injector.get%28%27DataService%27%29%0A%7D%29%0A%60%60%60%0A%0A%u4F46%u662F%u6211%u5012%u9709%u50AC%u7684%uFF0C%u7ADF%u7136%u662F%u7528%5C%24provide%u505A%u4E86%uFF1A%0A%60%60%60%0Amodule%28function%20%28%24provide%29%20%7B%0A%20%20%24provide.service%28%27%24location%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20const%20location%20%3D%20this%0A%20%20%20%20location.search%20%3D%20sinon.stub%28%29.returns%28%7B%0A%20%20%20%20%20%20device_id%3A%20%27test%20id%27%2C%0A%20%20%20%20%7D%29%0A%20%20%7D%29%0A%7D%29%0A%60%60%60%0A%u8FD9%u6837%u5C31%u4F1A%u6709%u95EE%u9898%u4E86%uFF0C%u5F53ngMock%u52A0%u8F7D%u8FD9%u4E2A%u6A21%u5757%u7684%u65F6%u5019%uFF0C%u4F1A%u5148%u5B9A%u4E49%u4E00%u4E2A%5C%24locationProvider%uFF0C%u8FD9%u5C31%u4F1A%u8986%u76D6%u5176%u81EA%u5E26%u7684%5C%24locationProvider%u3002%u800C%u5982%u4E0B%u7684module.config%u65B9%u6CD5%u4E2D%u5BF9%5C%24locationProvider%u7684%u64CD%u4F5C%u5C31%u4F1A%u51FA%u73B0%u95EE%u9898%uFF1A%0A%60%60%60%0Aangular.module%28%27PrinterData%27%2C%20%5B%5D%29%0A.config%28%5B%27%24locationProvider%27%2C%20function%28%24locationProvider%29%20%7B%0A%20%20%24locationProvider.html5Mode%28true%29%3B%0A%7D%5D%29%3B%0A%60%60%60%0A%u56E0%u4E3A%u65B0%u5B9A%u4E49%u7684%5C%24locationProvider%u4E2D%u6CA1%u6709html5Mode%u6210%u5458%u3002%u4E8E%u662F%u60F3%u4E86%u5404%u79CD%u529E%u6CD5%u6765mock%20%5C%24locationProvider%u3002%u7ED3%u679C%u56E0%u4E3A%u5BF9service%uFF0Cfactory%uFF0Cprovider%u7684%u7406%u89E3%u4E0D%u6B63%u786E%uFF0C%u90FD%u5931%u8D25%u4E86%u3002%u653E%u4E00%u6BB5%u9519%u8BEF%u7684%u4EE3%u7801%uFF1A%0A%60%60%60%0AbeforeEach%28function%28%29%7B%0A%20%20module%28function%20%28%24provide%29%20%7B%0A%20%20%20%20%24provide.service%28%27%24locationProvider%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20const%20location%20%3D%20this%0A%20%20%20%20%20%20location.html5Mode%20%3D%20function%28%29%7B%7D%0A%20%20%20%20%7D%29%0A%20%20%20%20%24provide.factory%28%27%24location%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20const%20locationProvider%20%3D%20this%0A%20%20%20%20%20%20locationProvider.html5Mode%20%3D%20function%28%29%7B%7D%0A%20%20%20%20%7D%29%0A%7D%29%0A%60%60%60%0A%u7B2C%u4E00%u4E2A%u7528%5C%24provide.service%u4F1A%u5B9A%u4E49%u4E00%u4E2A%5C%24locationProviderProvider%0A%u7B2C%u4E8C%u4E2A%u7528%5C%24provide.factory%u5B9A%u4E49%u4E86%u4E00%u4E2A%5C%24locationProvider%uFF0C%u4F46%u662F%u6CA1%u6709%u8FD4%u56DE%uFF0C%u6240%u4EE5%5C%24location%20service%u4E0D%u4F1A%u88AB%u5B9E%u4F8B%u5316%uFF0C%u4E5F%u5C31%u6CA1%u6709%5C%24location%20service%u4E86%u3002%0A%u5982%u679C%u60F3%u901A%u8FC7mock%20%5C%24locationProvider%u6765mock%20%5C%24location%20service%u7684%u8BDD%uFF0C%u6B63%u786E%u7684%u505A%u6CD5%u5E94%u5F53%u662F%uFF1A%0A%60%60%60%0A%24provide.provider%28%27%24location%27%2C%20function%20%28%29%20%7B%0A%20%20const%20provider%20%3D%20this%0A%20%20const%20location%20%3D%20%7B%7D%0A%20%20location.search%20%3D%20function%20%28%29%7B%0A%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20device_id%3A%20%27test%20id%27%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20provider.html5Mode%20%3D%20sinon.stub%28%29%0A%20%20provider.%24get%20%3D%20sinon.stub%28%29.returns%28location%29%0A%7D%29%0A%60%60%60%0Amock%u6389provider.%5C%24get%u51FD%u6570%uFF0C%u63D0%u4F9B%u5047%u7684location%u670D%u52A1%u3002%u5176%u5B9E%u8FD8%u6709%u5F88%u591A%u529E%u6CD5%uFF0C%u4F8B%u5982%u83B7%u5F97%5C%24locationProvider%u518D%u5BF9%5C%24get%u51FD%u6570%u8FDB%u884Cstub%uFF0C%u4E5F%u53EF%u4EE5%u3002%u6CA1%u6709%u518D%u4E00%u4E00%u5C1D%u8BD5%u4E86%u3002%u7406%u89E3%u4E86%u9519%u8BEF%u548C%u6B63%u786E%u7684%u505A%u6CD5%uFF0C%u60F3%u518D%u53BB%u5B9E%u73B0%u5C31%u5F97%u5FC3%u5E94%u624B%u4E86%u3002%0A%0A%23%23%23%23%20%u6D4B%u8BD5.config/.run%u5757%0AData%20module%u6709%u4E00%u4E2A.config%u5757%uFF0C%u56E0%u4E3A%u6A21%u5757%u52A0%u8F7D%u7684%u65F6%u5019%u4F1A%u5148%u8FD0%u884C%u5176.config%u5757%uFF0C%u7136%u540E%u662F.run%u5757%u3002%u56E0%u5176%u7279%u6B8A%u6027%uFF0C%u6240%u4EE5%u5728%u5BF9%u5176%u4E2D%u4F7F%u7528%u5230%u7684%u670D%u52A1%u8FDB%u884Cmock%u8981%u6CE8%u610F%u987A%u5E8F%u3002%u53EF%u4EE5%u53C2%u8003%u8FD9%u4E2A%u94FE%u63A5%uFF1A%5BTesting%20config%20and%20run%20blocks%20in%20AngularJS%0AHow%20to%20easily%20test%20an%20often%20neglected%20part%20of%20your%20application%5D%28https%3A//medium.com/@a_eife/testing-config-and-run-blocks-in-angularjs-1809bd52977e%29%0A%0A%23%23%23%23%20%u5982%u4F55mock%20%24interval%0A%u5728%u5355%u5143%u6D4B%u8BD5%u4E2D%uFF0C%u6211%u4EEC%u901A%u5E38%u8981%u91C7%u7528mock%u7684%u624B%u6BB5%uFF0C%u800C%u4E0D%u771F%u6B63%u7684%u4F7F%u7528%u65F6%u95F4%u670D%u52A1%u3002%u5728sinon%u4E2D%uFF0C%u53EF%u4EE5%u4F7F%u7528fake%20timer%u6765%u53D6%u4EE3JS%u4E2D%u6807%u51C6%u7684setTimeout%u548CsetInterval%u3002%u4E0D%u8FC7%u8FD9%u4E2A%u5728Angular%20JS%u4E2D%u5E76%u4E0D%u8D77%u4F5C%u7528%uFF0C%u5982%u679C%u6211%u4EEC%u4F7F%u7528%5C%24interval%u670D%u52A1%u7684%u8BDD%u3002%0A%u56E0%u4E3A%u5728%u5BF9Angular%20JS%u505A%u5355%u5143%u6D4B%u8BD5%u7684%u65F6%u5019%uFF0C%5C%24interval%u5E76%u4E0D%u4F1A%u8C03%u7528setInterval%u3002%u539F%u56E0%u662F%u8FD9%u91CC%u7684%5C%24interval%u5176%u5B9E%u662FngMock%u4E2D%u7684%5C%24interval%u3002%u6B64%u65F6%u53EF%u4EE5%u4F7F%u7528%60%24interval.flush%28ms%29%60%u6765%u5C06%u65F6%u949F%u63A8%u8FDB%u82E5%u5E72%u65F6%u95F4%u3002%u5F53%u7136%u5982%u679C%u613F%u610F%uFF0C%u4E5F%u53EF%u4EE5%u7528sinon%u6765mock%u4ECE%5C%24injector%u4E2Dget%u51FA%u6765%u7684%5C%24interval%20service%u3002%5C%24timeout%20service%u4E5F%u7C7B%u4F3C%uFF0C%u6709%u540C%u6837%u7684%u65B9%u6CD5%u5BF9%u4ED8%u5355%u5143%u6D4B%u8BD5%u3002%0A%0A%23%23%23%23%20Promise%20not%20resolve%0A%u5728Angular%20JS%u4E2D%uFF0C%u6211%u4EEC%u5F80%u5F80%u8C03%u7528%5C%24q%20service%u6765%u4F7F%u7528Promise%uFF0C%u800C%5C%24q.defer%28%29.promise%u53EA%u5728%5C%24scope%u7684digest%20cycle%u624D%u4F1A%u5224%u5B9Aresolve%u8FD8%u662Freject%uFF0C%u6240%u4EE5%u8981%u89E6%u53D1%5C%24q%u4EA7%u751F%u7684promise%uFF0C%u4E00%u5B9A%u8981%u8C03%u7528%u5BF9%u5E94%u7684%5C%24scope.%5C%24apply%28%29%u6216%u8005%5C%24scope.%5C%24digest%28%29%u3002stack%20overflow%u4E2D%u4E5F%u6709%u5927%u628A%u7C7B%u4F3C%u95EE%u9898%u7684%u89E3%u7B54%u3002%u5177%u4F53%u4E5F%u53EF%u4EE5%u53C2%u8003%u8FD9%u7BC7%u535A%u5BA2%uFF0C%u8BB2%u5F97%u5F88%u900F%u5F7B%uFF1A%0A-%20%5BUnit%20Testing%20with%20%24q%20Promises%20in%20AngularJS%5D%28http%3A//www.bradoncode.com/blog/2015/07/13/unit-test-promises-angualrjs-q/%29%0A%0A%u5728Angular%20JS%u4E2D%uFF0C%u4E5F%u53EF%u4EE5%u4F7F%u7528%u6807%u51C6%u7684Promise%uFF0C%u4F8B%u5982%3A%20%60var%20promise%20%3D%20new%20Promise%28resolve%2C%20reject%29%60%u3002%u4F46%u662F%u8C8C%u4F3C%uFF0C%u6807%u51C6%u7684Promise%u548C%5Cq%u517C%u5BB9%u7684%u5E76%u4E0D%u5F88%u597D%uFF0C%u4E0B%u9762%u7684code%u5E76%u4E0D%u4F1A%u5DE5%u4F5C%uFF1A%0A%60%60%60%0Avar%20promise%20%3D%20%24q.all%28%5Bpromise1%2C%20promise2%5D%29%0A%24scope.%24apply%28%29%0A%60%60%60%0Apromise%u5E76%u4E0D%u4F1A%u5728promise1%u548Cpromise2%u8FD4%u56DE%u4E4B%u540E%u8FD4%u56DE%uFF0C%u5B9E%u9645%u4E0A%u662F%u4ED6%u6839%u672C%u5C31%u4E0D%u4F1A%u8FD4%u56DE%uFF0C%u76F4%u5230%u6D4B%u8BD5%u8D85%u65F6%u5931%u8D25%u3002%0A%0A%23%23%23%23%20%22Unexpected%20request%3A%20GET%20.../.html%22%20on%20Karma%20tests%0A%u8FD9%u662FYaakov%u5728%u89C6%u9891%u4E2D%u63D0%u5230%u7684%u9700%u8981%u4F7F%u7528%5C%24templateCache%u7684%u60C5%u5F62%u3002Yaakov%u63D0%u5230%u7528karma%u662F%u89E3%u51B3%u8BE5%u95EE%u9898%u6700%u597D%u7684%u529E%u6CD5%uFF0C%u4F46%u662F%u56E0%u4E3A%u89C6%u9891%u5E76%u4E0D%u6D89%u53CA%u4ECB%u7ECDkarma%uFF0C%u6240%u4EE5%u5E76%u6CA1%u6709%u8BF4%u5E94%u8BE5%u600E%u4E48%u505A%u3002%0A%u5F53%u6211%u4EEC%u7684karma%20test%u52A0%u8F7D%u4E86route.js%uFF0C%u5E76%u5728%u5176%u4E2D%u5B9A%u4E49%u4E86component%uFF0C%u5219%u6D4B%u8BD5%u5728%u5B9E%u4F8B%u5316%u8BE5Angular%20component%u7684%u65F6%u5019%u56DE%u53BB%u7528%5C%24http%20service%u6765GET%u8BE5template%20html%u6587%u4EF6%uFF0C%u4E8E%u662F%u4EA7%u751F%u4E86%u8BE5unexpected%20request%u9519%u8BEF%u3002Yaakov%u5728%u6559%u7A0B%u4E2D%u7684%u89E3%u51B3%u529E%u6CD5%u662F%uFF0C%u901A%u8FC7%u4E00%u6B21%u771F%u6B63%u7684AJAX%u4ECE%u670D%u52A1%u5668%u4E0A%u8BF7%u6C42%u8BE5html%uFF0C%u5E76%u5C06%u4E4B%u5B58%u5165%5C%24templateCache%u4E2D%uFF0C%u4E4B%u540E%u5C31%u4E0D%u4F1A%u518D%u6709%u771F%u6B63%u7684GET%20AJAX%u4EA7%u751F%u4E86%u3002%u5176%u5B9E%u8FD9%u4E00%u6BB5%u53EF%u4EE5%u901A%u8FC7%u914D%u7F6Ekarma%u6765%u5B9E%u73B0%u3002%u5177%u4F53%u505A%u6CD5%u5982%u4E0B%uFF1A%0A-%20%u5B89%u88C5ng-html2js%uFF0Ckarma-ng-html2js-preprocessor%0A-%20%u4F7F%u7528ng-html2js%u5C06%u5BF9%u5E94%u7684template%20html%u8F6C%u6210js%u6A21%u5757%uFF0C%u5E76%u5728%u6D4B%u8BD5%u4EE3%u7801%u4E2D%u5F15%u5165%u3002%0A%0A%u770B%u4E0B%u9762%u5177%u4F53%u4EE3%u7801%0Akarma.conf.js%0A%60%60%60%0A//%20list%20of%20files%20/%20patterns%20to%20load%20in%20the%20browser%0Afiles%3A%20%5B%0A%20%20%27../html/templates/*.html%27%2C%0A%20%20...%0A%5D%2C%0A%0A//%20preprocess%20matching%20files%20before%20serving%20them%20to%20the%20browser%0A//%20available%20preprocessors%3A%20https%3A//npmjs.org/browse/keyword/karma-preprocessor%0Apreprocessors%3A%20%7B%0A%20%20%27../html/templates/home.template.html%27%3A%20%5B%27ng-html2js%27%5D%0A%7D%2C%0A%0AngHtml2JsPreprocessor%3A%20%7B%0A%20%20moduleName%3A%20%27templates%27%2C%0A%20%20stripPrefix%3A%20%27.*/%27%2C%0A%20%20prependPrefix%3A%20%27/html/templates/%27%0A%7D%2C%20%0A%60%60%60%0Atest.js%0A%60%60%60%0Adescribe%28function%28%29%7B%0A%20%20beforeEach%28module%28%27templates%27%29%29%0A%7D%29%0A%60%60%60%0A%u7279%u522B%u8981%u6CE8%u610F%u7684%u662F%u5BF9ng-html2js%u7684%u914D%u7F6E%0A%60%60%60%0AngHtml2JsPreprocessor%3A%20%7B%0A%20%20moduleName%3A%20%27templates%27%2C%0A%20%20stripPrefix%3A%20%27.*/%27%2C%0A%20%20prependPrefix%3A%20%27/html/templates/%27%0A%7D%2C%20%0A%60%60%60%0A%u5F53%u6CA1%u6709%60stripPrefix%60%u9009%u9879%u65F6%uFF0C%u901A%u8FC7Chrome%20debug%u53EF%u4EE5%u770B%u5230%uFF0C%u6240%u6709%u7684template%u90FD%u88AB%u8F6C%u5316%u6210%u4E86js%u6A21%u5757%uFF0C%u4F46%u662F%u5176%u6A21%u5757%u540D%u662F%u7C7B%u4F3C%60c%3A%5Cpath%5Cto%5Ctemplate%5Ctemplate.html%60%u7684%u7ED3%u6784%uFF0C%u800C%u6211%u5728route%u4E2D%u7684%u6307%u5B9A%u8DEF%u5F84%u662Fweb%u8DEF%u5F84%60templateUrl%3A%20%27/html/templates/home.template.html%27%60%u3002%u5C31%u5BF9%u4E0D%u4E0A%u53F7%u4E86%u3002%u505A%u6CD5%u662F%u901A%u8FC7%60stripPrefix%60%u5C06%u6240%u6709%u7684%u524D%u7F00%u5168%u90E8%u5265%u53BB%uFF0C%u7136%u540E%u7528%60prependPrefix%60%u52A0%u4E0A%u9700%u8981%u7684%u524D%u7F00%u3002%u8FD9%u6837%u5C31%u53EF%u4EE5%u5DE5%u4F5C%u4E86%u3002%u7F51%u4E0A%u6709%u5F88%u591A%u5E16%u5B50%u8BA8%u8BBA%u8FD9%u4E2A%u95EE%u9898%u3002%u5217%u4E24%u4E2A%u6709%u542F%u53D1%u6027%u7684%uFF1A%0A-%20%5BUnit%20Testing%20AngularJS%20directive%20with%20templateUrl%5D%28https%3A//stackoverflow.com/questions/15214760/unit-testing-angularjs-directive-with-templateurl%29%0A-%20%5BKarma%20%27Unexpected%20Request%27%20when%20testing%20angular%20directive%2C%20even%20with%20ng-html2js%5D%28https%3A//stackoverflow.com/questions/22869668/karma-unexpected-request-when-testing-angular-directive-even-with-ng-html2js%29%0A</center><br></div>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>打赏代表您对我的认可，这会激励我继续向前！</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechat_reward_qr.png" alt="Ben Zhou WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay_reward_qr.png" alt="Ben Zhou Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="/rss.xml">
          <span class="icon">
            <i class="fa fa-rss"></i>
          </span>

          <span class="label">RSS</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/angular/" rel="tag"># angular</a>
              <a href="/tags/unittest/" rel="tag"># unittest</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2017/10/23/Synology/" rel="prev" title="Synology">
                  <i class="fa fa-chevron-left"></i> Synology
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2017/10/27/Angular_JS_-_service,_factory_&_provider/" rel="next" title="Angular JS - service, factory & provider">
                  Angular JS - service, factory & provider <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ben Zhou</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdn.jsdelivr.net/npm/mermaid@8.12.0/dist/mermaid.min.js","integrity":"sha256-0dD7vUjUCTGJjeLnPotQQJIcSzug5fO6WDMYYyNIX4c="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"zhougy0717/zhougy0717.github.io","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
